!function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function a(){return Object.create(null)}function i(e){e.forEach(o)}function r(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}function d(e){let t;return c(e,e=>t=e)(),t}function l(e,t,n){e.$$.on_destroy.push(c(t,n))}function u(e,t,n){if(e){const o=f(e,t,n);return e[0](o)}}function f(e,t,o){return e[1]?n({},n(t.$$scope.ctx,e[1](o?o(t):{}))):t.$$scope.ctx}function p(e,t,o,a){return e[1]?n({},n(t.$$scope.changed||{},e[1](a?a(o):{}))):t.$$scope.changed||{}}function g(e,t,n=t){return e.set(n),t}const m=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),h="undefined"!=typeof window;let $=h?()=>window.performance.now():()=>Date.now(),b=h?e=>requestAnimationFrame(e):e;const v=new Set;let y,_=!1;function w(){v.forEach(e=>{e[0]($())||(v.delete(e),e[1]())}),(_=v.size>0)&&b(w)}function x(e,t){e.appendChild(t)}function k(e,t,n){e.insertBefore(t,n||null)}function E(e){e.parentNode.removeChild(e)}function O(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function C(e){return document.createElement(e)}function N(e){return document.createTextNode(e)}function S(){return N(" ")}function D(){return N("")}function P(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function M(e){return function(t){return t.preventDefault(),e.call(this,t)}}function R(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function A(e,t){t=""+t,e.data!==t&&(e.data=t)}function T(e,t){(null!=t||e.value)&&(e.value=t)}function L(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function j(e,t,n){e.classList[n?"add":"remove"](t)}class I{constructor(e,t=null){this.e=C("div"),this.a=t,this.u(e)}m(e,t=null){for(let n=0;n<this.n.length;n+=1)k(e,this.n[n],t);this.t=e}u(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}p(e){this.d(),this.u(e),this.m(this.t,this.a)}d(){this.n.forEach(E)}}let U,z=0,B={};function H(e,t,n,o,a,i,r,s=0){const c=16.666/o;let d="{\n";for(let e=0;e<=1;e+=c){const o=t+(n-t)*i(e);d+=100*e+`%{${r(o,1-o)}}\n`}const l=d+`100% {${r(n,1-n)}}\n}`,u=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(l)}_${s}`;if(!B[u]){if(!y){const e=C("style");document.head.appendChild(e),y=e.sheet}B[u]=!0,y.insertRule(`@keyframes ${u} ${l}`,y.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${u} ${o}ms linear ${a}ms 1 both`,z+=1,u}function q(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--z&&b(()=>{if(z)return;let e=y.cssRules.length;for(;e--;)y.deleteRule(e);B={}})}function F(e){U=e}function K(){if(!U)throw new Error("Function called outside component initialization");return U}function G(e){K().$$.on_mount.push(e)}function W(e,t){K().$$.context.set(e,t)}function Z(e){return K().$$.context.get(e)}function V(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const Y=[],J=[],Q=[],X=[],ee=Promise.resolve();let te,ne=!1;function oe(){ne||(ne=!0,ee.then(re))}function ae(e){Q.push(e)}function ie(e){X.push(e)}function re(){const e=new Set;do{for(;Y.length;){const e=Y.shift();F(e),se(e.$$)}for(;J.length;)J.pop()();for(let t=0;t<Q.length;t+=1){const n=Q[t];e.has(n)||(n(),e.add(n))}Q.length=0}while(Y.length);for(;X.length;)X.pop()();ne=!1}function se(e){null!==e.fragment&&(e.update(e.dirty),i(e.before_update),e.fragment&&e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(ae))}function ce(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const de=new Set;let le;function ue(){le={r:0,c:[],p:le}}function fe(){le.r||i(le.c),le=le.p}function pe(e,t){e&&e.i&&(de.delete(e),e.i(t))}function ge(e,t,n,o){if(e&&e.o){if(de.has(e))return;de.add(e),le.c.push(()=>{de.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}const me={duration:0};function he(n,o,a,s){let c=o(n,a),d=s?0:1,l=null,u=null,f=null;function p(){f&&q(n,f)}function g(e,t){const n=e.b-d;return t*=Math.abs(n),{a:d,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(o){const{delay:a=0,duration:r=300,easing:s=t,tick:m=e,css:h}=c||me,y={start:$()+a,b:o};o||(y.group=le,le.r+=1),l?u=y:(h&&(p(),f=H(n,d,o,r,a,s,h)),o&&m(0,1),l=g(y,r),ae(()=>ce(n,o,"start")),function(e){let t;_||(_=!0,b(w)),new Promise(n=>{v.add(t=[e,n])})}(e=>{if(u&&e>u.start&&(l=g(u,r),u=null,ce(n,l.b,"start"),h&&(p(),f=H(n,d,l.b,l.duration,0,s,c.css))),l)if(e>=l.end)m(d=l.b,1-d),ce(n,l.b,"end"),u||(l.b?p():--l.group.r||i(l.group.c)),l=null;else if(e>=l.start){const t=e-l.start;d=l.a+l.d*s(t/l.duration),m(d,1-d)}return!(!l&&!u)}))}return{run(e){r(c)?(te||(te=Promise.resolve()).then(()=>{te=null}),te).then(()=>{c=c(),m(e)}):m(e)},end(){p(),l=u=null}}}const $e="undefined"!=typeof window?window:global;function be(e,t,n){m(e.$$.props,t)&&(t=e.$$.props[t]||t,e.$$.bound[t]=n,n(e.$$.ctx[t]))}function ve(e){e&&e.c()}function ye(e,t,n){const{fragment:a,on_mount:s,on_destroy:c,after_update:d}=e.$$;a&&a.m(t,n),ae(()=>{const t=s.map(o).filter(r);c?c.push(...t):i(t),e.$$.on_mount=[]}),d.forEach(ae)}function _e(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx={})}function we(t,n,o,r,s,c){const d=U;F(t);const l=n.props||{},u=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:s,bound:a(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:a(),dirty:null};let f=!1;u.ctx=o?o(t,l,(e,n,o=n)=>(u.ctx&&s(u.ctx[e],u.ctx[e]=o)&&(u.bound[e]&&u.bound[e](o),f&&function(e,t){e.$$.dirty||(Y.push(e),oe(),e.$$.dirty=a()),e.$$.dirty[t]=!0}(t,e)),n)):l,u.update(),f=!0,i(u.before_update),u.fragment=!!r&&r(u.ctx),n.target&&(n.hydrate?u.fragment&&u.fragment.l(function(e){return Array.from(e.childNodes)}(n.target)):u.fragment&&u.fragment.c(),n.intro&&pe(t.$$.fragment),ye(t,n.target,n.anchor),re()),F(d)}class xe{$destroy(){_e(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function ke(e,t){return e(t={exports:{}},t.exports),t.exports}var Ee=ke((function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(o){return"function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?e.exports=n=function(e){return t(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)},n(o)}e.exports=n})),Oe=ke((function(e){var t=function(e){var t,n=Object.prototype,o=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",r=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(e,t,n,o){var a=t&&t.prototype instanceof m?t:m,i=Object.create(a.prototype),r=new C(o||[]);return i._invoke=function(e,t,n){var o=l;return function(a,i){if(o===f)throw new Error("Generator is already running");if(o===p){if("throw"===a)throw i;return S()}for(n.method=a,n.arg=i;;){var r=n.delegate;if(r){var s=k(r,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===l)throw o=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var c=d(e,t,n);if("normal"===c.type){if(o=n.done?p:u,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=p,n.method="throw",n.arg=c.arg)}}}(e,n,r),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",u="suspendedYield",f="executing",p="completed",g={};function m(){}function h(){}function $(){}var b={};b[i]=function(){return this};var v=Object.getPrototypeOf,y=v&&v(v(N([])));y&&y!==n&&o.call(y,i)&&(b=y);var _=$.prototype=m.prototype=Object.create(b);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function x(e){var t;this._invoke=function(n,a){function i(){return new Promise((function(t,i){!function t(n,a,i,r){var s=d(e[n],e,a);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==typeof l&&o.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,i,r)}),(function(e){t("throw",e,i,r)})):Promise.resolve(l).then((function(e){c.value=e,i(c)}),(function(e){return t("throw",e,i,r)}))}r(s.arg)}(n,a,t,i)}))}return t=t?t.then(i,i):i()}}function k(e,n){var o=e.iterator[n.method];if(o===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,k(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var a=d(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function N(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function n(){for(;++a<e.length;)if(o.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return r.next=r}}return{next:S}}function S(){return{value:t,done:!0}}return h.prototype=_.constructor=$,$.constructor=h,$[s]=h.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,$):(e.__proto__=$,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},w(x.prototype),x.prototype[r]=function(){return this},e.AsyncIterator=x,e.async=function(t,n,o,a){var i=new x(c(t,n,o,a));return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},w(_),_[s]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var o=t.pop();if(o in e)return n.value=o,n.done=!1,n}return n.done=!0,n}},e.values=N,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(o,a){return s.type="throw",s.arg=e,n.next=o,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return a("end");if(r.tryLoc<=this.prev){var c=o.call(r,"catchLoc"),d=o.call(r,"finallyLoc");if(c&&d){if(this.prev<r.catchLoc)return a(r.catchLoc,!0);if(this.prev<r.finallyLoc)return a(r.finallyLoc)}else if(c){if(this.prev<r.catchLoc)return a(r.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return a(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var r=i?i.completion:{};return r.type=e,r.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(r)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var a=o.arg;O(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,o){return this.delegate={iterator:N(e),resultName:n,nextLoc:o},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));var Ce=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};function Ne(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Se=function(e,t,n){return t&&Ne(e.prototype,t),n&&Ne(e,n),e};var De=function(e){if(Array.isArray(e))return e};var Pe=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],o=!0,a=!1,i=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(n.push(r.value),!t||n.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(a)throw i}}return n}};var Me=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var Re=function(e,t){return De(e)||Pe(e,t)||Me()};var Ae=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var Te=function(e,t){return!t||"object"!==Ee(t)&&"function"!=typeof t?Ae(e):t},Le=ke((function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(n)}e.exports=t})),je=ke((function(e){function t(n,o){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(n,o)}e.exports=t}));var Ie=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)},Ue=function(){function e(){Ce(this,e),this._on={},this._props={},this._reactiveProp={}}return Se(e,[{key:"emit",value:function(e,t){var n=this._on[e];if(!n)return this;for(var o=0;o<n.length;o++)n[o][0](t);return this}},{key:"on",value:function(e,t){var n=t?null:new Promise((function(e){t=e})),o=this._on[e]||(this._on[e]=[]),a=[t];o.push(a);var i=function(){var e=o.indexOf(a);-1!=e&&o.splice(e,1)};return n?n.finally(i):i}},{key:"prop",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};switch(this._props[t]=o,e){case"persist":return this._localStorageProp(t,n);case"ro":return this._readOnlyProp(t,n);case"rw":return this._updateableProp(t,n)}throw'Unknown prop type "'+e+'" for prop "'+t+'".'}},{key:"subscribe",value:function(e){return e(this),this.on("update",e)}},{key:"update",value:function(e){for(var t=this,n=Object.keys(e),o=n.length,a=0;a<n.length;a++){var i=n[a],r=this._props[i];if(r){var s=!1;this._reactiveProp.hasOwnProperty(i)&&(this._reactiveProp[i]!==e[i]&&(s=!0),this._reactiveProp[i]=e[i]),r.localStorage&&s&&this._localStorage(i,this._reactiveProp[i]),s||o--}}return o&&!this._updatedTid&&(this._updatedTid=setTimeout((function(){delete t._updatedTid,t.emit("update",t)}),1)),this}},{key:"_localStorage",value:function(e,t){var n="convos:"+(this._props[e].key||e);return 2==arguments.length?localStorage.setItem(n,JSON.stringify(t)):localStorage.hasOwnProperty(n)?JSON.parse(localStorage.getItem(n)):void 0}},{key:"_localStorageProp",value:function(e,t){var n=this._localStorage(e);this._updateableProp(e,void 0===n?t:n),this._props[e].localStorage=!0,void 0!==n||this._props[e].lazy||this._localStorage(e,t)}},{key:"_readOnlyProp",value:function(e,t){if(void 0===t)throw'Read-only attribute "'+e+'" cannot be undefined for '+this.constructor.name;var n="function"==typeof t?{get:t}:{value:t,writable:!1};Object.defineProperty(this,e,n)}},{key:"_updateableProp",value:function(e,t){var n=this;this._reactiveProp[e]=t,Object.defineProperty(this,e,{get:function(){return n._reactiveProp[e]}})}}]),e}(),ze=.618033988749;function Be(e,t){for(;e;){if(t.tagName?e==t:e.matches&&e.matches(t))return e;e=e.parentNode}return null}function He(e,t){var n;return function(){for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];var r=this;n&&clearTimeout(n),n=setTimeout((function(){e.apply(r,a)}),t)}}function qe(e,t,n){var o=e&&e.querySelector("."+t.split(" ").join("."));return o||((o=document.createElement("div")).className=t,e&&e.appendChild(o),n&&n(o),o)}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"message",n=e.errors||e;return n&&n[0]?n[0][t]||"Unknown error.":""}function Ke(e){var t=document,n=e.replace(/\W/g,"_");if(!t.getElementById(n)){var o=t.createElement("script"),a=[n,e];o.id=a[0],o.src=a[1],t.getElementsByTagName("head")[0].appendChild(o)}}function Ge(e){return Object.keys(e).filter((function(t){return e[t]})).map((function(e){return"has-mode-"+e})).join(" ")}function We(e,t,n){var o=e.querySelectorAll(t);if(!n)return[].slice.call(o,0);for(var a=[],i=0;i<o.length;i++)a.push(n(o[i],i));return a}function Ze(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function Ve(e,t,n){var o=document.querySelector(e);o.className=o.className.replace(t,(function(e,t){return t+n}))}function Ye(e,t){return"is-visible"===t?!e.hasAttribute("hidden"):("toggle"===t&&(t=e.hasAttribute("hidden")),t?e.removeAttribute("hidden"):e.setAttribute("hidden",""))}function Je(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;if(0==e.length)return"#000";for(var n=0,o=0;o<e.length;o++)n=e.charCodeAt(o)+((n<<5)-n),n&=n;return"#"+function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.95,o=Math.floor(6*e),a=6*e-o,i=n*(1-t),r=n*(1-a*t),s=n*(1-(1-a)*t),c=255,d=255,l=255;switch(o){case 0:c=n,d=s,l=i;break;case 1:c=r,d=n,l=i;break;case 2:c=i,d=n,l=s;break;case 3:c=i,d=r,l=n;break;case 4:c=s,d=i,l=n;break;case 5:c=n,d=i,l=r}return[Math.floor(255*c),Math.floor(255*d),Math.floor(255*l)]}(((n=Math.abs(n%t/t))+ze)%1,.4,.7).map((function(e){return e.toString(16)})).join("")}function Qe(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t}function Xe(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}var et=function(e){function t(e){var n;return Ce(this,t),(n=Te(this,Le(t).call(this))).prop("ro","api",e.api),n.prop("ro","defaultParams",e.defaultParams||{}),n.prop("ro","id",e.id),n.prop("ro","req",{body:null,headers:{}}),n.prop("ro","res",{body:{},headers:{}}),n.prop("rw","err",null),n.prop("rw","status","pending"),n}return Ie(t,e),Se(t,[{key:"error",value:function(e,t){if(e)return this.update({err:Array.isArray(e)?e:[{message:e,source:t}],status:"error"});if(!this.err||!this.err.length)return"";var n=this.err[0],o=n.path&&n.path.match(/\w$/)&&n.path.split("/").pop();return o?o+": "+n.message:n.message}},{key:"perform",value:function(e){var t=this;return this._promise||(this._promise=new Promise((function(n){t.api.spec(t.id).then((function(o){if(!o)return n(t.error('Invalid operationId "'+t.id+'".',"spec"));t.update({status:"loading"});var a=t._paramsToRequest(o,e||t.defaultParams),i=Re(a,2),r=i[0],s=i[1];return t.emit("start",s),"object"==Ee(s.body)&&(s.body=JSON.stringify(s.body)),fetch(r,s)})).then((function(e){return Promise.all([e,e.json()])})).then((function(e){var o=Re(e,2),a=o[0],i=o[1];delete t._promise,n(t.parse(a,i))})).catch((function(e){delete t._promise,n(t.error('Failed fetching operationId "'+t.id+'": '+e,"fetch"))}))})))}},{key:"is",value:function(e){return this.status==e}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.body;this.res.body=t||e,this.res.status=e.status||"201",e.headers&&(this.res.headers=e.headers);var n=null;return String(this.res.status).match(/^[23]/)||(n=t&&t.errors?t.errors:[{message:e.statusText||"Unknown error."}]),this.update({err:n,status:n?"error":"success"})}},{key:"reset",value:function(){return this.res.body={},this.res.headers={},this.res.status=0,this.update({err:null,status:"pending"})}},{key:"_extractValue",value:function(e,t){if(t.schema&&"form"==(e.tagName||"").toLowerCase())return Object.keys(t.schema.properties).reduce((function(t,n){var o=e[n];return o&&("checkbox"!=o.type||o.checked)?(t[n]=o.value,t):t}),{});if(e[t.name]&&e[t.name].tagName)return e[t.name].value;if(t.schema){var n={};return Object.keys(t.schema.properties).forEach((function(t){n[t]=e[t]})),n}return e[t.name]}},{key:"_hasProperty",value:function(e,t){return"body"==t.in||("form"==(e.tagName||"").toLowerCase()?!!e[t.name]:e.hasOwnProperty(t.name))}},{key:"_paramsToRequest",value:function(e,t){var n=this,o={headers:this.req.headers,method:e.method},a=new URL(e.url);return(e.parameters||[]).forEach((function(e){if(n._hasProperty(t,e)||e.required)if("path"==e.in){var i=new RegExp("(%7B|\\{)"+Ze(e.name)+"(%7D|\\})","i");a.pathname=a.pathname.replace(i,encodeURIComponent(n._extractValue(t,e)))}else if("query"==e.in)a.searchParams.set(e.name,n._extractValue(t,e));else if("body"==e.in)o.body=n._extractValue(t,e);else{if("header"!=e.in)throw"[Api] Parameter in:"+e.in+" is not supported.";o.header[e.name]=n._extractValue(t,e.name)}})),[a,o]}}]),t}(Ue),tt=function(){function e(t){Ce(this,e),this.protocol=location.protocol,this.url=t}return Se(e,[{key:"operation",value:function(e,t){var n=new et({api:this,id:e,defaultParams:t});return n.req.headers={"Content-Type":"application/json"},n}},{key:"spec",value:function(e){var t,n,o=this;return Oe.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(!this._ops||!e){a.next=2;break}return a.abrupt("return",this._ops[e]);case 2:if(!this._spec){a.next=4;break}return a.abrupt("return",this._spec);case 4:return a.next=6,Oe.awrap(fetch(this.url));case 6:return t=a.sent,a.next=9,Oe.awrap(t.json());case 9:if(n=a.sent,this._ops={},this._spec=n,Object.keys(n.paths).forEach((function(e){Object.keys(n.paths[e]).forEach((function(t){var a=n.paths[e][t],i=a.operationId;i&&(a.method=t.toUpperCase(),a.url=o.protocol+"//"+n.host+n.basePath+e+".json",a.parameters=(a.parameters||[]).map((function(e){return o._resolveRef(e)})),o._ops[i]=a)}))})),!this._ops||!e){a.next=15;break}return a.abrupt("return",this._ops[e]);case 15:if(!this._spec){a.next=17;break}return a.abrupt("return",this._spec);case 17:case"end":return a.stop()}}),null,this)}},{key:"_resolveRef",value:function(e){var t=this,n=e;if(e.$ref){var o=e.$ref.replace(/^#\//,"").split("/");for(n=this._spec;o.length;)n=n[o.shift()]}return"object"==Ee(n)&&Object.keys(n).forEach((function(e){n[e]=t._resolveRef(n[e])})),n}}]),e}(),nt=ke((function(e,t){var n,o;n=function(e){var t=[],n=Object.keys,o={},a={},i=/^(no-?highlight|plain|text)$/i,r=/\blang(?:uage)?-([\w-]+)\b/i,s=/((^(<[^>]+>|\t|)+|(?:\n)))/gm,c="</span>",d={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},l="of and for in not or if then".split(" ");function u(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function f(e){return e.nodeName.toLowerCase()}function p(e){return i.test(e)}function g(e){var t,n={},o=Array.prototype.slice.call(arguments,1);for(t in e)n[t]=e[t];return o.forEach((function(e){for(t in e)n[t]=e[t]})),n}function m(e){var t=[];return function e(n,o){for(var a=n.firstChild;a;a=a.nextSibling)3===a.nodeType?o+=a.nodeValue.length:1===a.nodeType&&(t.push({event:"start",offset:o,node:a}),o=e(a,o),f(a).match(/br|hr|img|input/)||t.push({event:"stop",offset:o,node:a}));return o}(e,0),t}function h(e){return e.variants&&!e.cached_variants&&(e.cached_variants=e.variants.map((function(t){return g(e,{variants:null},t)}))),e.cached_variants?e.cached_variants:function e(t){return!!t&&(t.endsWithParent||e(t.starts))}(e)?[g(e,{starts:e.starts?g(e.starts):null})]:[e]}function $(e,t){return t?Number(t):(n=e,-1!=l.indexOf(n.toLowerCase())?0:1);var n}function b(e){function t(e){return e&&e.source||e}function o(n,o){return new RegExp(t(n),"m"+(e.case_insensitive?"i":"")+(o?"g":""))}function a(e){var n,a,i={},r=[],s={},c=1;function d(e,t){i[c]=e,r.push([e,t]),c+=function(e){return new RegExp(e.toString()+"|").exec("").length-1}(t)+1}for(var l=0;l<e.contains.length;l++)d(a=e.contains[l],a.beginKeywords?"\\.?(?:"+a.begin+")\\.?":a.begin);e.terminator_end&&d("end",e.terminator_end),e.illegal&&d("illegal",e.illegal);var u=r.map((function(e){return e[1]}));return n=o(function(e,n){for(var o=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./,a=0,i="",r=0;r<e.length;r++){var s=a+=1,c=t(e[r]);for(r>0&&(i+=n),i+="(";c.length>0;){var d=o.exec(c);if(null==d){i+=c;break}i+=c.substring(0,d.index),c=c.substring(d.index+d[0].length),"\\"==d[0][0]&&d[1]?i+="\\"+String(Number(d[1])+s):(i+=d[0],"("==d[0]&&a++)}i+=")"}return i}(u,"|"),!0),s.lastIndex=0,s.exec=function(t){var o;if(0===r.length)return null;n.lastIndex=s.lastIndex;var a=n.exec(t);if(!a)return null;for(var c=0;c<a.length;c++)if(null!=a[c]&&null!=i[""+c]){o=i[""+c];break}return"string"==typeof o?(a.type=o,a.extra=[e.illegal,e.terminator_end]):(a.type="begin",a.rule=o),a},s}!function i(r,s){r.compiled||(r.compiled=!0,r.keywords=r.keywords||r.beginKeywords,r.keywords&&(r.keywords=function(e,t){var o={};return"string"==typeof e?a("keyword",e):n(e).forEach((function(t){a(t,e[t])})),o;function a(e,n){t&&(n=n.toLowerCase()),n.split(" ").forEach((function(t){var n=t.split("|");o[n[0]]=[e,$(n[0],n[1])]}))}}(r.keywords,e.case_insensitive)),r.lexemesRe=o(r.lexemes||/\w+/,!0),s&&(r.beginKeywords&&(r.begin="\\b("+r.beginKeywords.split(" ").join("|")+")\\b"),r.begin||(r.begin=/\B|\b/),r.beginRe=o(r.begin),r.endSameAsBegin&&(r.end=r.begin),r.end||r.endsWithParent||(r.end=/\B|\b/),r.end&&(r.endRe=o(r.end)),r.terminator_end=t(r.end)||"",r.endsWithParent&&s.terminator_end&&(r.terminator_end+=(r.end?"|":"")+s.terminator_end)),r.illegal&&(r.illegalRe=o(r.illegal)),null==r.relevance&&(r.relevance=1),r.contains||(r.contains=[]),r.contains=Array.prototype.concat.apply([],r.contains.map((function(e){return h("self"===e?r:e)}))),r.contains.forEach((function(e){i(e,r)})),r.starts&&i(r.starts,s),r.terminators=a(r))}(e)}function v(e,t,n,a){function i(e,t){var n=h.case_insensitive?t[0].toLowerCase():t[0];return e.keywords.hasOwnProperty(n)&&e.keywords[n]}function r(e,t,n,o){if(!n&&""===t)return"";if(!e)return t;var a='<span class="'+(o?"":d.classPrefix);return(a+=e+'">')+t+(n?"":c)}function s(){x+=null!=_.subLanguage?function(){var e="string"==typeof _.subLanguage;if(e&&!o[_.subLanguage])return u(E);var t=e?v(_.subLanguage,E,!0,w[_.subLanguage]):y(E,_.subLanguage.length?_.subLanguage:void 0);return _.relevance>0&&(O+=t.relevance),e&&(w[_.subLanguage]=t.top),r(t.language,t.value,!1,!0)}():function(){var e,t,n,o;if(!_.keywords)return u(E);for(o="",t=0,_.lexemesRe.lastIndex=0,n=_.lexemesRe.exec(E);n;)o+=u(E.substring(t,n.index)),(e=i(_,n))?(O+=e[1],o+=r(e[0],u(n[0]))):o+=u(n[0]),t=_.lexemesRe.lastIndex,n=_.lexemesRe.exec(E);return o+u(E.substr(t))}(),E=""}function l(e){x+=e.className?r(e.className,"",!0):"",_=Object.create(e,{parent:{value:_}})}function f(e){var t=e[0],n=e.rule;return n&&n.endSameAsBegin&&(n.endRe=function(e){return new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"m")}(t)),n.skip?E+=t:(n.excludeBegin&&(E+=t),s(),n.returnBegin||n.excludeBegin||(E=t)),l(n),n.returnBegin?0:t.length}function p(e){var t=e[0],n=function e(t,n){if(function(e,t){var n=e&&e.exec(t);return n&&0===n.index}(t.endRe,n)){for(;t.endsParent&&t.parent;)t=t.parent;return t}if(t.endsWithParent)return e(t.parent,n)}(_,t);if(n){var o=_;o.skip?E+=t:(o.returnEnd||o.excludeEnd||(E+=t),s(),o.excludeEnd&&(E=t));do{_.className&&(x+=c),_.skip||_.subLanguage||(O+=_.relevance),_=_.parent}while(_!==n.parent);return n.starts&&(n.endSameAsBegin&&(n.starts.endRe=n.endRe),l(n.starts)),o.returnEnd?0:t.length}}var g={};function m(e,o){var a=o&&o[0];if(E+=e,null==a)return s(),0;if("begin"==g.type&&"end"==o.type&&g.index==o.index&&""===a)return E+=t.slice(o.index,o.index+1),1;if(g=o,"begin"===o.type)return f(o);if("illegal"===o.type&&!n)throw new Error('Illegal lexeme "'+a+'" for mode "'+(_.className||"<unnamed>")+'"');if("end"===o.type){var i=p(o);if(null!=i)return i}return E+=a,a.length}var h=k(e);if(!h)throw new Error('Unknown language: "'+e+'"');b(h);var $,_=a||h,w={},x="";for($=_;$!==h;$=$.parent)$.className&&(x=r($.className,"",!0)+x);var E="",O=0;try{for(var C,N,S=0;_.terminators.lastIndex=S,C=_.terminators.exec(t);)N=m(t.substring(S,C.index),C),S=C.index+N;for(m(t.substr(S)),$=_;$.parent;$=$.parent)$.className&&(x+=c);return{relevance:O,value:x,illegal:!1,language:e,top:_}}catch(e){if(e.message&&-1!==e.message.indexOf("Illegal"))return{illegal:!0,relevance:0,value:u(t)};throw e}}function y(e,t){t=t||d.languages||n(o);var a={relevance:0,value:u(e)},i=a;return t.filter(k).filter(E).forEach((function(t){var n=v(t,e,!1);n.language=t,n.relevance>i.relevance&&(i=n),n.relevance>a.relevance&&(i=a,a=n)})),i.language&&(a.second_best=i),a}function _(e){return d.tabReplace||d.useBR?e.replace(s,(function(e,t){return d.useBR&&"\n"===e?"<br>":d.tabReplace?t.replace(/\t/g,d.tabReplace):""})):e}function w(e){var n,o,i,s,c,l=function(e){var t,n,o,a,i=e.className+" ";if(i+=e.parentNode?e.parentNode.className:"",n=r.exec(i))return k(n[1])?n[1]:"no-highlight";for(t=0,o=(i=i.split(/\s+/)).length;t<o;t++)if(p(a=i[t])||k(a))return a}(e);p(l)||(d.useBR?(n=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=e.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):n=e,c=n.textContent,i=l?v(l,c,!0):y(c),(o=m(n)).length&&((s=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=i.value,i.value=function(e,n,o){var a=0,i="",r=[];function s(){return e.length&&n.length?e[0].offset!==n[0].offset?e[0].offset<n[0].offset?e:n:"start"===n[0].event?e:n:e.length?e:n}function c(e){i+="<"+f(e)+t.map.call(e.attributes,(function(e){return" "+e.nodeName+'="'+u(e.value).replace('"',"&quot;")+'"'})).join("")+">"}function d(e){i+="</"+f(e)+">"}function l(e){("start"===e.event?c:d)(e.node)}for(;e.length||n.length;){var p=s();if(i+=u(o.substring(a,p[0].offset)),a=p[0].offset,p===e){r.reverse().forEach(d);do{l(p.splice(0,1)[0]),p=s()}while(p===e&&p.length&&p[0].offset===a);r.reverse().forEach(c)}else"start"===p[0].event?r.push(p[0].node):r.pop(),l(p.splice(0,1)[0])}return i+u(o.substr(a))}(o,m(s),c)),i.value=_(i.value),e.innerHTML=i.value,e.className=function(e,t,n){var o=t?a[t]:n,i=[e.trim()];return e.match(/\bhljs\b/)||i.push("hljs"),-1===e.indexOf(o)&&i.push(o),i.join(" ").trim()}(e.className,l,i.language),e.result={language:i.language,re:i.relevance},i.second_best&&(e.second_best={language:i.second_best.language,re:i.second_best.relevance}))}function x(){if(!x.called){x.called=!0;var e=document.querySelectorAll("pre code");t.forEach.call(e,w)}}function k(e){return e=(e||"").toLowerCase(),o[e]||o[a[e]]}function E(e){var t=k(e);return t&&!t.disableAutodetect}return e.highlight=v,e.highlightAuto=y,e.fixMarkup=_,e.highlightBlock=w,e.configure=function(e){d=g(d,e)},e.initHighlighting=x,e.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",x,!1),addEventListener("load",x,!1)},e.registerLanguage=function(t,n){var i=o[t]=n(e);i.rawDefinition=n.bind(null,e),i.aliases&&i.aliases.forEach((function(e){a[e]=t}))},e.listLanguages=function(){return n(o)},e.getLanguage=k,e.autoDetection=E,e.inherit=g,e.IDENT_RE="[a-zA-Z]\\w*",e.UNDERSCORE_IDENT_RE="[a-zA-Z_]\\w*",e.NUMBER_RE="\\b\\d+(\\.\\d+)?",e.C_NUMBER_RE="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",e.BINARY_NUMBER_RE="\\b(0b[01]+)",e.RE_STARTERS_RE="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",e.BACKSLASH_ESCAPE={begin:"\\\\[\\s\\S]",relevance:0},e.APOS_STRING_MODE={className:"string",begin:"'",end:"'",illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.QUOTE_STRING_MODE={className:"string",begin:'"',end:'"',illegal:"\\n",contains:[e.BACKSLASH_ESCAPE]},e.PHRASAL_WORDS_MODE={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},e.COMMENT=function(t,n,o){var a=e.inherit({className:"comment",begin:t,end:n,contains:[]},o||{});return a.contains.push(e.PHRASAL_WORDS_MODE),a.contains.push({className:"doctag",begin:"(?:TODO|FIXME|NOTE|BUG|XXX):",relevance:0}),a},e.C_LINE_COMMENT_MODE=e.COMMENT("//","$"),e.C_BLOCK_COMMENT_MODE=e.COMMENT("/\\*","\\*/"),e.HASH_COMMENT_MODE=e.COMMENT("#","$"),e.NUMBER_MODE={className:"number",begin:e.NUMBER_RE,relevance:0},e.C_NUMBER_MODE={className:"number",begin:e.C_NUMBER_RE,relevance:0},e.BINARY_NUMBER_MODE={className:"number",begin:e.BINARY_NUMBER_RE,relevance:0},e.CSS_NUMBER_MODE={className:"number",begin:e.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},e.REGEXP_MODE={className:"regexp",begin:/\//,end:/\/[gimuy]*/,illegal:/\n/,contains:[e.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[e.BACKSLASH_ESCAPE]}]},e.TITLE_MODE={className:"title",begin:e.IDENT_RE,relevance:0},e.UNDERSCORE_TITLE_MODE={className:"title",begin:e.UNDERSCORE_IDENT_RE,relevance:0},e.METHOD_GUARD={begin:"\\.\\s*"+e.UNDERSCORE_IDENT_RE,relevance:0},e},o="object"==typeof window&&window||"object"==typeof self&&self,t.nodeType?o&&(o.hljs=n({})):n(t)}));function ot(t){let n,o,a,i,r;return{c(){R(n=C("i"),"class",o=t.calculateClassName(t.name,t.family)),R(n,"style",a=t.calculateStyle(t.name,t.family,t.color)),R(n,"title",t.title),n.hidden=i=!t.name,r=P(n,"click",t.click_handler)},m(e,t){k(e,n,t)},p(e,t){(e.name||e.family)&&o!==(o=t.calculateClassName(t.name,t.family))&&R(n,"class",o),(e.name||e.family||e.color)&&a!==(a=t.calculateStyle(t.name,t.family,t.color))&&R(n,"style",a),e.title&&R(n,"title",t.title),e.name&&i!==(i=!t.name)&&(n.hidden=i)},i:e,o:e,d(e){e&&E(n),r()}}}function at(e,t,n){const o={regular:"far",solid:"fas"},a={batman:"https://www.gravatar.com/avatar/ab1839667863f31e359d98364cfdef61",marcusr:"https://www.gravatar.com/avatar/6c056546d802b1a9ac186ab63f9fb632"},i=["fas fa-anchor","fas fa-atom","fas fa-award","fas fa-balance-scale","fas fa-baseball-ball","fas fa-basketball-ball","fas fa-bicycle","fas fa-bolt","fas fa-book-reader","fas fa-candy-cane","fas fa-carrot","fas fa-cat","fas fa-chess-knight","fas fa-child","fas fa-coffee","fas fa-cookie-bite","fas fa-crow","fas fa-dice","fas fa-dog","fas fa-dove","fas fa-feather","fas fa-fish","fas fa-gem","fas fa-ghost","fas fa-hard-hat","fas fa-hat-cowboy","fas fa-hat-wizard","fas fa-hiking","fas fa-horse-head","fas fa-horse","fas fa-id-badge","fas fa-igloo","fas fa-mask","fas fa-meteor","fas fa-paint-brush","fas fa-paw","fas fa-pepper-hot","fas fa-pizza-slice","fas fa-portrait","fas fa-puzzle-piece","fas fa-rainbow","fas fa-robot","fas fa-rocket","fas fa-running","fas fa-seedling","fas fa-skating","fas fa-skiing","fas fa-smile","fas fa-snowboarding","fas fa-snowflake","fas fa-snowman","fas fa-swimmer","fas fa-umbrella","fas fa-user-astronaut","fas fa-user-graduate","fas fa-user-ninja","fas fa-user-secret","fas fa-walking","fas fa-yin-yang"];let{class:r=""}=t,{animation:s=""}=t,{color:c=""}=t,{family:d=""}=t,{name:l}=t,{title:u=""}=t;return e.$set=e=>{"class"in e&&n("className",r=e.class),"animation"in e&&n("animation",s=e.animation),"color"in e&&n("color",c=e.color),"family"in e&&n("family",d=e.family),"name"in e&&n("name",l=e.name),"title"in e&&n("title",u=e.title)},{className:r,animation:s,color:c,family:d,name:l,title:u,calculateClassName:function(e,t){const n=[],c=e.match(/^pick:(.+)$/);if(c){if(a[c[1]])return"fas fa-contributor";n.push(function(e){e.match(/^\d+$/)&&console.log(i[e]);if(e.match(/^\d+$/))return i[e];let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t),t&=t;return t=Math.abs(t),i[t%i.length]}(c[1]))}else n.push(o[t]||"fas"),n.push("fa-"+e);return s&&n.push(s.split(" ").map(e=>"fa-"+e)),r&&n.push(r.split(" ")),n.join(" ")},calculateStyle:function(e,t,n){const o=[];let i="color:";const r=e.match(/^pick:(.+)$/);return r&&a[r[1]]&&(i="background-color:",o.push('background-image:url("'+a[r[1]]+'")')),n&&o.push(i+n),o.join(";")},click_handler:function(t){V(e,t)}}}nt.registerLanguage("css",(function(e){var t={begin:/(?:[A-Z\_\.\-]+|--[a-zA-Z0-9_-]+)\s*:/,returnBegin:!0,end:";",endsWithParent:!0,contains:[{className:"attribute",begin:/\S/,end:":",excludeEnd:!0,starts:{endsWithParent:!0,excludeEnd:!0,contains:[{begin:/[\w-]+\(/,returnBegin:!0,contains:[{className:"built_in",begin:/[\w-]+/},{begin:/\(/,end:/\)/,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]}]},e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE,{className:"number",begin:"#[0-9A-Fa-f]+"},{className:"meta",begin:"!important"}]}}]};return{case_insensitive:!0,illegal:/[=\/|'\$]/,contains:[e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/},{className:"selector-class",begin:/\.[A-Za-z0-9_-]+/},{className:"selector-attr",begin:/\[/,end:/\]/,illegal:"$"},{className:"selector-pseudo",begin:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{begin:"@(font-face|page)",lexemes:"[a-z-]+",keywords:"font-face page"},{begin:"@",end:"[{;]",illegal:/:/,contains:[{className:"keyword",begin:/\w+/},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,contains:[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"[a-zA-Z-][a-zA-Z0-9_-]*",relevance:0},{begin:"{",end:"}",illegal:/\S/,contains:[e.C_BLOCK_COMMENT_MODE,t]}]}})),nt.registerLanguage("diff",(function(e){return{aliases:["patch"],contains:[{className:"meta",relevance:10,variants:[{begin:/^@@ +\-\d+,\d+ +\+\d+,\d+ +@@$/},{begin:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{begin:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{className:"comment",variants:[{begin:/Index: /,end:/$/},{begin:/={3,}/,end:/$/},{begin:/^\-{3}/,end:/$/},{begin:/^\*{3} /,end:/$/},{begin:/^\+{3}/,end:/$/},{begin:/^\*{15}$/}]},{className:"addition",begin:"^\\+",end:"$"},{className:"deletion",begin:"^\\-",end:"$"},{className:"addition",begin:"^\\!",end:"$"}]}})),nt.registerLanguage("dockerfile",(function(e){return{aliases:["docker"],case_insensitive:!0,keywords:"from maintainer expose env arg user onbuild stopsignal",contains:[e.HASH_COMMENT_MODE,e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,e.NUMBER_MODE,{beginKeywords:"run cmd entrypoint volume add copy workdir label healthcheck shell",starts:{end:/[^\\]$/,subLanguage:"bash"}}],illegal:"</"}})),nt.registerLanguage("go",(function(e){var t={keyword:"break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune",literal:"true false iota nil",built_in:"append cap close complex copy imag len make new panic print println real recover delete"};return{aliases:["golang"],keywords:t,illegal:"</",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"string",variants:[e.QUOTE_STRING_MODE,{begin:"'",end:"[^\\\\]'"},{begin:"`",end:"`"}]},{className:"number",variants:[{begin:e.C_NUMBER_RE+"[i]",relevance:1},e.C_NUMBER_MODE]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[e.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,keywords:t,illegal:/["']/}]}]}})),nt.registerLanguage("http",(function(e){var t="HTTP/[0-9\\.]+";return{aliases:["https"],illegal:"\\S",contains:[{begin:"^"+t,end:"$",contains:[{className:"number",begin:"\\b\\d{3}\\b"}]},{begin:"^[A-Z]+ (.*?) "+t+"$",returnBegin:!0,end:"$",contains:[{className:"string",begin:" ",end:" ",excludeBegin:!0,excludeEnd:!0},{begin:t},{className:"keyword",begin:"[A-Z]+"}]},{className:"attribute",begin:"^\\w",end:": ",excludeEnd:!0,illegal:"\\n|\\s|=",starts:{end:"$",relevance:0}},{begin:"\\n\\n",starts:{subLanguage:[],endsWithParent:!0}}]}})),nt.registerLanguage("javascript",(function(e){var t="[A-Za-z$_][0-9A-Za-z$_]*",n={keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},o={className:"number",variants:[{begin:"\\b(0[bB][01]+)n?"},{begin:"\\b(0[oO][0-7]+)n?"},{begin:e.C_NUMBER_RE+"n?"}],relevance:0},a={className:"subst",begin:"\\$\\{",end:"\\}",keywords:n,contains:[]},i={begin:"html`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,a],subLanguage:"xml"}},r={begin:"css`",end:"",starts:{end:"`",returnEnd:!1,contains:[e.BACKSLASH_ESCAPE,a],subLanguage:"css"}},s={className:"string",begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE,a]};a.contains=[e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,i,r,s,o,e.REGEXP_MODE];var c=a.contains.concat([e.C_BLOCK_COMMENT_MODE,e.C_LINE_COMMENT_MODE]);return{aliases:["js","jsx"],keywords:n,contains:[{className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},{className:"meta",begin:/^#!/,end:/$/},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE,i,r,s,e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,o,{begin:/[{,\n]\s*/,relevance:0,contains:[{begin:t+"\\s*:",returnBegin:!0,relevance:0,contains:[{className:"attr",begin:t,relevance:0}]}]},{begin:"("+e.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,e.REGEXP_MODE,{className:"function",begin:"(\\(.*?\\)|"+t+")\\s*=>",returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:t},{begin:/\(\s*\)/},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:n,contains:c}]}]},{className:"",begin:/\s/,end:/\s*/,skip:!0},{begin:/</,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,subLanguage:"xml",contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},{begin:/<[A-Za-z0-9\\._:-]+/,end:/(\/[A-Za-z0-9\\._:-]+|[A-Za-z0-9\\._:-]+\/)>/,skip:!0,contains:[{begin:/<[A-Za-z0-9\\._:-]+\s*\/>/,skip:!0},"self"]}]}],relevance:0},{className:"function",beginKeywords:"function",end:/\{/,excludeEnd:!0,contains:[e.inherit(e.TITLE_MODE,{begin:t}),{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,contains:c}],illegal:/\[|%/},{begin:/\$[(.]/},e.METHOD_GUARD,{className:"class",beginKeywords:"class",end:/[{;=]/,excludeEnd:!0,illegal:/[:"\[\]]/,contains:[{beginKeywords:"extends"},e.UNDERSCORE_TITLE_MODE]},{beginKeywords:"constructor get set",end:/\{/,excludeEnd:!0}],illegal:/#(?!!)/}})),nt.registerLanguage("markdown",(function(e){return{aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$"},{begin:"^.+?\\n[=-]{2,}$"}]},{begin:"<",end:">",subLanguage:"xml",relevance:0},{className:"bullet",begin:"^\\s*([*+-]|(\\d+\\.))\\s+"},{className:"strong",begin:"[*_]{2}.+?[*_]{2}"},{className:"emphasis",variants:[{begin:"\\*.+?\\*"},{begin:"_.+?_",relevance:0}]},{className:"quote",begin:"^>\\s+",end:"$"},{className:"code",variants:[{begin:"^```\\w*\\s*$",end:"^```[ ]*$"},{begin:"`.+?`"},{begin:"^( {4}|\\t)",end:"$",relevance:0}]},{begin:"^[-\\*]{3,}",end:"$"},{begin:"\\[.+?\\][\\(\\[].*?[\\)\\]]",returnBegin:!0,contains:[{className:"string",begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0,relevance:0},{className:"link",begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}],relevance:10},{begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]}]}})),nt.registerLanguage("mojolicious",(function(e){return{subLanguage:"xml",contains:[{className:"meta",begin:"^__(END|DATA)__$"},{begin:"^\\s*%{1,2}={0,2}",end:"$",subLanguage:"perl"},{begin:"<%{1,2}={0,2}",end:"={0,1}%>",subLanguage:"perl",excludeBegin:!0,excludeEnd:!0}]}})),nt.registerLanguage("nginx",(function(e){var t={className:"variable",variants:[{begin:/\$\d+/},{begin:/\$\{/,end:/}/},{begin:"[\\$\\@]"+e.UNDERSCORE_IDENT_RE}]},n={endsWithParent:!0,lexemes:"[a-z/_]+",keywords:{literal:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},relevance:0,illegal:"=>",contains:[e.HASH_COMMENT_MODE,{className:"string",contains:[e.BACKSLASH_ESCAPE,t],variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/}]},{begin:"([a-z]+):/",end:"\\s",endsWithParent:!0,excludeEnd:!0,contains:[t]},{className:"regexp",contains:[e.BACKSLASH_ESCAPE,t],variants:[{begin:"\\s\\^",end:"\\s|{|;",returnEnd:!0},{begin:"~\\*?\\s+",end:"\\s|{|;",returnEnd:!0},{begin:"\\*(\\.[a-z\\-]+)+"},{begin:"([a-z\\-]+\\.)+\\*"}]},{className:"number",begin:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{className:"number",begin:"\\b\\d+[kKmMgGdshdwy]*\\b",relevance:0},t]};return{aliases:["nginxconf"],contains:[e.HASH_COMMENT_MODE,{begin:e.UNDERSCORE_IDENT_RE+"\\s+{",returnBegin:!0,end:"{",contains:[{className:"section",begin:e.UNDERSCORE_IDENT_RE}],relevance:0},{begin:e.UNDERSCORE_IDENT_RE+"\\s",end:";|{",returnBegin:!0,contains:[{className:"attribute",begin:e.UNDERSCORE_IDENT_RE,starts:n}],relevance:0}],illegal:"[^\\s\\}]"}})),nt.registerLanguage("perl",(function(e){var t="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",n={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:t},o={begin:"->{",end:"}"},a={variants:[{begin:/\$\d/},{begin:/[\$%@](\^\w\b|#\w+(::\w+)*|{\w+}|\w+(::\w*)*)/},{begin:/[\$%@][^\s\w{]/,relevance:0}]},i=[e.BACKSLASH_ESCAPE,n,a],r=[a,e.HASH_COMMENT_MODE,e.COMMENT("^\\=\\w","\\=cut",{endsWithParent:!0}),o,{className:"string",contains:i,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*\\<",end:"\\>",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[e.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[e.BACKSLASH_ESCAPE]},{begin:"{\\w+}",contains:[],relevance:0},{begin:"-?\\w+\\s*\\=\\>",contains:[],relevance:0}]},{className:"number",begin:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",relevance:0},{begin:"(\\/\\/|"+e.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[e.HASH_COMMENT_MODE,{className:"regexp",begin:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",relevance:10},{className:"regexp",begin:"(m|qr)?/",end:"/[a-z]*",contains:[e.BACKSLASH_ESCAPE],relevance:0}]},{className:"function",beginKeywords:"sub",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[e.TITLE_MODE]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return n.contains=r,o.contains=r,{aliases:["pl","pm"],lexemes:/[\w\.]+/,keywords:t,contains:r}})),nt.registerLanguage("python",(function(e){var t={keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda async await nonlocal|10",built_in:"Ellipsis NotImplemented",literal:"False None True"},n={className:"meta",begin:/^(>>>|\.\.\.) /},o={className:"subst",begin:/\{/,end:/\}/,keywords:t,illegal:/#/},a={begin:/\{\{/,relevance:0},i={className:"string",contains:[e.BACKSLASH_ESCAPE],variants:[{begin:/(u|b)?r?'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,n],relevance:10},{begin:/(u|b)?r?"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,n],relevance:10},{begin:/(fr|rf|f)'''/,end:/'''/,contains:[e.BACKSLASH_ESCAPE,n,a,o]},{begin:/(fr|rf|f)"""/,end:/"""/,contains:[e.BACKSLASH_ESCAPE,n,a,o]},{begin:/(u|r|ur)'/,end:/'/,relevance:10},{begin:/(u|r|ur)"/,end:/"/,relevance:10},{begin:/(b|br)'/,end:/'/},{begin:/(b|br)"/,end:/"/},{begin:/(fr|rf|f)'/,end:/'/,contains:[e.BACKSLASH_ESCAPE,a,o]},{begin:/(fr|rf|f)"/,end:/"/,contains:[e.BACKSLASH_ESCAPE,a,o]},e.APOS_STRING_MODE,e.QUOTE_STRING_MODE]},r={className:"number",relevance:0,variants:[{begin:e.BINARY_NUMBER_RE+"[lLjJ]?"},{begin:"\\b(0o[0-7]+)[lLjJ]?"},{begin:e.C_NUMBER_RE+"[lLjJ]?"}]},s={className:"params",begin:/\(/,end:/\)/,contains:["self",n,r,i,e.HASH_COMMENT_MODE]};return o.contains=[i,r,n],{aliases:["py","gyp","ipython"],keywords:t,illegal:/(<\/|->|\?)|=>/,contains:[n,r,i,e.HASH_COMMENT_MODE,{variants:[{className:"function",beginKeywords:"def"},{className:"class",beginKeywords:"class"}],end:/:/,illegal:/[${=;\n,]/,contains:[e.UNDERSCORE_TITLE_MODE,s,{begin:/->/,endsWithParent:!0,keywords:"None"}]},{className:"meta",begin:/^[\t ]*@/,end:/$/},{begin:/\b(print|exec)\(/}]}})),nt.registerLanguage("scss",(function(e){var t={className:"variable",begin:"(\\$[a-zA-Z-][a-zA-Z0-9_-]*)\\b"},n={className:"number",begin:"#[0-9A-Fa-f]+"};e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,e.C_BLOCK_COMMENT_MODE;return{case_insensitive:!0,illegal:"[=/|']",contains:[e.C_LINE_COMMENT_MODE,e.C_BLOCK_COMMENT_MODE,{className:"selector-id",begin:"\\#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},{className:"selector-attr",begin:"\\[",end:"\\]",illegal:"$"},{className:"selector-tag",begin:"\\b(a|abbr|acronym|address|area|article|aside|audio|b|base|big|blockquote|body|br|button|canvas|caption|cite|code|col|colgroup|command|datalist|dd|del|details|dfn|div|dl|dt|em|embed|fieldset|figcaption|figure|footer|form|frame|frameset|(h[1-6])|head|header|hgroup|hr|html|i|iframe|img|input|ins|kbd|keygen|label|legend|li|link|map|mark|meta|meter|nav|noframes|noscript|object|ol|optgroup|option|output|p|param|pre|progress|q|rp|rt|ruby|samp|script|section|select|small|span|strike|strong|style|sub|sup|table|tbody|td|textarea|tfoot|th|thead|time|title|tr|tt|ul|var|video)\\b",relevance:0},{begin:":(visited|valid|root|right|required|read-write|read-only|out-range|optional|only-of-type|only-child|nth-of-type|nth-last-of-type|nth-last-child|nth-child|not|link|left|last-of-type|last-child|lang|invalid|indeterminate|in-range|hover|focus|first-of-type|first-line|first-letter|first-child|first|enabled|empty|disabled|default|checked|before|after|active)"},{begin:"::(after|before|choices|first-letter|first-line|repeat-index|repeat-item|selection|value)"},t,{className:"attribute",begin:"\\b(z-index|word-wrap|word-spacing|word-break|width|widows|white-space|visibility|vertical-align|unicode-bidi|transition-timing-function|transition-property|transition-duration|transition-delay|transition|transform-style|transform-origin|transform|top|text-underline-position|text-transform|text-shadow|text-rendering|text-overflow|text-indent|text-decoration-style|text-decoration-line|text-decoration-color|text-decoration|text-align-last|text-align|tab-size|table-layout|right|resize|quotes|position|pointer-events|perspective-origin|perspective|page-break-inside|page-break-before|page-break-after|padding-top|padding-right|padding-left|padding-bottom|padding|overflow-y|overflow-x|overflow-wrap|overflow|outline-width|outline-style|outline-offset|outline-color|outline|orphans|order|opacity|object-position|object-fit|normal|none|nav-up|nav-right|nav-left|nav-index|nav-down|min-width|min-height|max-width|max-height|mask|marks|margin-top|margin-right|margin-left|margin-bottom|margin|list-style-type|list-style-position|list-style-image|list-style|line-height|letter-spacing|left|justify-content|initial|inherit|ime-mode|image-orientation|image-resolution|image-rendering|icon|hyphens|height|font-weight|font-variant-ligatures|font-variant|font-style|font-stretch|font-size-adjust|font-size|font-language-override|font-kerning|font-feature-settings|font-family|font|float|flex-wrap|flex-shrink|flex-grow|flex-flow|flex-direction|flex-basis|flex|filter|empty-cells|display|direction|cursor|counter-reset|counter-increment|content|column-width|column-span|column-rule-width|column-rule-style|column-rule-color|column-rule|column-gap|column-fill|column-count|columns|color|clip-path|clip|clear|caption-side|break-inside|break-before|break-after|box-sizing|box-shadow|box-decoration-break|bottom|border-width|border-top-width|border-top-style|border-top-right-radius|border-top-left-radius|border-top-color|border-top|border-style|border-spacing|border-right-width|border-right-style|border-right-color|border-right|border-radius|border-left-width|border-left-style|border-left-color|border-left|border-image-width|border-image-source|border-image-slice|border-image-repeat|border-image-outset|border-image|border-color|border-collapse|border-bottom-width|border-bottom-style|border-bottom-right-radius|border-bottom-left-radius|border-bottom-color|border-bottom|border|background-size|background-repeat|background-position|background-origin|background-image|background-color|background-clip|background-attachment|background-blend-mode|background|backface-visibility|auto|animation-timing-function|animation-play-state|animation-name|animation-iteration-count|animation-fill-mode|animation-duration|animation-direction|animation-delay|animation|align-self|align-items|align-content)\\b",illegal:"[^\\s]"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:":",end:";",contains:[t,n,e.CSS_NUMBER_MODE,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,{className:"meta",begin:"!important"}]},{begin:"@",end:"[{;]",keywords:"mixin include extend for if else each while charset import debug media page content font-face namespace warn",contains:[t,e.QUOTE_STRING_MODE,e.APOS_STRING_MODE,n,e.CSS_NUMBER_MODE,{begin:"\\s[A-Za-z0-9_.-]+",relevance:0}]}]}})),nt.registerLanguage("shell",(function(e){return{aliases:["console"],contains:[{className:"meta",begin:"^\\s{0,3}[/\\w\\d\\[\\]()@-]*[>%$#]",starts:{end:"$",subLanguage:"bash"}}]}})),nt.registerLanguage("xml",(function(e){var t={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:"[A-Za-z0-9\\._:-]+",relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/},{begin:/'/,end:/'/},{begin:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,contains:[{className:"meta",begin:"<!DOCTYPE",end:">",relevance:10,contains:[{begin:"\\[",end:"\\]"}]},e.COMMENT("\x3c!--","--\x3e",{relevance:10}),{begin:"<\\!\\[CDATA\\[",end:"\\]\\]>",relevance:10},{className:"meta",begin:/<\?xml/,end:/\?>/,relevance:10},{begin:/<\?(php)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},e.inherit(e.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),e.inherit(e.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]},{className:"tag",begin:"<style(?=\\s|>)",end:">",keywords:{name:"style"},contains:[t],starts:{end:"</style>",returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:"<script(?=\\s|>)",end:">",keywords:{name:"script"},contains:[t],starts:{end:"<\/script>",returnEnd:!0,subLanguage:["actionscript","javascript","handlebars","xml"]}},{className:"tag",begin:"</?",end:"/?>",contains:[{className:"name",begin:/[^\/><\s]+/,relevance:0},t]}]}})),nt.registerLanguage("yaml",(function(e){var t={className:"string",relevance:0,variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/\S+/}],contains:[e.BACKSLASH_ESCAPE,{className:"template-variable",variants:[{begin:"{{",end:"}}"},{begin:"%{",end:"}"}]}]};return{case_insensitive:!0,aliases:["yml","YAML","yaml"],contains:[{className:"attr",variants:[{begin:"\\w[\\w :\\/.-]*:(?=[ \t]|$)"},{begin:'"\\w[\\w :\\/.-]*":(?=[ \t]|$)'},{begin:"'\\w[\\w :\\/.-]*':(?=[ \t]|$)"}]},{className:"meta",begin:"^---s*$",relevance:10},{className:"string",begin:"[\\|>]([0-9]?[+-])?[ ]*\\n( *)[\\S ]+\\n(\\2[\\S ]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!"+e.UNDERSCORE_IDENT_RE},{className:"type",begin:"!!"+e.UNDERSCORE_IDENT_RE},{className:"meta",begin:"&"+e.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+e.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"\\-(?=[ ]|$)",relevance:0},e.HASH_COMMENT_MODE,{beginKeywords:"true false yes no null",keywords:{literal:"true false yes no null"}},{className:"number",begin:e.C_NUMBER_RE+"\\b"},t]}}));class it extends xe{constructor(e){super(),we(this,e,at,ot,s,{class:"className",animation:0,color:0,family:0,name:0,title:0})}}const rt=[];function st(t,n=e){let o;const a=[];function i(e){if(s(t,e)&&(t=e,o)){const e=!rt.length;for(let e=0;e<a.length;e+=1){const n=a[e];n[1](),rt.push(n,t)}if(e){for(let e=0;e<rt.length;e+=2)rt[e][0](rt[e+1]);rt.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(r,s=e){const c=[r,s];return a.push(c),1===a.length&&(o=n(i)||e),r(t),()=>{const e=a.indexOf(c);-1!==e&&a.splice(e,1),0===a.length&&(o(),o=null)}}}}var ct=location.href.replace(/\/+$/,""),dt="",lt=st(""),ut=st({wideScreen:!1,width:0}),ft=st($t(location.href)),pt=st(document.title),gt=st(null);function mt(e,t){var n=e.indexOf(t);return-1==n?null:n}function ht(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!==e){var n=$t(e);if(!n)return location.href=e;t.event&&t.event.preventDefault(),history[t.replace?"replaceState":"pushState"]({},document.title,n.toString()),setTimeout((function(){return ft.set(n)}),0)}}function $t(e){if(-1==(e="/"==e.slice(0,1)?ct+e:e).indexOf(ct))return!1;var t=new URL(e),n=e.substring(ct.length,mt(e,"?")||mt(e,"#")||e.length);Object.defineProperty(t,"path",{value:n,writable:!1});var o=n.split("/").filter((function(e){return e.length})).map(decodeURIComponent);return Object.defineProperty(t,"pathParts",{value:o,writable:!1}),t}function bt(e,t){return Oe.async((function(n){for(;;)switch(n.prev=n.next){case 0:return document.cookie=t.res.headers["Set-Cookie"],t.reset(),n.next=4,Oe.awrap(e.load());case 4:ht(e.calculateLastUrl());case 5:case"end":return n.stop()}}))}function vt(e){var t=d(gt);if(e!=t){if(!t)for(var n=document.querySelectorAll(".js-remove"),o=0;o<n.length;o++)n[o].remove();gt.set(e)}}function yt(e){return ft.base+e}function _t(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(ft)).searchParams.forEach((function(t,n){var o=e[n];o&&o.tagName&&("checkbox"==o.type?o.checked=!!t:o.value=t,o.syncValue&&o.syncValue())}))}function wt(e){let t,n,o;const a=e.$$slots.default,i=u(a,e,null);return{c(){t=C("a"),i&&i.c(),R(t,"href",e.absoluteHref),R(t,"class",e.className),R(t,"style",e.style),R(t,"title",e.title),j(t,"has-path",e.$currentUrl==e.absoluteHref.replace(/(#|\?).*/,"")),o=P(t,"click",e.onClick)},m(o,a){k(o,t,a),i&&i.m(t,null),e.a_binding(t),n=!0},p(e,o){i&&i.p&&e.$$scope&&i.p(p(a,o,e,null),f(a,o,null)),n&&!e.absoluteHref||R(t,"href",o.absoluteHref),n&&!e.className||R(t,"class",o.className),n&&!e.style||R(t,"style",o.style),n&&!e.title||R(t,"title",o.title),(e.className||e.$currentUrl||e.absoluteHref)&&j(t,"has-path",o.$currentUrl==o.absoluteHref.replace(/(#|\?).*/,""))},i(e){n||(pe(i,e),n=!0)},o(e){ge(i,e),n=!1},d(n){n&&E(t),i&&i.d(n),e.a_binding(null),o()}}}function xt(e,t,n){let o;l(e,ft,e=>n("$currentUrl",o=e));let a,{class:i=""}=t,{href:r="/"}=t,{native:s=!1}=t,{replace:c=!1}=t,{style:d=""}=t,{title:u=""}=t;let f,{$$slots:p={},$$scope:g}=t;return e.$set=e=>{"class"in e&&n("className",i=e.class),"href"in e&&n("href",r=e.href),"native"in e&&n("native",s=e.native),"replace"in e&&n("replace",c=e.replace),"style"in e&&n("style",d=e.style),"title"in e&&n("title",u=e.title),"$$scope"in e&&n("$$scope",g=e.$$scope)},e.$$.update=(e={href:1})=>{e.href&&n("absoluteHref",f="/"==r.slice(0,1)?ft.base+r:r)},{className:i,el:a,href:r,native:s,replace:c,style:d,title:u,focus:()=>a.focus(),onClick:function(e){s||ht(e.target.closest("a").href,{event:e,replace:c})},absoluteHref:f,$currentUrl:o,a_binding:function(e){J[e?"unshift":"push"](()=>{n("el",a=e)})},$$slots:p,$$scope:g}}Object.defineProperty(ft,"base",{get:function(){return ct},set:function(e){ct=e.replace(/\/+$/,""),ft.set($t(d(ft).toString()))}});class kt extends xe{constructor(e){super(),we(this,e,xt,wt,s,{class:"className",href:0,native:0,replace:0,style:0,title:0,focus:0})}get focus(){return this.$$.ctx.focus}}const Et=()=>({}),Ot=()=>({}),Ct=()=>({}),Nt=()=>({});function St(e){let t,n,o,a,r,s,c,d;const l=e.$$slots.label,g=u(l,e,Nt),m=e.$$slots.help,h=u(m,e,Ot);return{c(){t=C("div"),n=C("label"),g||(o=N("Label")),g&&g.c(),a=S(),r=C("input"),s=S(),h&&h.c(),R(n,"for",e.id),R(r,"type","text"),R(r,"autocomplete",e.autocomplete),R(r,"name",e.name),R(r,"placeholder",e.placeholder),R(r,"id",e.id),r.readOnly=e.readonly,R(t,"class","text-field"),t.hidden=e.hidden,d=[P(r,"input",e.input_input_handler),P(r,"keyup",e.keyup_handler)]},m(i,d){k(i,t,d),x(t,n),g||x(n,o),g&&g.m(n,null),x(t,a),x(t,r),T(r,e.value),e.input_binding(r),x(t,s),h&&h.m(t,null),c=!0},p(e,o){g&&g.p&&e.$$scope&&g.p(p(l,o,e,Ct),f(l,o,Nt)),c&&!e.id||R(n,"for",o.id),c&&!e.autocomplete||R(r,"autocomplete",o.autocomplete),c&&!e.name||R(r,"name",o.name),c&&!e.placeholder||R(r,"placeholder",o.placeholder),c&&!e.id||R(r,"id",o.id),c&&!e.readonly||(r.readOnly=o.readonly),e.value&&r.value!==o.value&&T(r,o.value),h&&h.p&&e.$$scope&&h.p(p(m,o,e,Et),f(m,o,Ot)),c&&!e.hidden||(t.hidden=o.hidden)},i(e){c||(pe(g,e),pe(h,e),c=!0)},o(e){ge(g,e),ge(h,e),c=!1},d(n){n&&E(t),g&&g.d(n),e.input_binding(null),h&&h.d(n),i(d)}}}function Dt(e,t,n){let o,{autocomplete:a=null}=t,{hidden:i=!1}=t,{name:r=""}=t,{id:s=(r?"form_"+r:Xe())}=t,{placeholder:c=""}=t,{readonly:d=!1}=t,{value:l=""}=t,{$$slots:u={},$$scope:f}=t;return e.$set=e=>{"autocomplete"in e&&n("autocomplete",a=e.autocomplete),"hidden"in e&&n("hidden",i=e.hidden),"name"in e&&n("name",r=e.name),"id"in e&&n("id",s=e.id),"placeholder"in e&&n("placeholder",c=e.placeholder),"readonly"in e&&n("readonly",d=e.readonly),"value"in e&&n("value",l=e.value),"$$scope"in e&&n("$$scope",f=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&o&&!o.syncValue&&(n("inputEl",o.syncValue=function(){n("value",l=this.value)},o),o.syncValue())},{inputEl:o,autocomplete:a,hidden:i,name:r,id:s,placeholder:c,readonly:d,value:l,keyup_handler:function(t){V(e,t)},input_input_handler:function(){l=this.value,n("value",l),n("inputEl",o)},input_binding:function(e){J[e?"unshift":"push"](()=>{n("inputEl",o=e)})},$$slots:u,$$scope:f}}class Pt extends xe{constructor(e){super(),we(this,e,Dt,St,s,{autocomplete:0,hidden:0,name:0,id:0,placeholder:0,readonly:0,value:0})}}function Mt(e){const t=e-1;return t*t*t+1}function Rt(e,{delay:n=0,duration:o=400,easing:a=t}){const i=+getComputedStyle(e).opacity;return{delay:n,duration:o,easing:a,css:e=>`opacity: ${e*i}`}}function At(e,{delay:t=0,duration:n=400,easing:o=Mt,x:a=0,y:i=0,opacity:r=0}){const s=getComputedStyle(e),c=+s.opacity,d="none"===s.transform?"":s.transform,l=c*(1-r);return{delay:t,duration:n,easing:o,css:(e,t)=>`\n\t\t\ttransform: ${d} translate(${(1-e)*a}px, ${(1-e)*i}px);\n\t\t\topacity: ${c-l*t}`}}
/*! Copyright Twitter Inc. and other contributors. Licensed under MIT */var Tt=function(){var e={base:"https://twemoji.maxcdn.com/v/12.1.3/",ext:".png",size:"72x72",className:"emoji",convert:{fromCodePoint:function(e){var t="string"==typeof e?parseInt(e,16):e;if(t<65536)return s(t);return s(55296+((t-=65536)>>10),56320+(1023&t))},toCodePoint:h},onerror:function(){this.parentNode&&this.parentNode.replaceChild(c(this.alt,!1),this)},parse:function(t,n){n&&"function"!=typeof n||(n={callback:n});return("string"==typeof t?f:u)(t,{callback:n.callback||d,attributes:"function"==typeof n.attributes?n.attributes:g,base:"string"==typeof n.base?n.base:e.base,ext:n.ext||e.ext,size:n.folder||(o=n.size||e.size,"number"==typeof o?o+"x"+o:o),className:n.className||e.className,onerror:n.onerror||e.onerror});var o},replace:m,test:function(e){n.lastIndex=0;var t=n.test(e);return n.lastIndex=0,t}},t={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},n=/(?:\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c\udffb|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c\udffb|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb\udffc]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffd]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69])(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,o=/\uFE0F/g,a=String.fromCharCode(8205),i=/[&<>'"]/g,r=/^(?:iframe|noframes|noscript|script|select|style|textarea)$/,s=String.fromCharCode;return e;function c(e,t){return document.createTextNode(t?e.replace(o,""):e)}function d(e,t){return"".concat(t.base,t.size,"/",e,t.ext)}function l(e){return h(e.indexOf(a)<0?e.replace(o,""):e)}function u(e,t){for(var o,a,i,s,d,u,f,p,g,m,h,$,b,v=function e(t,n){for(var o,a,i=t.childNodes,s=i.length;s--;)3===(a=(o=i[s]).nodeType)?n.push(o):1!==a||"ownerSVGElement"in o||r.test(o.nodeName.toLowerCase())||e(o,n);return n}(e,[]),y=v.length;y--;){for(i=!1,s=document.createDocumentFragment(),u=(d=v[y]).nodeValue,p=0;f=n.exec(u);){if((g=f.index)!==p&&s.appendChild(c(u.slice(p,g),!0)),$=l(h=f[0]),p=g+h.length,b=t.callback($,t),$&&b){for(a in(m=new Image).onerror=t.onerror,m.setAttribute("draggable","false"),o=t.attributes(h,$))o.hasOwnProperty(a)&&0!==a.indexOf("on")&&!m.hasAttribute(a)&&m.setAttribute(a,o[a]);m.className=t.className,m.alt=h,m.src=b,i=!0,s.appendChild(m)}m||s.appendChild(c(h,!1)),m=null}i&&(p<u.length&&s.appendChild(c(u.slice(p),!0)),d.parentNode.replaceChild(s,d))}return e}function f(e,t){return m(e,(function(e){var n,o,a=e,r=l(e),s=t.callback(r,t);if(r&&s){for(o in a="<img ".concat('class="',t.className,'" ','draggable="false" ','alt="',e,'"',' src="',s,'"'),n=t.attributes(e,r))n.hasOwnProperty(o)&&0!==o.indexOf("on")&&-1===a.indexOf(" "+o+"=")&&(a=a.concat(" ",o,'="',n[o].replace(i,p),'"'));a=a.concat("/>")}return a}))}function p(e){return t[e]}function g(){return null}function m(e,t){return String(e).replace(n,t)}function h(e,t){for(var n=[],o=0,a=0,i=0;i<e.length;)o=e.charCodeAt(i++),a?(n.push((65536+(a-55296<<10)+(o-56320)).toString(16)),a=0):55296<=o&&o<=56319?a=o:n.push(o.toString(16));return n.join(t||"-")}}(),Lt=new RegExp("(\\\\?)`([^`]+)`","g"),jt={},It={},Ut=new RegExp("\\b[a-z]{2,5}://\\S+","g"),zt=new RegExp("\\[([^\\]]+)\\]\\(([^)]+)\\)","g"),Bt=new RegExp("(^|\\s)(\\\\?)(\\*+|_+)(\\w[^<]*?)\\3","g"),Ht={":confused:":":/",":disappointed:":":(",":grin:":";D",":heart:":"&lt;3",":slight_smile:":":)",":smiley:":":D",":stuck_out_tongue:":":P",":wink:":";)"},qt=new RegExp("(^|\\s)(:\\w+:|"+Object.keys(Ht).map((function(e){return Ze(Ht[e])})).join("|")+")(?=\\W|$)","gi"),Ft={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;"};function Kt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"single";return window.__emojiList&&(window.__emojiList.forEach((function(e){if(":"==(e.shortname||"")[0]){if(Ht[e.shortname]&&(It[Ht[e.shortname]]=e),It[e.shortname]=e,e.category){var t=":"+e.category;jt[t]||(jt[t]=[]),jt[t].push(e)}e.shortname.match(/(_|:)\w/g).forEach((function(t){jt[t]||(jt[t]=[]),jt[t].push(e)})),delete e.category,delete e.html,delete e.order,delete e.unicode}})),delete window.__emojiList),"group"==t?jt[e]||[]:It[e]||{}}function Gt(e){e=e.replace(/[&<>"']/g,(function(e){return Ft[e]}));var t=0;return e=e.replace(/^&gt;\s(.*)/,(function(e,t){return"<blockquote>"+t+"</blockquote>"})).replace(Bt,(function(e,t,n,o,a){return o.match(/^_/)&&a.match(/^[A-Z]+$/)?e:1==o.length?n?e.replace(/^\\/,""):t+"<em>"+a+"</em>":2==o.length?n?e.replace(/^\\/,""):t+"<strong>"+a+"</strong>":3==o.length?n?e.replace(/^\\/,""):t+"<em><strong>"+a+"</strong></em>":e})).replace(zt,(function(e,n,o){t++;var a=0==o.indexOf("/")?"_self":"_blank";return"_self"==a&&(o=yt(o)),'<a href="'+o+'" target="'+a+'">'+n+"</a>"})).replace(Lt,(function(e,t,n){return t?e.replace(/^\\/,""):"<code>"+n+"</code>"})),t||(e=e.replace(Ut,(function(e){var t=e.match(/^(.*?)(&\w+;|\W)?$/);return'<a href="'+t[1]+'" target="_blank">'+t[1].replace(/^https:\/\//,"")+"</a>"+(t[2]||"")})).replace(/mailto:(\S+)/,(function(e,t){return-1!=e.indexOf('">')?e:'<a href="'+e+'" target="_blank">'+t+"</a>"}))),e=Tt.parse(e.replace(qt,(function(e,t,n){return t+(Kt(n).emoji||n)})))}var Wt={en:{}},Zt="en";function Vt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return String(Wt[e]&&Wt[e][Zt]||e).replace(/(%?)%(\d+)/g,(function(e,t,o){return"%"==t?t+o:n[o-1]}))}function Yt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return Gt(Vt.apply(void 0,[e].concat(n)))}function Jt(e,t){return e.frozen?Vt(e.frozen):e==t?Vt("Connection messages."):(t.frozen?Vt(t.frozen):t.topic)||t.is_private&&Vt("Private conversation.")||Vt("No topic is set.")}function Qt(e,t,n){const o=Object.create(e);return o.dialog=t[n],o}function Xt(e,t,n){const o=Object.create(e);return o.connection=t[n],o}function en(e){let t,n,o,a,i,r,s,c,d=e.connection.connection_id+"",l=mn(e.connection)+"";const u=new it({props:{name:"network-wired"}});return{c(){ve(u.$$.fragment),t=S(),n=C("span"),o=N(d),a=S(),i=C("b"),r=N(l),R(i,"class","unread"),i.hidden=s=!e.connection.unread},m(e,s){ye(u,e,s),k(e,t,s),k(e,n,s),x(n,o),k(e,a,s),k(e,i,s),x(i,r),c=!0},p(e,t){c&&!e.$user||d===(d=t.connection.connection_id+"")||A(o,d),c&&!e.$user||l===(l=mn(t.connection)+"")||A(r,l),(!c||e.$user&&s!==(s=!t.connection.unread))&&(i.hidden=s)},i(e){c||(pe(u.$$.fragment,e),c=!0)},o(e){ge(u.$$.fragment,e),c=!1},d(e){_e(u,e),e&&E(t),e&&E(n),e&&E(a),e&&E(i)}}}function tn(e){let t,n,o,a,i,r,s,c,d=e.dialog.name+"",l=mn(e.dialog)+"";const u=new it({props:{name:e.dialog.is_private?"user":"user-friends"}});return{c(){ve(u.$$.fragment),t=S(),n=C("span"),o=N(d),a=S(),i=C("b"),r=N(l),R(i,"class","unread"),i.hidden=s=!e.dialog.unread},m(e,s){ye(u,e,s),k(e,t,s),k(e,n,s),x(n,o),k(e,a,s),k(e,i,s),x(i,r),c=!0},p(e,t){const n={};e.$user&&(n.name=t.dialog.is_private?"user":"user-friends"),u.$set(n),c&&!e.$user||d===(d=t.dialog.name+"")||A(o,d),c&&!e.$user||l===(l=mn(t.dialog)+"")||A(r,l),(!c||e.$user&&s!==(s=!t.dialog.unread))&&(i.hidden=s)},i(e){c||(pe(u.$$.fragment,e),c=!0)},o(e){ge(u.$$.fragment,e),c=!1},d(e){_e(u,e),e&&E(t),e&&E(n),e&&E(a),e&&E(i)}}}function nn(e){let t;const n=new kt({props:{href:e.dialog.path,class:gn(e.connection,e.dialog),title:Jt(e.connection,e.dialog),$$slots:{default:[tn]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$user&&(o.href=t.dialog.path),e.$user&&(o.class=gn(t.connection,t.dialog)),e.$user&&(o.title=Jt(t.connection,t.dialog)),(e.$$scope||e.$user)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function on(e){let t,n,o;const a=new kt({props:{href:e.connection.path,class:gn(e.connection,e.connection),title:Jt(e.connection,e.connection),$$slots:{default:[en]},$$scope:{ctx:e}}});let i=e.connection.dialogs.toArray(),r=[];for(let t=0;t<i.length;t+=1)r[t]=nn(Qt(e,i,t));const s=e=>ge(r[e],1,1,()=>{r[e]=null});return{c(){ve(a.$$.fragment),t=S();for(let e=0;e<r.length;e+=1)r[e].c();n=D()},m(e,i){ye(a,e,i),k(e,t,i);for(let t=0;t<r.length;t+=1)r[t].m(e,i);k(e,n,i),o=!0},p(e,t){const o={};if(e.$user&&(o.href=t.connection.path),e.$user&&(o.class=gn(t.connection,t.connection)),e.$user&&(o.title=Jt(t.connection,t.connection)),(e.$$scope||e.$user)&&(o.$$scope={changed:e,ctx:t}),a.$set(o),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let o;for(i=t.connection.dialogs.toArray(),o=0;o<i.length;o+=1){const a=Qt(t,i,o);r[o]?(r[o].p(e,a),pe(r[o],1)):(r[o]=nn(a),r[o].c(),pe(r[o],1),r[o].m(n.parentNode,n))}for(ue(),o=i.length;o<r.length;o+=1)s(o);fe()}},i(e){if(!o){pe(a.$$.fragment,e);for(let e=0;e<i.length;e+=1)pe(r[e]);o=!0}},o(e){ge(a.$$.fragment,e),r=r.filter(Boolean);for(let e=0;e<r.length;e+=1)ge(r[e]);o=!1},d(e){_e(a,e),e&&E(t),O(r,e),e&&E(n)}}}function an(e){let t,n,o,a,i,r,s,c=mn(e.$notifications)+"";const d=new it({props:{name:e.$notifications.unread?"bell":"bell-slash"}});return{c(){ve(d.$$.fragment),t=S(),(n=C("span")).textContent=`${Vt("Notifications")}`,o=S(),a=C("b"),i=N(c),R(a,"class","unread"),a.hidden=r=!e.$notifications.unread},m(e,r){ye(d,e,r),k(e,t,r),k(e,n,r),k(e,o,r),k(e,a,r),x(a,i),s=!0},p(e,t){const n={};e.$notifications&&(n.name=t.$notifications.unread?"bell":"bell-slash"),d.$set(n),s&&!e.$notifications||c===(c=mn(t.$notifications)+"")||A(i,c),(!s||e.$notifications&&r!==(r=!t.$notifications.unread))&&(a.hidden=r)},i(e){s||(pe(d.$$.fragment,e),s=!0)},o(e){ge(d.$$.fragment,e),s=!1},d(e){_e(d,e),e&&E(t),e&&E(n),e&&E(o),e&&E(a)}}}function rn(t){let n,o,a;const i=new it({props:{name:"comment"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Add conversation")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function sn(t){let n,o,a;const i=new it({props:{name:"network-wired"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Add connection")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function cn(t){let n,o,a;const i=new it({props:{name:"user-cog"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Account")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function dn(t){let n,o,a;const i=new it({props:{name:"question-circle"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Help")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function ln(e){let t;const n=new kt({props:{href:"/settings",$$slots:{default:[un]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function un(t){let n,o,a;const i=new it({props:{name:"tools"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Settings")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function fn(t){let n,o,a;const i=new it({props:{name:"power-off"}});return{c(){ve(i.$$.fragment),n=S(),(o=C("span")).textContent=`${Vt("Log out")}`},m(e,t){ye(i,e,t),k(e,n,t),k(e,o,t),a=!0},p:e,i(e){a||(pe(i.$$.fragment,e),a=!0)},o(e){ge(i.$$.fragment,e),a=!1},d(e){_e(i,e),e&&E(n),e&&E(o)}}}function pn(e){let t,n,o,a,r,s,c,d,l,u,f,p,g,m,h,$,b,v,y,_,w,D,M,L=(e.$user.email||Vt("Account"))+"",I=e.$user.roles.has("admin");const U=new it({props:{name:"search"}});let z=e.$user.connections.toArray(),B=[];for(let t=0;t<z.length;t+=1)B[t]=on(Xt(e,z,t));const H=e=>ge(B[e],1,1,()=>{B[e]=null}),q=new kt({props:{href:"/chat",$$slots:{default:[an]},$$scope:{ctx:e}}}),F=new kt({props:{href:"/add/conversation",$$slots:{default:[rn]},$$scope:{ctx:e}}}),K=new kt({props:{href:"/add/connection",$$slots:{default:[sn]},$$scope:{ctx:e}}}),G=new kt({props:{href:"/settings/account",$$slots:{default:[cn]},$$scope:{ctx:e}}}),W=new kt({props:{href:"/help",$$slots:{default:[dn]},$$scope:{ctx:e}}});let Z=I&&ln(e);const V=new kt({props:{href:"/api/user/logout.html",native:!0,$$slots:{default:[fn]},$$scope:{ctx:e}}});return{c(){t=C("div"),n=C("form"),o=C("input"),r=S(),s=C("label"),ve(U.$$.fragment),c=S(),d=C("nav"),(l=C("h3")).textContent=`${Vt("Conversations")}`,u=S();for(let e=0;e<B.length;e+=1)B[e].c();f=S(),p=C("h3"),g=N(L),m=S(),ve(q.$$.fragment),h=S(),ve(F.$$.fragment),$=S(),ve(K.$$.fragment),b=S(),ve(G.$$.fragment),v=S(),ve(W.$$.fragment),y=S(),Z&&Z.c(),_=S(),ve(V.$$.fragment),R(o,"type","text"),R(o,"id","sidebar_left_search_input"),R(o,"placeholder",a=e.searchHasFocus?Vt("Search..."):Vt("Convos")),R(s,"for","sidebar_left_search_input"),R(n,"class","sidebar__header"),R(d,"class","sidebar-left__nav"),j(d,"is-filtering",e.filter.length>0),R(t,"class","sidebar-left"),M=[P(o,"input",e.input_input_handler),P(o,"blur",e.clearFilter),P(o,"focus",e.filterNav),P(o,"keydown",e.onSearchKeydown),P(n,"submit",hn),P(d,"click",e.onNavItemClicked)]},m(a,i){k(a,t,i),x(t,n),x(n,o),T(o,e.filter),x(n,r),x(n,s),ye(U,s,null),x(t,c),x(t,d),x(d,l),x(d,u);for(let e=0;e<B.length;e+=1)B[e].m(d,null);x(d,f),x(d,p),x(p,g),x(d,m),ye(q,d,null),x(d,h),ye(F,d,null),x(d,$),ye(K,d,null),x(d,b),ye(G,d,null),x(d,v),ye(W,d,null),x(d,y),Z&&Z.m(d,null),x(d,_),ye(V,d,null),e.nav_binding(d),D=!0},p(e,t){if((!D||e.searchHasFocus&&a!==(a=t.searchHasFocus?Vt("Search..."):Vt("Convos")))&&R(o,"placeholder",a),e.filter&&o.value!==t.filter&&T(o,t.filter),e.$user||e.dialogClassNames||e.topicOrStatus||e.renderUnread){let n;for(z=t.$user.connections.toArray(),n=0;n<z.length;n+=1){const o=Xt(t,z,n);B[n]?(B[n].p(e,o),pe(B[n],1)):(B[n]=on(o),B[n].c(),pe(B[n],1),B[n].m(d,f))}for(ue(),n=z.length;n<B.length;n+=1)H(n);fe()}D&&!e.$user||L===(L=(t.$user.email||Vt("Account"))+"")||A(g,L);const n={};(e.$$scope||e.$notifications)&&(n.$$scope={changed:e,ctx:t}),q.$set(n);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),F.$set(i);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:t}),K.$set(r);const s={};e.$$scope&&(s.$$scope={changed:e,ctx:t}),G.$set(s);const c={};e.$$scope&&(c.$$scope={changed:e,ctx:t}),W.$set(c),e.$user&&(I=t.$user.roles.has("admin")),I?Z?(Z.p(e,t),pe(Z,1)):((Z=ln(t)).c(),pe(Z,1),Z.m(d,_)):Z&&(ue(),ge(Z,1,1,()=>{Z=null}),fe());const l={};e.$$scope&&(l.$$scope={changed:e,ctx:t}),V.$set(l),e.filter&&j(d,"is-filtering",t.filter.length>0)},i(n){if(!D){pe(U.$$.fragment,n);for(let e=0;e<z.length;e+=1)pe(B[e]);pe(q.$$.fragment,n),pe(F.$$.fragment,n),pe(K.$$.fragment,n),pe(G.$$.fragment,n),pe(W.$$.fragment,n),pe(Z),pe(V.$$.fragment,n),ae(()=>{w||(w=he(t,At,e.transition,!0)),w.run(1)}),D=!0}},o(n){ge(U.$$.fragment,n),B=B.filter(Boolean);for(let e=0;e<B.length;e+=1)ge(B[e]);ge(q.$$.fragment,n),ge(F.$$.fragment,n),ge(K.$$.fragment,n),ge(G.$$.fragment,n),ge(W.$$.fragment,n),ge(Z),ge(V.$$.fragment,n),w||(w=he(t,At,e.transition,!1)),w.run(0),D=!1},d(n){n&&E(t),_e(U),O(B,n),_e(q),_e(F),_e(K),_e(G),_e(W),Z&&Z.d(),_e(V),e.nav_binding(null),n&&w&&w.end(),i(M)}}}function gn(e,t){const n=[t.dialog_id?"for-dialog":"for-connection"];return(t.frozen||"connected"!=e.state)&&n.push("is-frozen"),t.errors&&n.push("has-errors"),n.join(" ")}function mn(e){return e.unread>60?"60+":e.unread||0}const hn=e=>e.preventDefault();function $n(e,t,n){let o,a,i;l(e,lt,e=>n("$activeMenu",a=e));let{transition:r}=t;const s=Z("user");l(e,s,e=>n("$user",o=e));const c=o.notifications;l(e,c,e=>n("$notifications",i=e));let d,u=0,f="",p=!1,m=[];function h(){n("searchHasFocus",p=!1),setTimeout(()=>{n("filter",f="")},100)}function $(){if(!d)return;const e=f.match(/^\W+/)?"":"\\b\\W*",t=new RegExp(e+Ze(f),"i"),o={};n("activeLinkIndex",u=0),n("searchHasFocus",p=!0),n("visibleLinks",m=[]),We(d,"a",(e,a)=>{const i=e.classList;!f.length&&i.contains("has-path")&&n("activeLinkIndex",u=a),i.remove("has-focus");const r=!f.length||!o[e.href]&&e.textContent.match(t);r&&m.push(e),Ye(e,r),o[e.href]=!0}),We(d,".for-connection",e=>{let t=e;for(;(t=t.nextElementSibling)&&t.classList.contains("for-dialog");)if(Ye(t,"is-visible"))return Ye(e,!0)}),We(d,"h3",e=>{let t=e;for(;(t=t.nextElementSibling)&&!Qe(t,"h3");)if(Ye(t,"is-visible"))return Ye(e,!0);Ye(e,!1)})}return e.$set=e=>{"transition"in e&&n("transition",r=e.transition)},e.$$.update=(e={filter:1,visibleLinks:1,activeLinkIndex:1})=>{e.filter&&$(),(e.visibleLinks||e.activeLinkIndex)&&m[u]&&m[u].classList.add("has-focus")},{transition:r,user:s,notifications:c,filter:f,navEl:d,searchHasFocus:p,clearFilter:h,filterNav:$,onNavItemClicked:function(e){(e.target.className||"").match(/network|user/)&&setTimeout(()=>{g(lt,a="settings")},50)},onSearchKeydown:function(e){if(13==e.keyCode)return e.preventDefault(),h(),void(m[u]&&ht(m[u].href));const t=38==e.keyCode?-1:40==e.keyCode?1:0;t&&(e.preventDefault(),m[u]&&m[u].classList.remove("has-focus"),n("activeLinkIndex",u+=e.ctrlKey?4*t:t)),u<0&&n("activeLinkIndex",u=m.length-1),u>=m.length&&n("activeLinkIndex",u=0)},$user:o,$notifications:i,input_input_handler:function(){f=this.value,n("filter",f)},nav_binding:function(e){J[e?"unshift":"push"](()=>{n("navEl",d=e)})}}}class bn extends xe{constructor(e){super(),we(this,e,$n,pn,s,{transition:0})}}function vn(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Convos")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function yn(t){let n,o=Vt("Login")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function _n(t){let n,o=Vt("Create account")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function wn(t){let n,o=Vt("Documentation")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function xn(t){let n,o=Vt("GitHub")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function kn(e){let t,n,o,a,i,r,s,c,d,l;const u=new kt({props:{href:"/",$$slots:{default:[vn]},$$scope:{ctx:e}}}),f=new kt({props:{href:"/login",$$slots:{default:[yn]},$$scope:{ctx:e}}}),p=new kt({props:{href:"/register",$$slots:{default:[_n]},$$scope:{ctx:e}}}),g=new kt({props:{href:"https://convos.by/doc",$$slots:{default:[wn]},$$scope:{ctx:e}}}),m=new kt({props:{href:"https://github.com/Nordaaker/convos",$$slots:{default:[xn]},$$scope:{ctx:e}}});return{c(){t=C("div"),n=C("h1"),ve(u.$$.fragment),o=S(),(a=C("p")).textContent=`${Vt("A multiuser chat application.")}`,i=S(),r=C("nav"),ve(f.$$.fragment),s=S(),ve(p.$$.fragment),c=S(),ve(g.$$.fragment),d=S(),ve(m.$$.fragment),R(r,"class","sidebar-left__nav"),R(t,"class","sidebar-left")},m(e,h){k(e,t,h),x(t,n),ye(u,n,null),x(t,o),x(t,a),x(t,i),x(t,r),ye(f,r,null),x(r,s),ye(p,r,null),x(r,c),ye(g,r,null),x(r,d),ye(m,r,null),l=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),u.$set(n);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),f.$set(o);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),p.$set(a);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),g.$set(i);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:t}),m.$set(r)},i(e){l||(pe(u.$$.fragment,e),pe(f.$$.fragment,e),pe(p.$$.fragment,e),pe(g.$$.fragment,e),pe(m.$$.fragment,e),l=!0)},o(e){ge(u.$$.fragment,e),ge(f.$$.fragment,e),ge(p.$$.fragment,e),ge(g.$$.fragment,e),ge(m.$$.fragment,e),l=!1},d(e){e&&E(t),_e(u),_e(f),_e(p),_e(g),_e(m)}}}class En extends xe{constructor(e){super(),we(this,e,null,kn,s,{})}}var On=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e};var Cn=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Le(e)););return e},Nn=ke((function(e){function t(n,o,a){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=t=Reflect.get:e.exports=t=function(e,t,n){var o=Cn(e,t);if(o){var a=Object.getOwnPropertyDescriptor(o,t);return a.get?a.get.call(n):a.value}},t(n,o,a||n)}e.exports=t})),Sn=function(){function e(t){var n=this;Ce(this,e),this._url=new URL("http://localhost"),Object.defineProperty(this,"href",{get:function(){return n._url.href.replace(/^http:/,n.protocol)},set:function(e){n._url.href=e.replace(/^\w+:/,"http:"),n.protocol=e.match(/^\w+:/)[0]}}),["host","pathname","password","searchParams","username"].forEach((function(e){Object.defineProperty(n,e,{get:function(){return n._url[e]},set:function(t){n._url[e]=t}})})),this.href=t}return Se(e,[{key:"fromForm",value:function(e){var t=e.server.value;return e.nick.value.length&&this.searchParams.append("nick",e.nick.value),this.searchParams.append("tls",e.tls.checked?"1":"0"),this.searchParams.append("tls_verify",e.tls_verify&&e.tls_verify.checked?"1":"0"),this.host=t.match(/:\d+$/)?t:t+":6667",this.password=e.password.value,this.username=e.username.value,this}},{key:"toString",value:function(){return this.href.replace(/^http:/,this.connProtocol)}}]),e}();var Dn=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}};var Pn=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)};var Mn=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var Rn=function(e){return Dn(e)||Pn(e)||Mn()};var An=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},Tn=ke((function(e){function t(n,o,a){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?e.exports=t=function(e,t,n){var o=[null];o.push.apply(o,t);var a=new(Function.bind.apply(e,o));return n&&je(a,n.prototype),a}:e.exports=t=Reflect.construct,t.apply(null,arguments)}e.exports=t})),Ln=ke((function(e){function t(n){var o="function"==typeof Map?new Map:void 0;return e.exports=t=function(e){if(null===e||!An(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==o){if(o.has(e))return o.get(e);o.set(e,t)}function t(){return Tn(e,arguments,Le(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),je(t,e)},t(n)}e.exports=t})),jn=function(e,t){return e.name.localeCompare(t.name)},In=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ce(this,t),(e=Te(this,Le(t).call(this,n))).sorter=o.sorter||jn,e._sort(),e}return Ie(t,e),Se(t,[{key:"filter",value:function(e){return Array.from(this.values()).filter(e)}},{key:"set",value:function(e,n){Nn(Le(t.prototype),"set",this).call(this,e,n),this._sort()}},{key:"toArray",value:function(){return Array.from(this.values())}},{key:"_sort",value:function(){var e=this,n=Array.from(this.entries()),o=this.sorter;return this.clear(),n.sort((function(e,t){return o(e[1],t[1])})).forEach((function(n){var o=Re(n,2),a=o[0],i=o[1];return Nn(Le(t.prototype),"set",e).call(e,a,i)})),n}}]),t}(Ln(Map)),Un={0:"Jan",1:"Feb",2:"March",3:"Apr",4:"May",5:"Jun",6:"July",7:"Aug",8:"Sept",9:"Oct",10:"Nov",11:"Dec"},zn=function(e){function t(e){return Ce(this,t),"string"!=typeof e||e.match(/Z$/)||(e+="Z"),Te(this,Le(t).call(this,e||new Date))}return Ie(t,e),Se(t,[{key:"getHumanDate",value:function(){var e=this.getMonthAbbr()+" "+this.getDate(),n=new t;return this.getYear()==n.getYear()||(e+=", "+this.getFullYear()),e}},{key:"getHM",value:function(){return[this.getHours(),this.getMinutes()].map((function(e){return e<10?"0"+e:e})).join(":")}},{key:"getMonthAbbr",value:function(){return Un[this.getMonth()]||""}},{key:"toEpoch",value:function(){return this.getTime()/1e3}}]),t}(Ln(Date)),Bn={b:"channel_ban",C:"ctcp_block",c:"colour_filter",e:"ban_exemption",F:"enable_forwarding",f:"forward",g:"free_invite",I:"invite_exemption",j:"join_throttle",k:"password",l:"join_limit",L:"large_ban_list",m:"moderated",n:"prevent_external_send",P:"permanent",p:"privat",Q:"block_forwarded_users",q:"quiet",r:"block_unidentified",s:"secret",S:"secure_connection_only",t:"ops_topic"},Hn={a:"admin",B:"bot",h:"half_operator",i:"invisible",I:"whois_hide_online",o:"operator",p:"whois_hide_channels",R:"privmsg_from_registered_only",r:"registered",S:"service_bot",T:"ctcp_block",t:"vhost",v:"voice",W:"whois_notifications",x:"cloaked_hostname",z:"secure_connection",Z:"secure_connection_only"};function qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qn(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Kn=new RegExp("^[#&]"),Gn={o:"@",v:"+"},Wn=function(e,t){return t.modes.operator||!1-e.modes.operator||t.modes.voice||!1-e.modes.voice||e.name.localeCompare(t.name)},Zn=function(e){function t(e){var n;Ce(this,t),n=Te(this,Le(t).call(this));var o=["","chat"];return e.connection_id&&o.push(e.connection_id),e.dialog_id&&o.push(e.dialog_id),e.connection_id&&!e.name&&console.trace("[Convos] Invalid params was passed on to new Dialog(",e,")"),n.prop("ro","_participants",new In([],{sorter:Wn})),n.prop("ro","api",e.api),n.prop("ro","color",Je(e.dialog_id||e.connection_id||"")),n.prop("ro","connection_id",e.connection_id||""),n.prop("ro","events",e.events),n.prop("ro","is_private",(function(){return n.dialog_id&&!Kn.test(n.name)})),n.prop("ro","path",o.map((function(e){return encodeURIComponent(e)})).join("/")),n.prop("rw","errors",0),n.prop("rw","last_active",new zn(e.last_active)),n.prop("rw","last_read",new zn(e.last_read)),n.prop("rw","messages",[]),n.prop("rw","modes",{}),n.prop("rw","name",e.name||e.dialog_id||"#unknown"),n.prop("rw","status","pending"),n.prop("rw","topic",e.topic||""),n.prop("rw","unread",e.unread||0),e.hasOwnProperty("dialog_id")?(n.prop("ro","dialog_id",e.dialog_id),n.prop("rw","frozen",e.frozen||"")):n.prop("ro","frozen",(function(){return n._calculateFrozen()})),e.dialog_id&&n.prop("persist","wantNotifications",!1,{key:e.dialog_id+":wantNotifications",lazy:!0}),n._addOperations(),n}return Ie(t,e),Se(t,[{key:"addMessage",value:function(e){if(e.from&&-1!=["action","error","private"].indexOf(e.type)){if(e.highlight||this.is_private||this.wantNotifications){var t=e.from==this.name?e.from:Vt("%1 in %2",e.from,this.name);this.events.notifyUser(t,e.message)}this.update({unread:this.unread+1})}return this.addMessages("push",[e])}},{key:"addMessages",value:function(e,t){var n=0,o=t.length;switch(e){case"push":n=this.messages.length,o=(t=this.messages.concat(t)).length;break;case"unshift":t=t.concat(this.messages)}for(var a=n;a<o;a++){var i=t[a];i.hasOwnProperty("markdown")||(i.from||(i.from=this.connection_id||"Convos"),i.type||(i.type="notice"),i.vars&&(i.message=Vt.apply(void 0,[i.message].concat(Rn(i.vars)))),i.color=Je(i.from.toLowerCase()),i.ts=new zn(i.ts),i.dayChanged=0!=a&&i.ts.getDate()!=t[a-1].ts.getDate(),i.embeds=(i.message.match(/https?:\/\/(\S+)/g)||[]).map((function(e){return e.replace(/(\W)?$/,"")})),i.fromId=i.from.toLowerCase(),i.isSameSender=0!=a&&t[a].from==t[a-1].from,i.markdown=Gt(i.message))}return this.update({messages:t}),this}},{key:"is",value:function(e){return"frozen"==e?this.frozen&&!0:"private"==e?this.is_private:"unread"==e?this.unread&&!0:this.status==e}},{key:"load",value:function(e){var t,n,o;return Oe.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(t=e.before,this.messagesOp&&!this.is("loading")){a.next=3;break}return a.abrupt("return",this);case 3:if(n={connection_id:this.connection_id,dialog_id:this.dialog_id},!t||!t.endOfHistory){a.next=6;break}return a.abrupt("return");case 6:return t&&t.ts&&(t=t.ts.toISOString()),t&&(n.before=t),this.update({status:"loading"}),a.next=11,Oe.awrap(this.messagesOp.perform(n));case 11:return o=this.messagesOp.res.body,this.addMessages("unshift",o.messages||[]),this.update({status:this.messagesOp.status}),o.end&&this.messages.length&&(this.messages[0].endOfHistory=!0),a.abrupt("return",this);case 16:case"end":return a.stop()}}),null,this)}},{key:"findParticipant",value:function(e){return this._participants.get(this._participantId(void 0===e?"":e))}},{key:"participants",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.forEach((function(t){t.nick||(t.nick=t.name);var n=e._participantId(t.nick),o=e._participants.get(n);o&&(Object.keys(t).forEach((function(e){o[e]=t[e]})),t=o),t.modes||(t.modes={}),e._calculateModes(Hn,t.mode,t.modes),delete t.mode,e._participants.set(n,Fn({name:t.nick},t,{color:Je(n),id:n,ts:new zn}))})),t.length&&this.update({force:!0}),this._participants.toArray()}},{key:"send",value:function(e,t){this.events.send({connection_id:this.connection_id,dialog_id:this.dialog_id||"",message:e},t?this[t].bind(this):null)}},{key:"setLastRead",value:function(){return Oe.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setLastReadOp){e.next=2;break}return e.abrupt("return");case 2:return this.update({errors:0,unread:0}),e.next=5,Oe.awrap(this.setLastReadOp.perform({connection_id:this.connection_id,dialog_id:this.dialog_id}));case 5:this.update(this.setLastReadOp.res.body||{});case 6:case"end":return e.stop()}}),null,this)}},{key:"update",value:function(e){return this._loadParticipants(),Nn(Le(t.prototype),"update",this).call(this,e)}},{key:"wsEventMode",value:function(e){e.nick?(this.participants([{nick:e.nick,mode:e.mode}]),this.addMessage({message:"%1 got mode %2 from %3.",vars:[e.nick,e.mode,e.from]})):this.update({modes:this._calculateModes(Bn,e.mode,this.modes)})}},{key:"wsEventNickChange",value:function(e){var t=this._participantId(e.old_nick);if(this._participants.has(t)&&e.old_nick!=e.new_nick){this._participants.delete(t);var n="me"==e.type?"You (%1) changed nick to %2.":"%1 changed nick to %2.";this.addMessage({message:n,vars:[e.old_nick,e.new_nick]})}}},{key:"wsEventPart",value:function(e){var t=this.findParticipant(e.nick);t&&!t.me&&(this._participants.delete(this._participantId(e.nick)),this.update({force:!0}),this.addMessage(this._partMessage(e)))}},{key:"wsEventSentNames",value:function(e){this._updateParticipants(e);var t={message:"Participants (%1): %2",vars:[]},n=this._participants.map((function(e){return(Gn[e.mode]||"")+e.name}));n.length>1&&(t.message+=" and %3.",t.vars[2]=n.pop()),t.vars[0]=n.length,t.vars[1]=n.join(", "),this.addMessage(t)}},{key:"_addOperations",value:function(){this.prop("ro","messagesOp",this.api.operation("dialogMessages")),this.prop("ro","setLastReadOp",this.api.operation("setDialogLastRead"))}},{key:"_calculateModes",value:function(e,t,n){var o=(t||"").match(/^(\+|-)?(.*)/)||["","+",""],a=Re(o,3),i=(a[0],a[1]);a[2].split("").forEach((function(t){n[e[t]||t]="-"!=i}))}},{key:"_calculateFrozen",value:function(){return""}},{key:"_loadParticipants",value:function(){if(!this.participantsLoaded&&this.dialog_id&&this.messagesOp&&!this.is("frozen")&&this.messagesOp.is("success"))return this.participantsLoaded=!0,this.is_private?this.send("/ison","_noop"):this.send("/names","_updateParticipants")}},{key:"_noop",value:function(){}},{key:"_participantId",value:function(e){return e.toLowerCase()}},{key:"_partMessage",value:function(e){var t={message:"%1 parted.",vars:[e.nick]};return e.kicker?(t.message="%1 was kicked by %2"+(e.message?": %3":""),t.vars.push(e.kicker),t.vars.push(e.message)):e.message&&(t.message+=" Reason: %2",t.vars.push(e.message)),t}},{key:"_updateParticipants",value:function(e){this._participants.clear(),this.participants(e.participants),e.stopPropagation()}}]),t}(Ue);function Vn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var Yn=function(e,t){return(e.is_private||0)-(t.is_private||0)||e.name.localeCompare(t.name)},Jn=function(e){function t(e){var n;return Ce(this,t),(n=Te(this,Le(t).call(this,e))).prop("ro","dialogs",new In([],{sorter:Yn})),n.prop("rw","on_connect_commands",e.on_connect_commands||""),n.prop("rw","state",e.state||"queued"),n.prop("rw","wanted_state",e.wanted_state||"connected"),n.prop("rw","url","string"==typeof e.url?new Sn(e.url):e.url),n.prop("rw","nick",e.nick||n.url.searchParams.get("nick")||""),n.participants([{nick:n.nick}]),n}return Ie(t,e),Se(t,[{key:"addDialog",value:function(e){var t=e.match(/^[a-z]/i);this.send(t?"/query ".concat(e):"/join ".concat(e))}},{key:"ensureDialog",value:function(e){var t=this,n=this.dialogs.get(e.dialog_id);return n?n.update(e):((n=new Zn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vn(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{connection_id:this.connection_id,api:this.api,events:this.events}))).on("message",(function(e){return t.emit("message",e)})),n.on("update",(function(){return t.update({force:!0})})),this._addDefaultParticipants(n),this.dialogs.set(n.dialog_id,n),this.update({force:!0}),n)}},{key:"findDialog",value:function(e){return this.dialogs.get(e.dialog_id)}},{key:"is",value:function(e){return this.state==e||Nn(Le(t.prototype),"is",this).call(this,e)}},{key:"removeDialog",value:function(e){return this.dialogs.delete(e.dialog_id),this.update({force:!0})}},{key:"update",value:function(e){return e.url&&"string"==typeof e.url&&(e.url=new Sn(e.url)),Nn(Le(t.prototype),"update",this).call(this,e)}},{key:"wsEventConnection",value:function(e){this.update({state:e.state}),this.addMessage(e.message?{message:"Connection state changed to %1: %2",vars:[e.state,e.message]}:{message:"Connection state changed to %1.",vars:[e.state]})}},{key:"wsEventFrozen",value:function(e){var t=this.findDialog(e),n=t&&t.frozen;this.ensureDialog(e).participants([{nick:this.nick,me:!0}]),e.frozen&&(t||this).addMessage({message:e.frozen,vars:[]}),n&&!e.frozen&&t.addMessage({message:"Connected.",vars:[]})}},{key:"wsEventMessage",value:function(e){return e.dialog_id?this.ensureDialog(e).addMessage(e):this.addMessage(e)}},{key:"wsEventNickChange",value:function(e){var n={old_nick:e.old_nick||this.nick,new_nick:e.new_nick||e.nick,type:e.type};Nn(Le(t.prototype),"wsEventNickChange",this).call(this,n),this.dialogs.forEach((function(e){return e.wsEventNickChange(n)}))}},{key:"wsEventError",value:function(e){var t=e.dialog_id&&e.frozen?this.ensureDialog(e):this.findDialog(e)||this;t.update({errors:this.errors+1});var n=Fe(e)||e.frozen||"Unknown error from %1.";"Password protected."==n&&(n="Invalid password."),t.addMessage({message:n,type:"error",sent:e,vars:e.command||[e.message]})}},{key:"wsEventJoin",value:function(e){var t=this.ensureDialog(e),n=e.nick||this.nick;n!=this.nick&&t.addMessage({message:"%1 joined.",vars:[n]}),t.participants([{nick:n}])}},{key:"wsEventPart",value:function(e){if(e.nick==this.nick)return this.removeDialog(e);e.dialog_id||(this.dialogs.forEach((function(t){return t.wsEventPart(e)})),e.stopPropagation())}},{key:"wsEventQuit",value:function(e){this.wsEventPart(e)}},{key:"wsEventSentJoin",value:function(e){this.wsEventJoin(e)}},{key:"wsEventSentList",value:function(e){var t=e.args||"/*/";this.addMessage(e.done?{message:"Found %1 of %2 dialogs from %3.",vars:[e.dialogs.length,e.n_dialogs,t]}:{message:"Found %1 of %2 dialogs from %3, but dialogs are still loading.",vars:[e.dialogs.length,e.n_dialogs,t]})}},{key:"wsEventSentQuery",value:function(e){this.ensureDialog(e)}},{key:"wsEventSentWhois",value:function(e){var t="%1 (%2)",n=[e.nick,e.host],o=Object.keys(e.channels).sort().map((function(t){return(e.channels[t].mode||"")+t}));e.channels=o,e.idle_for&&o.length?(t+=" has been idle for %3 in %4.",n.push(e.idle_for),n.push(o.join(", "))):e.idle_for&&!o.length?(t+="has been idle for %3, and is not active in any channels.",n.push(e.idle_for)):(t+="is active in %3.",n.push(o.join(", "))),(this.findDialog(e)||this).addMessage({message:t,vars:n,sent:e})}},{key:"wsEventTopic",value:function(e){this.ensureDialog(e).addMessage(e.topic?{message:"Topic changed to: %1",vars:[e.topic]}:{message:"No topic is set.",vars:[]})}},{key:"_addDefaultParticipants",value:function(e){var t=[{nick:this.nick,me:!0}];e.is_private&&t.push({nick:e.name}),e.participants(t)}},{key:"_addOperations",value:function(){this.prop("ro","setLastReadOp",this.api.operation("setConnectionLastRead")),this.prop("ro","messagesOp",this.api.operation("connectionMessages"))}},{key:"_calculateFrozen",value:function(){switch(this.state){case"connected":return"";case"disconnected":return"Disconnected.";case"unreachable":return"Unreachable.";default:return"Connecting..."}}}]),t}(Zn),Qn=ke((function(e){function t(e){let t=document.createElement("div");const n=[[e,t]],o=[];for(;n.length;){const[e,a]=n.shift();let i,r,s=typeof e;if(null===e||"undefined"==s?s="null":Array.isArray(e)&&(s="array"),"array"==s)(r=e=>e).len=e.length,(i=document.createElement("div")).className="json-array "+(r.len?"has-items":"is-empty");else if("object"==s){const t=Object.keys(e).sort();(r=e=>t[e]).len=t.length,(i=document.createElement("div")).className="json-object "+(r.len?"has-items":"is-empty")}else(i=document.createElement("span")).className="json-"+s,i.textContent="null"==s?"null":"boolean"!=s?e:e?"true":"false";if(r){const c=document.createElement("span");if(c.className="json-type",c.textContent=r.len?s+"["+r.len+"]":"{}",a.appendChild(c),-1!=o.indexOf(e))t.classList.add("has-recursive-items"),i.classList.add("is-seen");else{for(let t=0;t<r.len;t++){const o=r(t),a=document.createElement("div"),s=document.createElement("span");s.className="json-key",s.textContent=o,a.appendChild(s),i.appendChild(a),n.push([e[o],a])}o.push(e)}}a.className="json-item "+i.className.replace(/^json-/,"contains-"),a.appendChild(i)}return t}try{e.exports={jsonhtmlify:t}}catch(e){window.jsonhtmlify=t}})).jsonhtmlify;function Xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var eo=function(e){function t(e){var n;return Ce(this,t),(n=Te(this,Le(t).call(this))).name="EmbedMaker",n.prop("persist","disableInstagram",!1),n.prop("persist","disableTwitter",!1),n.prop("persist","expandUrlToMedia",!0),n.prop("ro","api",e.api),n.prop("ro","embeds",{}),n}return Ie(t,e),Se(t,[{key:"render",value:function(e,t){var n=this;if(this.expandUrlToMedia){var o={};We(e,".message__embed",(function(e){o[e.dataset.url]=e})),t.forEach((function(t){n.embeds[t]||n._loadAndRender(t),o[t]||e.appendChild(n._ensureEmbedEl(t)),delete o[t]})),Object.keys(o).forEach((function(e){return o[e].remove()}))}}},{key:"renderInstagram",value:function(e){if(!this.disableInstagram)return window.instgrm?window.instgrm.Embeds.process():void Ke("//platform.instagram.com/en_US/embeds.js")}},{key:"renderPasteEl",value:function(e){nt.highlightBlock(e.querySelector("pre")),We(e,".le-meta",(function(e){e.addEventListener("click",(function(){return e.parentNode.classList.toggle("is-expanded")}))}))}},{key:"renderPhoto",value:function(e){var t=this;We(e,"img",(function(e){return e.addEventListener("click",(function(){return t.showMedia(e)}))}))}},{key:"renderTwitter",value:function(e){this.disableTwitter||(window.twttr&&window.twttr.widgets.load(),Ke("//platform.twitter.com/widgets.js"))}},{key:"showMedia",value:function(e){var t=qe(document.querySelector("body"),"fullscreen-media-wrapper",(function(e){e.addEventListener("click",(function(t){return Ye(e,t.target!=e)}))}));!function(e){for(;e.firstChild;)e.removeChild(e.firstChild)}(t),t.appendChild(e.cloneNode()),Ye(t,!0)}},{key:"toggleDetails",value:function(e,t){var n=e.querySelector(".has-message-details");if(n)return Ye(n,"toggle");var o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xn(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xn(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.sent||t);["bubbles","color","command","dayChanged","dispatchTo","embeds","event","fromId","id","isSameSender","markdown","method","stopPropagation"].forEach((function(e){return delete o[e]})),o.ts=t.ts.toLocaleString(),(n=Qn(o.sent||o)).className=["message__embed","has-message-details",n.className].join(" "),e.appendChild(n)}},{key:"_ensureEmbedEl",value:function(e){return this.embeds[e].el||(this.embeds[e].el=qe(null,"message__embed",(function(t){t.dataset.url=e})))}},{key:"_loadAndRender",value:function(e){var t=this;return this.embeds[e]={},this.api.operation("embed",{url:e}).perform().then((function(n){var o=n.res.body;if(o.html){var a=t._ensureEmbedEl(e);a.innerHTML=o.html,We(a,"a",(function(e){e.target="_blank"}));var i=(o.provider_name||"").toLowerCase();if("instagram"==i)return t.renderInstagram(a);if("twitter"==i)return t.renderTwitter(a);if(-1!=(a.firstChild.className||"").split(/\s+/).indexOf("le-paste"))return t.renderPasteEl(a);We(a,".le-photo, .le-thumbnail",(function(e){return t.renderPhoto(a)}))}}))}}]),t}(Ue);function to(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function no(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?to(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):to(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oo=window.Notification||{permission:"denied"},ao=0,io=function(e){function t(e){var n;return Ce(this,t),(n=Te(this,Le(t).call(this))).keepaliveTid=setInterval((function(){return n._send({method:"ping"})}),1e4),n.notificationIcon="",n.queue=[],n.waiting={},n.prop("persist","debugEvents",-1!=navigator.userAgent.indexOf("Mozilla")?1:0),n.prop("persist","notificationCloseDelay",5e3),n.prop("persist","wantNotifications",null),n.prop("ro","browserNotifyPermission",(function(){return oo.permission})),n.prop("ro","wsUrl",e.wsUrl),n.prop("rw","ready",!1),n}return Ie(t,e),Se(t,[{key:"dispatch",value:function(e){var t=("wsEvent_"+this._getEventNameFromParam(e)).replace(/_(\w)/g,(function(e,t){return t.toUpperCase()}));this.debugEvents&&this._debug(t,e),e.bubbles=!0,e.stopPropagation=function(){e.bubbles=!1};var n=this.waiting[e.id];n&&n(e),e.bubbles&&this.emit("message",no({},e,{dispatchTo:t}))}},{key:"listenToGlobalEvents",value:function(){var e=this;window.addEventListener("error",(function(t){var n=t.colno,o=t.error,a=t.filename,i=t.lineno,r=t.message,s=t.type,c=t.timeStamp;e.send({method:"debug",type:s,colno:n,error:o,filename:a,lineno:i,message:r,timeStamp:c})})),window.addEventListener("unhandledrejection",(function(t){var n=t.type,o=t.reason,a=t.returnValue,i=t.timeStamp;e.send({method:"debug",type:n,reason:o,returnValue:a,timeStamp:i})}))}},{key:"notifyUser",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.wantNotifications?"granted"!=oo.permission?oo.permission:!n.force&&document.hasFocus()?"document.hasFocus":"":"wantNotifications == false";if(o)return console.log("[Events:notifyUser] Rejected: "+o,[e,t,n]),this;var a=new oo(e,no({icon:this.notificationIcon},n,{body:t}));return a.onclick=function(e){window.focus(),a.close()},setTimeout((function(){return a.close()}),this.notificationCloseDelay),this}},{key:"rejectNotifications",value:function(){return this.update({wantNotifications:!1})}},{key:"requestPermissionToNotify",value:function(e){var t=this;return"granted"!=oo.permission&&oo.requestPermission?(oo.requestPermission((function(n){t.update({wantNotifications:"granted"==n}),e&&e(n)})),this):(this.update({wantNotifications:"granted"==oo.permission}),e&&e(oo.permission),this)}},{key:"send",value:function(e,t){e.id||"ping"==e.method||(e.id=++ao),!e.method&&e.message&&(e.method="send"),e.dialog&&["connection_id","dialog_id"].forEach((function(t){e[t]=e.dialog[t]||""})),delete e.dialog,this.debugEvents&&this._debug("send",e),t&&(this.waiting[e.id]=t),this.queue.push(e),this._ws("dequeue")}},{key:"update",value:function(e){return Nn(Le(t.prototype),"update",this).call(this,e),e.wantNotifications&&this.notifyUser("Convos",Vt("You have enabled notifications!"),{force:!0}),this}},{key:"_debug",value:function(e,t){1==this.debugEvents&&"wsEventPong"!=e&&"ping"!=t.method?console.log("[Events:"+(e||"data")+"]",t):this.debugEvents>=2&&console.log("[Events:"+(e||"data")+"]",t)}},{key:"_getEventNameFromParam",value:function(e){return e.errors?"error":"state"==e.event?e.type:"sent"==e.event&&e.message.match(/\/\S+/)?(e.command=e.message.split(/\s+/).filter((function(e){return e.length})),e.command[0]=e.command[0].substring(1),"sent_"+e.command[0]):e.event}},{key:"_send",value:function(e){var t=this.ws&&1==this.ws.readyState&&this.ws;return t&&t.send(JSON.stringify(e)),!!t}},{key:"_ws",value:function(e){var t=this;"dequeue"==e&&this._wsReconnectTid&&(clearTimeout(this._wsReconnectTid),delete this._wsReconnectTid),"start"==e&&this.update({ready:!0}),"stop"==e?(this._wsReconnectTid||(this._wsReconnectTid=setTimeout((function(){return t._ws("dequeue")}),3e3)),this.update({ready:!1}),delete this.ws):this.ws?this.queue=this.queue.filter((function(e){return!t._send(e)})):(this.ws=new WebSocket(this.wsUrl),this.ws.onopen=function(){return t._ws("start")},this.ws.onclose=function(){return t._ws("stop")},this.ws.onerror=function(){return t._ws("stop")},this.ws.onmessage=function(e){return t.dispatch(JSON.parse(e.data))})}}]),t}(Ue);function ro(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var so=function(e){function t(e){return Ce(this,t),Te(this,Le(t).call(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ro(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ro(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{connection_id:"",dialog_id:"notifications",is_private:!0,name:"Notifications"})))}return Ie(t,e),Se(t,[{key:"send",value:function(){}},{key:"_addOperations",value:function(){this.prop("ro","messagesOp",this.api.operation("notificationMessages")),this.prop("ro","setLastReadOp",this.api.operation("readNotifications"))}}]),t}(Zn);function co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var lo=function(e){function t(e){var n;Ce(this,t),n=Te(this,Le(t).call(this));var o=e.api;return n.prop("ro","api",(function(){return o})),n.prop("ro","connections",new In),n.prop("ro","email",(function(){return n.getUserOp.res.body.email||""})),n.prop("ro","embedMaker",new eo({api:o})),n.prop("ro","events",n._createEvents(e)),n.prop("ro","getUserOp",o.operation("getUser",{connections:!0,dialogs:!0})),n.prop("ro","notifications",new so({api:o,events:n.events})),n.prop("ro","roles",new Set),n.prop("ro","unread",(function(){return n._calculateUnread()})),n.prop("rw","highlight_keywords",[]),n.prop("rw","status","pending"),n.prop("persist","lastUrl",""),n.prop("persist","showGrid",!1),n.prop("persist","theme","auto"),n.prop("persist","version","0"),n}return Ie(t,e),Se(t,[{key:"calculateLastUrl",value:function(){if(this.is("error"))return yt("/register");if(!this.is("success"))return null;if(this.lastUrl)return this.lastUrl;var e=this.connections.toArray()[0];if(!e)return yt("/add/connection");var t=e.dialogs.toArray()[0];return yt(t?t.path:e.path)}},{key:"dialogs",value:function(e){var t=[];return this.connections.toArray().forEach((function(n){n.dialogs.toArray().forEach((function(n){e&&!e(n)||t.push(n)}))})),t}},{key:"ensureConnected",value:function(){this.email&&this.send({method:"ping"})}},{key:"ensureDialog",value:function(e){var t=this;if(e.dialog_id)return this.ensureDialog({connection_id:e.connection_id}).ensureDialog(e);var n=this.findDialog(e);return n?n.update(e):((n=new Jn(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?co(n,!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):co(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{api:this.api,events:this.events}))).on("update",(function(){return t.update({force:!0})})),this.connections.set(n.connection_id,n),this.update({force:!0}),n)}},{key:"findDialog",value:function(e){var t=this.connections.get(e.connection_id);return e.dialog_id?t&&t.findDialog(e):t}},{key:"is",value:function(e){var t=this;return Array.isArray(e)?!!e.filter((function(e){return t.is(e)})).length:"loggedIn"==e?this.email&&!0:"offline"==e?"fetch"==Fe(this.getUserOp.err||[],"source"):this.status==e}},{key:"load",value:function(){var e,t=this;return Oe.async((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.is("loading")){n.next=2;break}return n.abrupt("return",this);case 2:return this.update({status:"loading"}),n.next=5,Oe.awrap(this.getUserOp.perform());case 5:return e=this.getUserOp.res.body,this.connections.clear(),this.notifications.update({unread:e.unread||0}),this.roles.clear(),(e.connections||[]).forEach((function(e){return t.ensureDialog(e)})),(e.dialogs||[]).forEach((function(e){return t.ensureDialog(e)})),(e.roles||[]).forEach((function(e){return t.roles.add(e)})),this.update({highlight_keywords:e.highlight_keywords||[],status:this.getUserOp.status}),this.ensureConnected(),n.abrupt("return",this);case 15:case"end":return n.stop()}}),null,this)}},{key:"removeDialog",value:function(e){if(e.dialog_id){var t=this.findDialog({connection_id:e.connection_id});t&&t.removeDialog(e)}else this.connections.delete(e.connection_id),this.update({force:!0})}},{key:"send",value:function(e,t){return this.events.send(e,t)}},{key:"wsEventMe",value:function(e){var t=this.ensureDialog({connection_id:e.connection_id});t.wsEventNickChange(e),t.update(e)}},{key:"wsEventPong",value:function(e){this.wsPongTimestamp=e.ts}},{key:"_calculateUnread",value:function(){return this.notifications.unread+this.dialogs((function(e){return e.is_private})).reduce((function(e,t){return e+t.unread}),0)}},{key:"_createEvents",value:function(e){var t=this,n=new io(e);return n.on("message",(function(e){t._dispatchMessageToDialog(e),t.emit(e.dispatchTo,e),t[e.dispatchTo]&&t[e.dispatchTo](e)})),n.on("update",(function(e){if(e.ready)return!!t.is("pending")&&t.load();t.update({status:"pending"}),t.connections.forEach((function(e){return e.update({state:"unreachable"})}))})),n}},{key:"_dispatchMessageToDialog",value:function(e){var t=this.findDialog({connection_id:e.connection_id});if(t&&(t[e.dispatchTo]&&t[e.dispatchTo](e),e.bubbles)){var n=t.findDialog(e);n&&n[e.dispatchTo]&&n[e.dispatchTo](e)}}}]),t}(Ue),uo=[["auto","Auto"],["dark","Dark"],["light","Light"],["nord","Nord"]],fo="dark",po=window.matchMedia("(prefers-color-scheme: dark)");function go(e){let t,n,o,a,i,r,s,c,d;const l=e.$$slots.default,g=u(l,e,null),m=new it({props:{name:e.$activeMenu?"times-circle":"bars"}});return{c(){t=C("header"),g&&g.c(),n=S(),o=C("a"),ve(m.$$.fragment),a=S(),i=C("small"),r=N(e.unread),R(i,"class","chat-header__unread"),i.hidden=s=!e.unread,R(o,"href",c="#activeMenu:"+(e.$activeMenu?"":"nav")),R(o,"class","chat-header__hamburger"),R(t,"class","chat-header")},m(e,s){k(e,t,s),g&&g.m(t,null),x(t,n),x(t,o),ye(m,o,null),x(o,a),x(o,i),x(i,r),d=!0},p(e,t){g&&g.p&&e.$$scope&&g.p(p(l,t,e,null),f(l,t,null));const n={};e.$activeMenu&&(n.name=t.$activeMenu?"times-circle":"bars"),m.$set(n),d&&!e.unread||A(r,t.unread),(!d||e.unread&&s!==(s=!t.unread))&&(i.hidden=s),(!d||e.$activeMenu&&c!==(c="#activeMenu:"+(t.$activeMenu?"":"nav")))&&R(o,"href",c)},i(e){d||(pe(g,e),pe(m.$$.fragment,e),d=!0)},o(e){ge(g,e),ge(m.$$.fragment,e),d=!1},d(e){e&&E(t),g&&g.d(e),_e(m)}}}function mo(e,t,n){let o,a;l(e,lt,e=>n("$activeMenu",a=e));const i=Z("user");l(e,i,e=>n("$user",o=e));let r,{$$slots:s={},$$scope:c}=t;return e.$set=e=>{"$$scope"in e&&n("$$scope",c=e.$$scope)},e.$$.update=(e={$user:1})=>{e.$user&&n("unread",r=o.unread)},{user:i,unread:r,$activeMenu:a,$$slots:s,$$scope:c}}po.matches&&(fo="dark"),po.addListener((function(e){fo=e.matches?"dark":"light"}));class ho extends xe{constructor(e){super(),we(this,e,mo,go,s,{})}}var $o=[];function bo(e,t){return bo[e]?bo[e](t):[]}function vo(e,t,n){const o=Object.create(e);return o.opt=t[n],o.i=n,o}function yo(e){let t,n,o,a=(e.opt.text||e.opt.val)+"";return{c(){R(t=C("a"),"href",n="#index:"+e.i),R(t,"tabindex","-1"),j(t,"has-focus",e.i==e.activeAutocompleteIndex),o=P(t,"click",M(e.selectOption))},m(e,n){k(e,t,n),t.innerHTML=a},p(e,n){e.autocompleteOptions&&a!==(a=(n.opt.text||n.opt.val)+"")&&(t.innerHTML=a),e.activeAutocompleteIndex&&j(t,"has-focus",n.i==n.activeAutocompleteIndex)},d(e){e&&E(t),o()}}}function _o(e){let t,n,o,a,r,s,c,d,l,u,f;const p=new it({props:{name:"paper-plane"}});let g=e.autocompleteOptions,m=[];for(let t=0;t<g.length;t+=1)m[t]=yo(vo(e,g,t));return{c(){t=C("div"),n=C("textarea"),a=S(),r=C("a"),ve(p.$$.fragment),s=S(),c=C("div");for(let e=0;e<m.length;e+=1)m[e].c();R(n,"id","chat_input_textarea"),R(n,"placeholder",o=Vt("What is on your mind %1?",e.$connection.nick)),R(r,"href","#send"),R(r,"class","btn-send"),R(c,"class",d="chat-input_autocomplete chat-input_autocomplete_"+e.autocompleteCategory),c.hidden=l=!e.autocompleteOptions.length,R(t,"class","chat-input"),f=[P(n,"change",e.change_handler),P(n,"keydown",e.keydown_handler),P(n,"keyup",e.keyup_handler),P(r,"click",M(e.sendMessage))]},m(o,i){k(o,t,i),x(t,n),e.textarea_binding(n),x(t,a),x(t,r),ye(p,r,null),x(t,s),x(t,c);for(let e=0;e<m.length;e+=1)m[e].m(c,null);u=!0},p(e,t){if((!u||e.$connection&&o!==(o=Vt("What is on your mind %1?",t.$connection.nick)))&&R(n,"placeholder",o),e.activeAutocompleteIndex||e.selectOption||e.autocompleteOptions){let n;for(g=t.autocompleteOptions,n=0;n<g.length;n+=1){const o=vo(t,g,n);m[n]?m[n].p(e,o):(m[n]=yo(o),m[n].c(),m[n].m(c,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=g.length}(!u||e.autocompleteCategory&&d!==(d="chat-input_autocomplete chat-input_autocomplete_"+t.autocompleteCategory))&&R(c,"class",d),(!u||e.autocompleteOptions&&l!==(l=!t.autocompleteOptions.length))&&(c.hidden=l)},i(e){u||(pe(p.$$.fragment,e),u=!0)},o(e){ge(p.$$.fragment,e),u=!1},d(n){n&&E(t),e.textarea_binding(null),_e(p),O(m,n),i(f)}}}function wo(t,n,o){let a,i=e;t.$$.on_destroy.push(()=>i());let r,{dialog:s={}}=n,d=0,l="none",u=0;const f=Z("user");function p(e,t={}){const n=t.space||"";o("inputEl",r.value=y[0]+e+n+y[3],r),o("inputEl",r.selectionStart=o("inputEl",r.selectionEnd=(y[0]+e+n).length,r),r),n.length&&o("pos",u=r.selectionStart)}function g(e){const t=b[d];t&&p(t.val,e)}function m(e,t){b.length&&(e.preventDefault(),o("activeAutocompleteIndex",d+=t),d<0&&o("activeAutocompleteIndex",d=b.length-1),d>=b.length&&o("activeAutocompleteIndex",d=0),g({space:""}))}function h(){const e={message:r.value,method:"send",dialog:s};e.message=e.message.replace(/^\/close/i,"/part"),e.message=e.message.replace(/^\/j\b/i,"/join");(e.message.match(/^\/(\w+)\s*(\S*)/)||["","message",""]).slice(1);e.message.length&&f.send(e),o("inputEl",r.value="",r)}const $={ArrowDown:e=>m(e,e.shiftKey?4:1),ArrowUp:e=>m(e,e.shiftKey?-4:-1),Tab:e=>m(e,e.shiftKey?-1:1),Enter(e){b[d]?(e.preventDefault(),g({space:" "})):e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),h())},Fallback(e){},Release(e){1!=e.key.length&&-1==["ArrowLeft","ArrowRight","Backspace"].indexOf(e.key)||o("pos",u=r.selectionStart)}};let b,v,y;return t.$set=e=>{"dialog"in e&&o("dialog",s=e.dialog)},t.$$.update=(e={pos:1,inputParts:1,dialog:1})=>{e.pos&&o("inputParts",y=u?function(e){let t="",n="";return[r.value.substring(0,e).replace(/(\S)(\S*)$/,(e,o,a)=>(t=o,n=a,"")),t,n,r.value.substring(e)]}(u):["","","",""]),e.inputParts&&o("autocompleteOptions",b=function([e,t,n,a]){o("autocompleteCategory",l=":"==t&&n.length?"emojis":"/"!=t||e.length?"@"==t&&n.length?"nicks":"#"==t||"&"==t?"dialogs":"none":"commands"),o("activeAutocompleteIndex",d=0);const i=bo(l,{dialog:s,query:t+n,user:f});return i.length&&i.unshift({val:t+n}),i}(y)||[]),e.dialog&&(()=>(i(),i=c(v,e=>o("$connection",a=e)),v))(o("connection",v=f.findDialog({connection_id:s.connection_id})))},{dialog:s,activeAutocompleteIndex:d,autocompleteCategory:l,inputEl:r,pos:u,add:p,selectOption:function(e){o("activeAutocompleteIndex",d=parseInt(e.target.closest("a").href.replace(/.*index:/,""),10)),g({space:" "}),r.focus()},sendMessage:h,keys:$,autocompleteOptions:b,connection:v,$connection:a,textarea_binding:function(e){J[e?"unshift":"push"](()=>{o("inputEl",r=e)})},change_handler:e=>{o("pos",u=r.selectionStart)},keydown_handler:e=>($[e.key]||$.Fallback)(e),keyup_handler:e=>$.Release(e)}}bo.commands=function(e){for(var t=e.query,n=[],o=0;o<$o.length;o++)if(0==$o[o].cmd.indexOf(t)){var a=$o[o].alias||$o[o].cmd,i=$o[o].example.replace(/</g,"&lt;");n.push({text:i,val:a})}return n},bo.dialogs=function(e){for(var t=e.dialog,n=e.query,o=e.user.findDialog({connection_id:t.connection_id}).dialogs.toArray(),a=[],i=0;i<o.length&&!(-1!=o[i].name.toLowerCase().indexOf(n)&&(a.push({text:o[i].name,val:o[i].dialog_id}),a.length>=20));i++);return a},bo.emojis=function(e){var t=e.query,n=[];return[":","_"].map((function(e){return e+t.slice(1,2)})).forEach((function(e){for(var o=Kt(e,"group"),a=0;a<o.length&&(o[a].shortname.indexOf(t)>=0&&n.push({val:o[a].emoji,text:Gt(o[a].emoji)}),!(n.length>=20));a++);})),n},bo.nicks=function(e){var t=e.dialog,n=e.query,o=t.participants(),a=new RegExp("^"+Ze(n.slice(1)),"i"),i=[],r=!0,s=!1,c=void 0;try{for(var d,l=o[Symbol.iterator]();!(r=(d=l.next()).done);r=!0){var u=d.value;if(i.length>=20)break;u.nick.match(a)&&i.push({val:u.nick})}}catch(e){s=!0,c=e}finally{try{r||null==l.return||l.return()}finally{if(s)throw c}}return i},$o.push({cmd:"/me",example:"/me <msg>",description:"Send message as an action."}),$o.push({cmd:"/say",example:"/say <msg>",description:NaN}),$o.push({cmd:"/topic",example:"/topic or /topic <new topic>",description:"Show current topic, or set a new one."}),$o.push({cmd:"/whois",example:"/whois <nick>",description:"Show information about a user."}),$o.push({cmd:"/query",example:"/query <nick>",description:"Open up a new chat window with nick."}),$o.push({cmd:"/msg",example:"/msg <nick> <msg>",description:"Send a direct message to nick."}),$o.push({cmd:"/names",example:"/names",description:"Show participants in the channel."}),$o.push({cmd:"/join",example:"/join <#channel>",description:"Join channel and open up a chat window."}),$o.push({cmd:"/nick",example:"/nick <nick>",description:"Change your wanted nick."}),$o.push({cmd:"/part",example:"/part",description:"Leave channel, and close window."}),$o.push({cmd:"/close",example:"/close <nick>",description:"Close conversation with nick, defaults to current active."}),$o.push({cmd:"/kick",example:"/kick <nick>",description:"Kick a user from the current channel."}),$o.push({cmd:"/mode",example:"/mode +o #channel nick",description:"Change mode of yourself or a user"}),$o.push({cmd:"/reconnect",example:"/reconnect",description:"Restart the current connection."}),$o.push({cmd:"/cs",example:"/cs <msg>",description:'Short for "/msg chanserv ...".',alias:"/msg chanserv"}),$o.push({cmd:"/ns",example:"/ns <msg>",description:'Short for "/msg nickserv ...".',alias:"/msg nickserv"}),$o.push({cmd:"/hs",example:"/hs <msg>",description:'Short for "/msg hostserv ...".',alias:"/msg hostserv"}),$o.push({cmd:"/bs",example:"/bs <msg>",description:'Short for "/msg botserv ...".',alias:"/msg botserv"});class xo extends xe{constructor(e){super(),we(this,e,wo,_o,s,{dialog:0,add:0})}get add(){return this.$$.ctx.add}}function ko(e){let t,n,o,a,i;const r=new it({props:{name:e.icon,animation:e.animation}}),s=e.$$slots.default,c=u(s,e,null);return{c(){t=C("div"),n=C("span"),ve(r.$$.fragment),o=S(),c&&c.c(),R(t,"class",a="message-status-line "+e.className)},m(e,a){k(e,t,a),x(t,n),ye(r,n,null),x(n,o),c&&c.m(n,null),i=!0},p(e,n){const o={};e.icon&&(o.name=n.icon),e.animation&&(o.animation=n.animation),r.$set(o),c&&c.p&&e.$$scope&&c.p(p(s,n,e,null),f(s,n,null)),(!i||e.className&&a!==(a="message-status-line "+n.className))&&R(t,"class",a)},i(e){i||(pe(r.$$.fragment,e),pe(c,e),i=!0)},o(e){ge(r.$$.fragment,e),ge(c,e),i=!1},d(e){e&&E(t),_e(r),c&&c.d(e)}}}function Eo(e,t,n){let{class:o=""}=t,{icon:a=""}=t,{animation:i=""}=t,{$$slots:r={},$$scope:s}=t;return e.$set=e=>{"class"in e&&n("className",o=e.class),"icon"in e&&n("icon",a=e.icon),"animation"in e&&n("animation",i=e.animation),"$$scope"in e&&n("$$scope",s=e.$$scope)},{className:o,icon:a,animation:i,$$slots:r,$$scope:s}}class Oo extends xe{constructor(e){super(),we(this,e,Eo,ko,s,{class:"className",icon:0,animation:0})}}function Co(e,t,n){const o=Object.create(e);return o.message=t[n],o.i=n,o}function No(e){let t,n,o=Vt("notifications"==e.dialog.dialog_id?"No notifications.":"No messages.")+"";return{c(){t=C("h2"),n=N(o)},m(e,o){k(e,t,o),x(t,n)},p(e,t){e.dialog&&o!==(o=Vt("notifications"==t.dialog.dialog_id?"No notifications.":"No messages.")+"")&&A(n,o)},d(e){e&&E(t)}}}function So(e){let t;const n=new Oo({props:{class:"for-loading",icon:"spinner",animation:"spin",$$slots:{default:[Do]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Do(t){let n,o=Vt("Loading...")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Po(e){let t;const n=new Oo({props:{class:"for-last-read",icon:"comments",$$slots:{default:[Mo]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Mo(t){let n,o=Vt("New messages")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ro(e){let t;const n=new Oo({props:{class:"for-day-changed",icon:"calendar-alt",$$slots:{default:[To]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};(e.$$scope||e.messages)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Ao(e){let t;const n=new Oo({props:{class:"for-start-of-history",icon:"calendar-alt",$$slots:{default:[Lo]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};(e.$$scope||e.messages)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function To(e){let t,n=e.message.ts.getHumanDate()+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.messages&&n!==(n=o.message.ts.getHumanDate()+"")&&A(t,n)},d(e){e&&E(t)}}}function Lo(e){let t,n=Vt("Started chatting on %1",e.message.ts.getHumanDate())+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.messages&&n!==(n=Vt("Started chatting on %1",o.message.ts.getHumanDate())+"")&&A(t,n)},d(e){e&&E(t)}}}function jo(e){let t,n,o=Vt("%1 in %2",e.message.from,e.message.dialog_id)+"";return{c(){t=C("a"),n=N(o),R(t,"href","#see"),R(t,"class","message__from"),L(t,"color",e.message.color)},m(e,o){k(e,t,o),x(t,n)},p(e,a){e.messages&&o!==(o=Vt("%1 in %2",a.message.from,a.message.dialog_id)+"")&&A(n,o),e.messages&&L(t,"color",a.message.color)},d(e){e&&E(t)}}}function Io(e){let t,n,o,a,i=e.message.from+"";function r(...t){return e.click_handler(e,...t)}return{c(){t=C("a"),n=N(i),R(t,"href",o="#input:"+e.message.from),R(t,"class","message__from"),L(t,"color",e.message.color),a=P(t,"click",M(r))},m(e,o){k(e,t,o),x(t,n)},p(a,r){e=r,a.messages&&i!==(i=e.message.from+"")&&A(n,i),a.messages&&o!==(o="#input:"+e.message.from)&&R(t,"href",o),a.messages&&L(t,"color",e.message.color)},d(e){e&&E(t),a()}}}function Uo(e){let t;const n=new it({props:{name:"error"==e.message.type?"exclamation-circle":"info-circle"}});return n.$on("click",e.toggleDetails),{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.messages&&(o.name="error"==t.message.type?"exclamation-circle":"info-circle"),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function zo(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m,h,$,b,v=e.message.ts.getHM()+"",y=e.message.markdown+"",_=e.i&&e.i==e.messages.length-e.unreadFrom&&Po(e);const w=[Ao,Ro],O=[];function D(e,t){return t.message.endOfHistory?0:t.message.dayChanged?1:-1}~(n=D(0,e))&&(o=O[n]=w[n](e));const M=new it({props:{name:"pick:"+e.message.from,color:e.message.color}});function T(e,t){return t.dialog.connection_id?Io:jo}let L=T(0,e),U=L(e),z=("error"==e.message.type||"notice"==e.message.type)&&Uo(e);return{c(){_&&_.c(),t=S(),o&&o.c(),a=S(),i=C("div"),ve(M.$$.fragment),r=S(),s=C("b"),c=N(v),l=S(),U.c(),u=S(),f=C("div"),z&&z.c(),p=S(),R(s,"class","message__ts"),R(s,"title",d=e.message.ts.toLocaleString()),g=new I(y,null),R(f,"class","message__text"),R(i,"class",m="message is-type-"+e.message.type),R(i,"data-index",h=e.i),j(i,"is-not-present",!e.senderIsOnline(e.message)),j(i,"is-sent-by-you",e.message.from==e.connection.nick),j(i,"is-highlighted",e.message.highlight),j(i,"has-not-same-from",!e.message.isSameSender&&!e.message.dayChanged),j(i,"has-same-from",e.message.isSameSender&&!e.message.dayChanged),b=P(i,"click",e.gotoDialogFromNotifications)},m(e,o){_&&_.m(e,o),k(e,t,o),~n&&O[n].m(e,o),k(e,a,o),k(e,i,o),ye(M,i,null),x(i,r),x(i,s),x(s,c),x(i,l),U.m(i,null),x(i,u),x(i,f),z&&z.m(f,null),x(f,p),g.m(f),$=!0},p(e,r){r.i&&r.i==r.messages.length-r.unreadFrom?_?(_.p(e,r),pe(_,1)):((_=Po(r)).c(),pe(_,1),_.m(t.parentNode,t)):_&&(ue(),ge(_,1,1,()=>{_=null}),fe());let l=n;(n=D(0,r))===l?~n&&O[n].p(e,r):(o&&(ue(),ge(O[l],1,1,()=>{O[l]=null}),fe()),~n?((o=O[n])||(o=O[n]=w[n](r)).c(),pe(o,1),o.m(a.parentNode,a)):o=null);const h={};e.messages&&(h.name="pick:"+r.message.from),e.messages&&(h.color=r.message.color),M.$set(h),$&&!e.messages||v===(v=r.message.ts.getHM()+"")||A(c,v),(!$||e.messages&&d!==(d=r.message.ts.toLocaleString()))&&R(s,"title",d),L===(L=T(0,r))&&U?U.p(e,r):(U.d(1),(U=L(r))&&(U.c(),U.m(i,u))),"error"==r.message.type||"notice"==r.message.type?z?(z.p(e,r),pe(z,1)):((z=Uo(r)).c(),pe(z,1),z.m(f,p)):z&&(ue(),ge(z,1,1,()=>{z=null}),fe()),$&&!e.messages||y===(y=r.message.markdown+"")||g.p(y),(!$||e.messages&&m!==(m="message is-type-"+r.message.type))&&R(i,"class",m),(e.messages||e.senderIsOnline||e.messages)&&j(i,"is-not-present",!r.senderIsOnline(r.message)),(e.messages||e.messages||e.connection)&&j(i,"is-sent-by-you",r.message.from==r.connection.nick),(e.messages||e.messages)&&j(i,"is-highlighted",r.message.highlight),(e.messages||e.messages)&&j(i,"has-not-same-from",!r.message.isSameSender&&!r.message.dayChanged),(e.messages||e.messages)&&j(i,"has-same-from",r.message.isSameSender&&!r.message.dayChanged)},i(e){$||(pe(_),pe(o),pe(M.$$.fragment,e),pe(z),$=!0)},o(e){ge(_),ge(o),ge(M.$$.fragment,e),ge(z),$=!1},d(e){_&&_.d(e),e&&E(t),~n&&O[n].d(e),e&&E(a),e&&E(i),_e(M),U.d(),z&&z.d(),b()}}}function Bo(e){let t;const n=new Oo({props:{class:"for-loading",icon:"spinner",animation:"spin",$$slots:{default:[Ho]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Ho(t){let n,o=Vt("Loading...")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function qo(e){let t,n,o,a,i,r=e.messages.length>40&&e.dialog.is("loading"),s=e.dialog.is("loading"),c=0==e.messages.length&&No(e),d=r&&So(e),l=e.messages,u=[];for(let t=0;t<l.length;t+=1)u[t]=zo(Co(e,l,t));const f=e=>ge(u[e],1,1,()=>{u[e]=null});let p=s&&Bo(e);return{c(){c&&c.c(),t=S(),d&&d.c(),n=S();for(let e=0;e<u.length;e+=1)u[e].c();o=S(),p&&p.c(),a=D()},m(e,r){c&&c.m(e,r),k(e,t,r),d&&d.m(e,r),k(e,n,r);for(let t=0;t<u.length;t+=1)u[t].m(e,r);k(e,o,r),p&&p.m(e,r),k(e,a,r),i=!0},p(e,i){if(0==i.messages.length?c?c.p(e,i):((c=No(i)).c(),c.m(t.parentNode,t)):c&&(c.d(1),c=null),(e.messages||e.dialog)&&(r=i.messages.length>40&&i.dialog.is("loading")),r?d?(d.p(e,i),pe(d,1)):((d=So(i)).c(),pe(d,1),d.m(n.parentNode,n)):d&&(ue(),ge(d,1,1,()=>{d=null}),fe()),e.messages||e.senderIsOnline||e.connection||e.gotoDialogFromNotifications||e.toggleDetails||e.dialog||e.input||e.l||e.unreadFrom){let t;for(l=i.messages,t=0;t<l.length;t+=1){const n=Co(i,l,t);u[t]?(u[t].p(e,n),pe(u[t],1)):(u[t]=zo(n),u[t].c(),pe(u[t],1),u[t].m(o.parentNode,o))}for(ue(),t=l.length;t<u.length;t+=1)f(t);fe()}e.dialog&&(s=i.dialog.is("loading")),s?p?(p.p(e,i),pe(p,1)):((p=Bo(i)).c(),pe(p,1),p.m(a.parentNode,a)):p&&(ue(),ge(p,1,1,()=>{p=null}),fe())},i(e){if(!i){pe(d);for(let e=0;e<l.length;e+=1)pe(u[e]);pe(p),i=!0}},o(e){ge(d),u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)ge(u[e]);ge(p),i=!1},d(e){c&&c.d(e),e&&E(t),d&&d.d(e),e&&E(n),O(u,e),e&&E(o),p&&p.d(e),e&&E(a)}}}function Fo(e,t,n){let o,{connection:a}=t,{dialog:i}=t,{input:r}=t;const s=Z("user"),c=s.events;l(e,c,e=>n("$events",o=e));let d=[],u=0;function f(e){return{color:a.color,from:"Convos",markdown:Yt(e.message,...e.vars),ts:new zn,type:"error",...e}}return e.$set=e=>{"connection"in e&&n("connection",a=e.connection),"dialog"in e&&n("dialog",i=e.dialog),"input"in e&&n("input",r=e.input)},e.$$.update=(e={dialog:1,$events:1})=>{(e.dialog||e.$events)&&function(e,t){const o=[];if("Password protected."==e.frozen)o.push(f({message:"Conversation is password protected. Go to [settings](%1) to enter the password.",vars:["#activeMenu:settings"]}));else if(a.frozen){const e=a.is("unreachable");o.push(f({message:e?"Trying to [reconnect](%1)...":"Disconnected. Your connection %1 can be edited in [settings](%2).",vars:e?["#call:user:ensureConnected"]:[a.name,yt("/chat/"+a.connection_id+"#activeMenu:settings")]}))}else e.frozen&&o.push(f({message:Jt(a,e).replace(/\.$/,""),vars:[]}));null===t.wantNotifications&&o.push(f({message:"Do you want notifications when someone sends you a private message? [Yes](%1) / [No](%2)",vars:["#call:events:requestPermissionToNotify","#call:events:rejectNotifications"]})),n("messages",d=o.length?e.messages.concat(o):e.messages),n("unreadFrom",u=e.unread+o.length)}(i,o)},{connection:a,dialog:i,input:r,events:c,messages:d,unreadFrom:u,gotoDialogFromNotifications:function(e){if(i.connection_id)return;const t=e.target.closest(".message"),n=d[t.dataset.index];n&&(e.preventDefault(),ht(["","chat",n.connection_id,n.dialog_id].map(encodeURIComponent).join("/")+"#"+n.ts.toISOString()))},senderIsOnline:function(e){return!e.dialog_id||i.findParticipant(e.fromId)},toggleDetails:function(e){const t=e.target.closest(".message");s.embedMaker.toggleDetails(t,d[t.dataset.index])},click_handler:({message:e})=>r.add(e.from)}}class Ko extends xe{constructor(e){super(),we(this,e,Fo,qo,s,{connection:0,dialog:0,input:0})}}function Go(e){let t,n,o,a,i;const r=new it({props:{animation:e.animation,name:e.icon}}),s=e.$$slots.default,c=u(s,e,null);return{c(){t=C("button"),ve(r.$$.fragment),n=S(),c&&c.c(),R(t,"class",o=e.classNames.join(" ")),t.disabled=e.disabledProp,R(t,"type",e.type),i=P(t,"click",e.click_handler)},m(e,o){k(e,t,o),ye(r,t,null),x(t,n),c&&c.m(t,null),a=!0},p(e,n){const i={};e.animation&&(i.animation=n.animation),e.icon&&(i.name=n.icon),r.$set(i),c&&c.p&&e.$$scope&&c.p(p(s,n,e,null),f(s,n,null)),(!a||e.classNames&&o!==(o=n.classNames.join(" ")))&&R(t,"class",o),a&&!e.disabledProp||(t.disabled=n.disabledProp),a&&!e.type||R(t,"type",n.type)},i(e){a||(pe(r.$$.fragment,e),pe(c,e),a=!0)},o(e){ge(r.$$.fragment,e),ge(c,e),a=!1},d(e){e&&E(t),_e(r),c&&c.d(e),i()}}}const Wo=700;function Zo(t,n,o){let a,i=e,r=()=>(i(),i=c(g,e=>o("$op",a=e)),g);t.$$.on_destroy.push(()=>i());let s="",d=[],l=!1,u=0,{disabled:f=!1}=n,{icon:p=""}=n,{op:g=new et({api:!1,id:""})}=n;r();let{type:m=""}=n;function h(e){e&&o("t0",u=(new zn).toEpoch()),o("animation",s=e?"spin":""),o("forceDisable",l=e)}let $,{$$slots:b={},$$scope:v}=n;return t.$set=e=>{"disabled"in e&&o("disabled",f=e.disabled),"icon"in e&&o("icon",p=e.icon),"op"in e&&r(o("op",g=e.op)),"type"in e&&o("type",m=e.type),"$$scope"in e&&o("$$scope",v=e.$$scope)},t.$$.update=(e={$op:1,t0:1,icon:1,disabled:1,forceDisable:1})=>{e.$op&&a.is("loading")&&h(!0),(e.$op||e.t0)&&(a.is("loading")||setTimeout(()=>h(!1),Wo-((new zn).toEpoch()-u))),e.icon&&o("classNames",d=["btn","for-"+(p||"default")]),(e.disabled||e.forceDisable)&&o("disabledProp",$=f||l)},{animation:s,classNames:d,disabled:f,icon:p,op:g,type:m,disabledProp:$,click_handler:function(e){V(t,e)},$$slots:b,$$scope:v}}class Vo extends xe{constructor(e){super(),we(this,e,Zo,Go,s,{disabled:0,icon:0,op:0,type:0})}}const Yo=()=>({}),Jo=()=>({});function Qo(e){let t,n,o,a,r,s,c,d;const l=new it({props:{family:"regular",name:e.icon}});l.$on("click",e.click_handler);const g=e.$$slots.label,m=u(g,e,Jo);return{c(){t=C("div"),n=C("input"),o=S(),ve(l.$$.fragment),a=S(),r=C("label"),m||(s=N("Label")),m&&m.c(),R(n,"type","checkbox"),R(n,"id",e.id),R(n,"name",e.name),n.__value=e.value,n.value=n.__value,n.disabled=e.disabled,R(r,"for",e.id),R(t,"class","checkbox"),j(t,"has-focus",e.hasFocus),j(t,"is-disabled",e.disabled),d=[P(n,"change",e.input_change_handler),P(n,"blur",e.blur_handler),P(n,"focus",e.focus_handler)]},m(i,d){k(i,t,d),x(t,n),n.checked=e.checked,e.input_binding(n),x(t,o),ye(l,t,null),x(t,a),x(t,r),m||x(r,s),m&&m.m(r,null),c=!0},p(e,o){c&&!e.id||R(n,"id",o.id),c&&!e.name||R(n,"name",o.name),c&&!e.value||(n.__value=o.value),n.value=n.__value,c&&!e.disabled||(n.disabled=o.disabled),e.checked&&(n.checked=o.checked);const a={};e.icon&&(a.name=o.icon),l.$set(a),m&&m.p&&e.$$scope&&m.p(p(g,o,e,Yo),f(g,o,Jo)),c&&!e.id||R(r,"for",o.id),e.hasFocus&&j(t,"has-focus",o.hasFocus),e.disabled&&j(t,"is-disabled",o.disabled)},i(e){c||(pe(l.$$.fragment,e),pe(m,e),c=!0)},o(e){ge(l.$$.fragment,e),ge(m,e),c=!1},d(n){n&&E(t),e.input_binding(null),_e(l),m&&m.d(n),i(d)}}}function Xo(e,t,n){let o,{checked:a=!1}=t,{disabled:i=!1}=t,{name:r=""}=t,{id:s=(r?"form_"+r:Xe())}=t,{value:c=1}=t,d=!1,{$$slots:l={},$$scope:u}=t;let f;return e.$set=e=>{"checked"in e&&n("checked",a=e.checked),"disabled"in e&&n("disabled",i=e.disabled),"name"in e&&n("name",r=e.name),"id"in e&&n("id",s=e.id),"value"in e&&n("value",c=e.value),"$$scope"in e&&n("$$scope",u=e.$$scope)},e.$$.update=(e={inputEl:1,checked:1})=>{e.inputEl&&o&&!o.syncValue&&(n("inputEl",o.syncValue=function(){n("checked",[a,c]=[this.checked,this.value],a,(n("value",c),n("inputEl",o)))},o),o.syncValue()),e.checked&&n("icon",f=a?"check-square":"square")},{checked:a,disabled:i,name:r,id:s,value:c,inputEl:o,hasFocus:d,icon:f,input_change_handler:function(){a=this.checked,n("checked",a),n("inputEl",o)},input_binding:function(e){J[e?"unshift":"push"](()=>{n("inputEl",o=e)})},blur_handler:()=>{n("hasFocus",d=!1)},focus_handler:()=>{n("hasFocus",d=!0)},click_handler:()=>{i||n("checked",a=!a)},$$slots:l,$$scope:u}}class ea extends xe{constructor(e){super(),we(this,e,Xo,Qo,s,{checked:0,disabled:0,name:0,id:0,value:0})}}function ta(e){let t,n,o=Vt(e.$op.error())+"";return{c(){t=C("div"),n=N(o),R(t,"class","error")},m(e,o){k(e,t,o),x(t,n)},p(e,t){e.$op&&o!==(o=Vt(t.$op.error())+"")&&A(n,o)},d(e){e&&E(t)}}}function na(t){let n,o=t.$op.is("error"),a=o&&ta(t);return{c(){a&&a.c(),n=D()},m(e,t){a&&a.m(e,t),k(e,n,t)},p(e,t){e.$op&&(o=t.$op.is("error")),o?a?a.p(e,t):((a=ta(t)).c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},i:e,o:e,d(e){a&&a.d(e),e&&E(n)}}}function oa(t,n,o){let a,i=e,r=()=>(i(),i=c(s,e=>o("$op",a=e)),s);t.$$.on_destroy.push(()=>i());let{op:s=new et({})}=n;return r(),t.$set=e=>{"op"in e&&r(o("op",s=e.op))},{op:s,$op:a}}class aa extends xe{constructor(e){super(),we(this,e,oa,na,s,{op:0})}}const ia=()=>({}),ra=()=>({});function sa(e){let t,n,o,a,i,r,s;const c=e.$$slots.label,d=u(c,e,ra);return{c(){t=C("div"),n=C("label"),d||(o=N("Label")),d&&d.c(),a=S(),i=C("input"),R(n,"for",e.id),R(i,"type","password"),R(i,"name",e.name),R(i,"id",e.id),R(i,"placeholder",e.placeholder),i.readOnly=e.readonly,R(t,"class","text-field has-password"),t.hidden=e.hidden,s=P(i,"input",e.input_input_handler)},m(s,c){k(s,t,c),x(t,n),d||x(n,o),d&&d.m(n,null),x(t,a),x(t,i),T(i,e.value),r=!0},p(e,o){d&&d.p&&e.$$scope&&d.p(p(c,o,e,ia),f(c,o,ra)),r&&!e.id||R(n,"for",o.id),r&&!e.name||R(i,"name",o.name),r&&!e.id||R(i,"id",o.id),r&&!e.placeholder||R(i,"placeholder",o.placeholder),r&&!e.readonly||(i.readOnly=o.readonly),e.value&&i.value!==o.value&&T(i,o.value),r&&!e.hidden||(t.hidden=o.hidden)},i(e){r||(pe(d,e),r=!0)},o(e){ge(d,e),r=!1},d(e){e&&E(t),d&&d.d(e),s()}}}function ca(e,t,n){let{hidden:o=!1}=t,{name:a=""}=t,{id:i=(a?"form_"+a:Xe())}=t,{placeholder:r=""}=t,{readonly:s=!1}=t,{value:c=""}=t,{$$slots:d={},$$scope:l}=t;return e.$set=e=>{"hidden"in e&&n("hidden",o=e.hidden),"name"in e&&n("name",a=e.name),"id"in e&&n("id",i=e.id),"placeholder"in e&&n("placeholder",r=e.placeholder),"readonly"in e&&n("readonly",s=e.readonly),"value"in e&&n("value",c=e.value),"$$scope"in e&&n("$$scope",l=e.$$scope)},{hidden:o,name:a,id:i,placeholder:r,readonly:s,value:c,input_input_handler:function(){c=this.value,n("value",c)},$$slots:d,$$scope:l}}class da extends xe{constructor(e){super(),we(this,e,ca,sa,s,{hidden:0,name:0,id:0,placeholder:0,readonly:0,value:0})}}function la(e){let t,n,o,a,i=Vt(e.dialog.dialog_id?"Conversation":"Connection")+"";const r=new it({props:{name:"times-circle"}});return{c(){t=C("h2"),n=N(i),o=S(),ve(r.$$.fragment)},m(e,i){k(e,t,i),x(t,n),k(e,o,i),ye(r,e,i),a=!0},p(e,t){a&&!e.dialog||i===(i=Vt(t.dialog.dialog_id?"Conversation":"Connection")+"")||A(n,i)},i(e){a||(pe(r.$$.fragment,e),a=!0)},o(e){ge(r.$$.fragment,e),a=!1},d(e){e&&E(t),e&&E(o),_e(r,e)}}}function ua(e){let t,n={href:e.dialog.path,class:"sidebar__header for-settings",$$slots:{default:[la]},$$scope:{ctx:e}};const o=new kt({props:n});return e.link_binding(o),{c(){ve(o.$$.fragment)},m(e,n){ye(o,e,n),t=!0},p(e,t){const n={};e.dialog&&(n.href=t.dialog.path),(e.$$scope||e.dialog)&&(n.$$scope={changed:e,ctx:t}),o.$set(n)},i(e){t||(pe(o.$$.fragment,e),t=!0)},o(e){ge(o.$$.fragment,e),t=!1},d(t){e.link_binding(null),_e(o,t)}}}function fa(e,t,n){let o,{dialog:a={}}=t;return e.$set=e=>{"dialog"in e&&n("dialog",a=e.dialog)},e.$$.update=(e={linkEl:1})=>{e.linkEl&&o&&o.focus()},{dialog:a,linkEl:o,link_binding:function(e){J[e?"unshift":"push"](()=>{n("linkEl",o=e)})}}}class pa extends xe{constructor(e){super(),we(this,e,fa,ua,s,{dialog:0})}}const ga=()=>({}),ma=()=>({});function ha(e){let t,n,o,a,i,r,s;const c=e.$$slots.label,d=u(c,e,ma);return{c(){t=C("div"),n=C("label"),d||(o=N("Label")),d&&d.c(),a=S(),i=C("textarea"),R(n,"for",e.id),R(i,"name",e.name),R(i,"placeholder",e.placeholder),R(i,"id",e.id),i.readOnly=e.readonly,R(t,"class","text-area"),t.hidden=e.hidden,s=P(i,"input",e.textarea_input_handler)},m(s,c){k(s,t,c),x(t,n),d||x(n,o),d&&d.m(n,null),x(t,a),x(t,i),T(i,e.value),e.textarea_binding(i),r=!0},p(e,o){d&&d.p&&e.$$scope&&d.p(p(c,o,e,ga),f(c,o,ma)),r&&!e.id||R(n,"for",o.id),r&&!e.name||R(i,"name",o.name),r&&!e.placeholder||R(i,"placeholder",o.placeholder),r&&!e.id||R(i,"id",o.id),r&&!e.readonly||(i.readOnly=o.readonly),e.value&&T(i,o.value),r&&!e.hidden||(t.hidden=o.hidden)},i(e){r||(pe(d,e),r=!0)},o(e){ge(d,e),r=!1},d(n){n&&E(t),d&&d.d(n),e.textarea_binding(null),s()}}}function $a(e,t,n){let o,{hidden:a=!1}=t,{name:i=""}=t,{id:r=(i?"form_"+i:Xe())}=t,{placeholder:s=""}=t,{readonly:c=!1}=t,{value:d=""}=t,{$$slots:l={},$$scope:u}=t;return e.$set=e=>{"hidden"in e&&n("hidden",a=e.hidden),"name"in e&&n("name",i=e.name),"id"in e&&n("id",r=e.id),"placeholder"in e&&n("placeholder",s=e.placeholder),"readonly"in e&&n("readonly",c=e.readonly),"value"in e&&n("value",d=e.value),"$$scope"in e&&n("$$scope",u=e.$$scope)},e.$$.update=(e={inputEl:1})=>{e.inputEl&&o&&!o.syncValue&&(n("inputEl",o.syncValue=function(){n("value",d=this.value)},o),o.syncValue())},{inputEl:o,hidden:a,name:i,id:r,placeholder:s,readonly:c,value:d,textarea_input_handler:function(){d=this.value,n("value",d),n("inputEl",o)},textarea_binding:function(e){J[e?"unshift":"push"](()=>{n("inputEl",o=e)})},$$slots:l,$$scope:u}}class ba extends xe{constructor(e){super(),we(this,e,$a,ha,s,{hidden:0,name:0,id:0,placeholder:0,readonly:0,value:0})}}function va(e){let t,n;return{c(){R(t=C("input"),"type","hidden"),R(t,"name","connection_id"),t.value=n=e.connection.connection_id},m(e,n){k(e,t,n)},p(e,o){e.connection&&n!==(n=o.connection.connection_id)&&(t.value=n)},d(e){e&&E(t)}}}function ya(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Host and port")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function _a(t){return{c:e,m:e,p:e,d:e}}function wa(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Nickname")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function xa(t){return{c:e,m:e,p:e,d:e}}function ka(e){let t;const n=new Pt({props:{name:"dialog",placeholder:Vt("Ex: #convos"),$$slots:{default:[Ca],label:[Oa]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Ea(e){let t,n;function o(t){e.checkbox_checked_binding.call(null,t)}let a={$$slots:{default:[Sa],label:[Na]},$$scope:{ctx:e}};void 0!==e.wantToBeConnected&&(a.checked=e.wantToBeConnected);const i=new ea({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,t){ye(i,e,t),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),!t&&e.wantToBeConnected&&(t=!0,o.checked=n.wantToBeConnected,ie(()=>t=!1)),i.$set(o)},i(e){n||(pe(i.$$.fragment,e),n=!0)},o(e){ge(i.$$.fragment,e),n=!1},d(e){_e(i,e)}}}function Oa(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Conversation name")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ca(t){return{c:e,m:e,p:e,d:e}}function Na(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Want to be connected")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Sa(t){return{c:e,m:e,p:e,d:e}}function Da(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Secure connection (TLS)")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Pa(t){return{c:e,m:e,p:e,d:e}}function Ma(e){let t,n;function o(t){e.checkbox_checked_binding_1.call(null,t)}let a={name:"tls_verify",$$slots:{default:[Aa],label:[Ra]},$$scope:{ctx:e}};void 0!==e.verifyTls&&(a.checked=e.verifyTls);const i=new ea({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,t){ye(i,e,t),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),!t&&e.verifyTls&&(t=!0,o.checked=n.verifyTls,ie(()=>t=!1)),i.$set(o)},i(e){n||(pe(i.$$.fragment,e),n=!0)},o(e){ge(i.$$.fragment,e),n=!1},d(e){_e(i,e)}}}function Ra(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Verify certificate (TLS)")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Aa(t){return{c:e,m:e,p:e,d:e}}function Ta(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Show advanced settings")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function La(t){return{c:e,m:e,p:e,d:e}}function ja(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Username")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ia(t){return{c:e,m:e,p:e,d:e}}function Ua(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function za(t){return{c:e,m:e,p:e,d:e}}function Ba(t){let n;return{c(){(n=C("span")).textContent=`${Vt("On-connect commands")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ha(t){return{c:e,m:e,p:e,d:e}}function qa(e){let t;const n=new Vo({props:{icon:"save",op:e.createConnectionOp,$$slots:{default:[Ka]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Fa(e){let t,n;const o=new Vo({props:{icon:"save",op:e.updateConnectionOp,$$slots:{default:[Ga]},$$scope:{ctx:e}}}),a=new Vo({props:{icon:"trash",type:"button",op:e.removeConnectionOp,$$slots:{default:[Wa]},$$scope:{ctx:e}}});return a.$on("click",e.removeConnection),{c(){ve(o.$$.fragment),t=S(),ve(a.$$.fragment)},m(e,i){ye(o,e,i),k(e,t,i),ye(a,e,i),n=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),o.$set(n);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),a.$set(i)},i(e){n||(pe(o.$$.fragment,e),pe(a.$$.fragment,e),n=!0)},o(e){ge(o.$$.fragment,e),ge(a.$$.fragment,e),n=!1},d(e){_e(o,e),e&&E(t),_e(a,e)}}}function Ka(t){let n,o=Vt("Create")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ga(t){let n,o=Vt("Update")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Wa(t){let n,o=Vt("Delete")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Za(t){let n,o,a,i,r,s,c,d,l,u,f,p,g,m,h,$,b,v,y,_,w,O,N,D,A,T,L,j,I=t.connection.connection_id&&va(t);const U=new Pt({props:{name:"server",placeholder:Vt("Ex: chat.freenode.net:6697"),readonly:t.settings.forced_connection,$$slots:{default:[_a],label:[ya]},$$scope:{ctx:t}}});let z=t.settings.forced_connection&&function(t){let n,o=Yt("Connection is locked by %1.",t.settings.contact)+"";return{c(){n=C("p")},m(e,t){k(e,n,t),n.innerHTML=o},p:e,d(e){e&&E(n)}}}(t);const B=new Pt({props:{name:"nick",placeholder:Vt("Ex: your-name"),$$slots:{default:[xa],label:[wa]},$$scope:{ctx:t}}}),H=[Ea,ka],q=[];function F(e,t){return t.connection.url?0:1}function K(e){t.checkbox0_checked_binding.call(null,e)}u=F(0,t),f=q[u]=H[u](t);let G={name:"tls",$$slots:{default:[Pa],label:[Da]},$$scope:{ctx:t}};void 0!==t.useTls&&(G.checked=t.useTls);const W=new ea({props:G});J.push(()=>be(W,"checked",K));let Z=t.useTls&&Ma(t);function V(e){t.checkbox1_checked_binding.call(null,e)}let Y={$$slots:{default:[La],label:[Ta]},$$scope:{ctx:t}};void 0!==t.showAdvancedSettings&&(Y.checked=t.showAdvancedSettings);const Q=new ea({props:Y});J.push(()=>be(Q,"checked",V));const X=new Pt({props:{name:"username",hidden:!t.showAdvancedSettings,$$slots:{default:[Ia],label:[ja]},$$scope:{ctx:t}}}),ee=new da({props:{name:"password",hidden:!t.showAdvancedSettings,$$slots:{default:[za],label:[Ua]},$$scope:{ctx:t}}}),te=new ba({props:{name:"on_connect_commands",hidden:!t.showAdvancedSettings,$$slots:{default:[Ha],label:[Ba]},$$scope:{ctx:t}}}),ne=[Fa,qa],oe=[];function ae(e,t){return t.connection.url?0:1}O=ae(0,t),N=oe[O]=ne[O](t);const re=new aa({props:{op:t.createConnectionOp}}),se=new aa({props:{op:t.removeConnectionOp}}),ce=new aa({props:{op:t.updateConnectionOp}});return{c(){n=C("form"),I&&I.c(),o=S(),a=C("input"),i=S(),r=C("input"),s=S(),ve(U.$$.fragment),c=S(),z&&z.c(),d=S(),ve(B.$$.fragment),l=S(),f.c(),p=S(),ve(W.$$.fragment),m=S(),Z&&Z.c(),h=S(),ve(Q.$$.fragment),b=S(),ve(X.$$.fragment),v=S(),ve(ee.$$.fragment),y=S(),ve(te.$$.fragment),_=S(),w=C("div"),N.c(),D=S(),ve(re.$$.fragment),A=S(),ve(se.$$.fragment),T=S(),ve(ce.$$.fragment),R(a,"type","hidden"),R(a,"name","url"),R(r,"type","hidden"),R(r,"name","wanted_state"),R(w,"class","form-actions"),R(n,"method","post"),j=P(n,"submit",M(t.submitForm))},m(e,f){k(e,n,f),I&&I.m(n,null),x(n,o),x(n,a),x(n,i),x(n,r),x(n,s),ye(U,n,null),x(n,c),z&&z.m(n,null),x(n,d),ye(B,n,null),x(n,l),q[u].m(n,null),x(n,p),ye(W,n,null),x(n,m),Z&&Z.m(n,null),x(n,h),ye(Q,n,null),x(n,b),ye(X,n,null),x(n,v),ye(ee,n,null),x(n,y),ye(te,n,null),x(n,_),x(n,w),oe[O].m(w,null),x(n,D),ye(re,n,null),x(n,A),ye(se,n,null),x(n,T),ye(ce,n,null),t.form_binding(n),L=!0},p(e,t){t.connection.connection_id?I?I.p(e,t):((I=va(t)).c(),I.m(n,o)):I&&(I.d(1),I=null);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),U.$set(a),t.settings.forced_connection&&z.p(e,t);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),B.$set(i);let r=u;(u=F(0,t))===r?q[u].p(e,t):(ue(),ge(q[r],1,1,()=>{q[r]=null}),fe(),(f=q[u])||(f=q[u]=H[u](t)).c(),pe(f,1),f.m(n,p));const s={};e.$$scope&&(s.$$scope={changed:e,ctx:t}),!g&&e.useTls&&(g=!0,s.checked=t.useTls,ie(()=>g=!1)),W.$set(s),t.useTls?Z?(Z.p(e,t),pe(Z,1)):((Z=Ma(t)).c(),pe(Z,1),Z.m(n,h)):Z&&(ue(),ge(Z,1,1,()=>{Z=null}),fe());const c={};e.$$scope&&(c.$$scope={changed:e,ctx:t}),!$&&e.showAdvancedSettings&&($=!0,c.checked=t.showAdvancedSettings,ie(()=>$=!1)),Q.$set(c);const d={};e.showAdvancedSettings&&(d.hidden=!t.showAdvancedSettings),e.$$scope&&(d.$$scope={changed:e,ctx:t}),X.$set(d);const l={};e.showAdvancedSettings&&(l.hidden=!t.showAdvancedSettings),e.$$scope&&(l.$$scope={changed:e,ctx:t}),ee.$set(l);const m={};e.showAdvancedSettings&&(m.hidden=!t.showAdvancedSettings),e.$$scope&&(m.$$scope={changed:e,ctx:t}),te.$set(m);let b=O;(O=ae(0,t))===b?oe[O].p(e,t):(ue(),ge(oe[b],1,1,()=>{oe[b]=null}),fe(),(N=oe[O])||(N=oe[O]=ne[O](t)).c(),pe(N,1),N.m(w,null))},i(e){L||(pe(U.$$.fragment,e),pe(B.$$.fragment,e),pe(f),pe(W.$$.fragment,e),pe(Z),pe(Q.$$.fragment,e),pe(X.$$.fragment,e),pe(ee.$$.fragment,e),pe(te.$$.fragment,e),pe(N),pe(re.$$.fragment,e),pe(se.$$.fragment,e),pe(ce.$$.fragment,e),L=!0)},o(e){ge(U.$$.fragment,e),ge(B.$$.fragment,e),ge(f),ge(W.$$.fragment,e),ge(Z),ge(Q.$$.fragment,e),ge(X.$$.fragment,e),ge(ee.$$.fragment,e),ge(te.$$.fragment,e),ge(N),ge(re.$$.fragment,e),ge(se.$$.fragment,e),ge(ce.$$.fragment,e),L=!1},d(e){e&&E(n),I&&I.d(),_e(U),z&&z.d(),_e(B),q[u].d(),_e(W),Z&&Z.d(),_e(Q),_e(X),_e(ee),_e(te),oe[O].d(),_e(re),_e(se),_e(ce),t.form_binding(null),j()}}}function Va(e,t,n){let{dialog:o={}}=t;const a=Z("settings"),i=Z("user"),r=i.api.operation("createConnection"),s=i.api.operation("removeConnection"),c=i.api.operation("updateConnection");[r,c].forEach(e=>{e.on("start",e=>{e.body.on_connect_commands=e.body.on_connect_commands.split("\n").map(e=>e.trim())})});let d,l={},u=!1,f=!1,p=!1,g=!1;function m(){l.url&&(n("formEl",d.server.value=l.url.host,d),n("formEl",d.nick.value=l.url.searchParams.get("nick")||"",d),n("formEl",d.on_connect_commands.value=l.on_connect_commands.join("\n"),d),n("formEl",d.password.value=l.url.password,d),n("formEl",d.username.value=l.url.username,d),n("formEl",d.url.value=l.url.toString(),d),n("useTls",f="1"==l.url.searchParams.get("tls")),n("verifyTls",p="1"==l.url.searchParams.get("tls_verify")),n("wantToBeConnected",g="connected"==l.wanted_state))}return G(async()=>{if(d)return n("connection",l=i.findDialog({connection_id:o.connection_id})||{}),l.url?m():function(){a.forced_connection&&n("formEl",d.server.value=a.default_connection,d);n("formEl",d.nick.value=i.email.replace(/@.*/,"").replace(/\W/g,"_"),d),n("useTls",f=!0),n("wantToBeConnected",g=!0);const e=new URL(location.href);if(!e.searchParams.get("uri"))return _t(d,e);const t=new Sn(e.searchParams.get("uri")),o=t.searchParams;t.host&&n("formEl",d.server.value=t.host,d);t.password&&n("formEl",d.password.value=t.password,d);t.username&&n("formEl",d.username.value=t.username,d);o.get("nick")&&n("formEl",d.nick.value=o.get("nick"),d);t.pathname&&d.dialog&&n("formEl",d.dialog.value=decodeURIComponent(t.pathname.split("/").filter(e=>e.length)[0]||""),d);Number(o.get("tls")||0)&&n("useTls",f=!0);Number(o.get("tls_verify")||0)&&n("verifyTls",p=!0)}()}),e.$set=e=>{"dialog"in e&&n("dialog",o=e.dialog)},e.$$.update=(e={formEl:1,wantToBeConnected:1})=>{(e.formEl||e.wantToBeConnected)&&d&&n("formEl",d.wanted_state.value=g?"connected":"disconnected",d)},{dialog:o,settings:a,createConnectionOp:r,removeConnectionOp:s,updateConnectionOp:c,connection:l,formEl:d,showAdvancedSettings:u,useTls:f,verifyTls:p,wantToBeConnected:g,removeConnection:async function(e){await s.perform(l),i.removeDialog(l),ht("/chat")},submitForm:async function(e){if(d.server.value)if(n("formEl",d.url.value=new Sn("irc://localhost:6667").fromForm(e.target).toString(),d),l.connection_id)await c.perform(e.target),n("connection",l=i.ensureDialog(c.res.body)),m();else{await r.perform(e.target),ht(i.ensureDialog(r.res.body).path)}},checkbox_checked_binding:function(e){n("wantToBeConnected",g=e)},checkbox0_checked_binding:function(e){n("useTls",f=e)},checkbox_checked_binding_1:function(e){n("verifyTls",p=e)},checkbox1_checked_binding:function(e){n("showAdvancedSettings",u=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{n("formEl",d=e)})}}}class Ya extends xe{constructor(e){super(),we(this,e,Va,Za,s,{dialog:0})}}function Ja(e){let t,n,o=Vt("Currently connecting to %1.",e.connectionHost)+"";return{c(){t=C("p"),n=N(o)},m(e,o){k(e,t,o),x(t,n)},p(e,t){e.connectionHost&&o!==(o=Vt("Currently connecting to %1.",t.connectionHost)+"")&&A(n,o)},d(e){e&&E(t)}}}function Qa(e){let t,n,o=Vt("Currently connected to %1.",e.connectionHost)+"";return{c(){t=C("p"),n=N(o)},m(e,o){k(e,t,o),x(t,n)},p(e,t){e.connectionHost&&o!==(o=Vt("Currently connected to %1.",t.connectionHost)+"")&&A(n,o)},d(e){e&&E(t)}}}function Xa(e){let t,n,o=Vt("Currently disconnected from %1.",e.connectionHost)+"";return{c(){t=C("p"),n=N(o)},m(e,o){k(e,t,o),x(t,n)},p(e,t){e.connectionHost&&o!==(o=Vt("Currently disconnected from %1.",t.connectionHost)+"")&&A(n,o)},d(e){e&&E(t)}}}function ei(t){let n;return{c(){(n=C("p")).textContent=`${Vt("Connection not found.")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ti(e){let t,n,o,a,i;const r=new pa({props:{dialog:e.dialog}});function s(e,t){return t.connection.url?"disconnected"==t.connection.state?Xa:"connected"==t.connection.state?Qa:Ja:ei}let c=s(0,e),d=c(e);const l=new Ya({props:{dialog:e.dialog}});return{c(){t=C("div"),ve(r.$$.fragment),n=S(),d.c(),o=S(),ve(l.$$.fragment),R(t,"class","sidebar-left")},m(e,a){k(e,t,a),ye(r,t,null),x(t,n),d.m(t,null),x(t,o),ye(l,t,null),i=!0},p(e,n){const a={};e.dialog&&(a.dialog=n.dialog),r.$set(a),c===(c=s(0,n))&&d?d.p(e,n):(d.d(1),(d=c(n))&&(d.c(),d.m(t,o)));const i={};e.dialog&&(i.dialog=n.dialog),l.$set(i)},i(n){i||(pe(r.$$.fragment,n),pe(l.$$.fragment,n),ae(()=>{a||(a=he(t,At,e.transition,!0)),a.run(1)}),i=!0)},o(n){ge(r.$$.fragment,n),ge(l.$$.fragment,n),a||(a=he(t,At,e.transition,!1)),a.run(0),i=!1},d(e){e&&E(t),_e(r),d.d(),_e(l),e&&a&&a.end()}}}function ni(e,t,n){let{dialog:o={}}=t,{transition:a}=t;const i=Z("user");let r,s={};return G(async()=>{await i.load(),n("connection",s=i.findDialog({connection_id:o.connection_id})||{})}),e.$set=e=>{"dialog"in e&&n("dialog",o=e.dialog),"transition"in e&&n("transition",a=e.transition)},e.$$.update=(e={connection:1})=>{e.connection&&n("connectionHost",r=s.url&&s.url.host)},{dialog:o,transition:a,connection:s,connectionHost:r}}class oi extends xe{constructor(e){super(),we(this,e,ni,ti,s,{dialog:0,transition:0})}}function ai(e,t,n){const o=Object.create(e);return o.participant=t[n],o}function ii(e){let t,n=Vt("You are not a channel operator in %1.",e.dialog.name)+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.dialog&&n!==(n=Vt("You are not a channel operator in %1.",o.dialog.name)+"")&&A(t,n)},d(e){e&&E(t)}}}function ri(e){let t,n=Vt("You are a channel operator in %1.",e.dialog.name)+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.dialog&&n!==(n=Vt("You are a channel operator in %1.",o.dialog.name)+"")&&A(t,n)},d(e){e&&E(t)}}}function si(e){let t,n=Vt("Private conversation with %1.",e.dialog.name)+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.dialog&&n!==(n=Vt("Private conversation with %1.",o.dialog.name)+"")&&A(t,n)},d(e){e&&E(t)}}}function ci(e){let t,n=Vt("Conversation with %1 is frozen. Reason: %2",e.dialog.name,Vt(e.dialog.frozen))+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.dialog&&n!==(n=Vt("Conversation with %1 is frozen. Reason: %2",o.dialog.name,Vt(o.dialog.frozen))+"")&&A(t,n)},d(e){e&&E(t)}}}function di(e){let t,n,o,a,i,r,s,c,d,l,u,f,p=e.dialog.hasOwnProperty("wantNotifications");function g(t){e.textarea_value_binding.call(null,t)}let m={name:"topic",placeholder:Vt("No topic is set."),readonly:!e.isOperator,$$slots:{default:[ui],label:[li]},$$scope:{ctx:e}};void 0!==e.dialogTopic&&(m.value=e.dialogTopic);const h=new ba({props:m});function $(t){e.passwordfield_value_binding.call(null,t)}J.push(()=>be(h,"value",g));let b={name:"password",readonly:"Password protected."!=e.dialog.frozen&&!e.isOperator,$$slots:{default:[pi],label:[fi]},$$scope:{ctx:e}};void 0!==e.dialogPassword&&(b.value=e.dialogPassword);const v=new da({props:b});J.push(()=>be(v,"value",$));let y=p&&gi(e);return{c(){t=C("input"),o=S(),a=C("input"),r=S(),ve(h.$$.fragment),c=S(),ve(v.$$.fragment),l=S(),y&&y.c(),u=D(),R(t,"type","hidden"),R(t,"name","connection_id"),t.value=n=e.dialog.connection_id,R(a,"type","hidden"),R(a,"name","dialog_id"),a.value=i=e.dialog.dialog_id},m(e,n){k(e,t,n),k(e,o,n),k(e,a,n),k(e,r,n),ye(h,e,n),k(e,c,n),ye(v,e,n),k(e,l,n),y&&y.m(e,n),k(e,u,n),f=!0},p(e,o){(!f||e.dialog&&n!==(n=o.dialog.connection_id))&&(t.value=n),(!f||e.dialog&&i!==(i=o.dialog.dialog_id))&&(a.value=i);const r={};e.isOperator&&(r.readonly=!o.isOperator),e.$$scope&&(r.$$scope={changed:e,ctx:o}),!s&&e.dialogTopic&&(s=!0,r.value=o.dialogTopic,ie(()=>s=!1)),h.$set(r);const c={};(e.dialog||e.isOperator)&&(c.readonly="Password protected."!=o.dialog.frozen&&!o.isOperator),e.$$scope&&(c.$$scope={changed:e,ctx:o}),!d&&e.dialogPassword&&(d=!0,c.value=o.dialogPassword,ie(()=>d=!1)),v.$set(c),e.dialog&&(p=o.dialog.hasOwnProperty("wantNotifications")),p?y?(y.p(e,o),pe(y,1)):((y=gi(o)).c(),pe(y,1),y.m(u.parentNode,u)):y&&(ue(),ge(y,1,1,()=>{y=null}),fe())},i(e){f||(pe(h.$$.fragment,e),pe(v.$$.fragment,e),pe(y),f=!0)},o(e){ge(h.$$.fragment,e),ge(v.$$.fragment,e),ge(y),f=!1},d(e){e&&E(t),e&&E(o),e&&E(a),e&&E(r),_e(h,e),e&&E(c),_e(v,e),e&&E(l),y&&y.d(e),e&&E(u)}}}function li(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Topic")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ui(t){return{c:e,m:e,p:e,d:e}}function fi(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function pi(t){return{c:e,m:e,p:e,d:e}}function gi(e){let t,n;function o(t){e.checkbox_checked_binding.call(null,t)}let a={$$slots:{default:[hi],label:[mi]},$$scope:{ctx:e}};void 0!==e.wantNotifications&&(a.checked=e.wantNotifications);const i=new ea({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,t){ye(i,e,t),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),!t&&e.wantNotifications&&(t=!0,o.checked=n.wantNotifications,ie(()=>t=!1)),i.$set(o)},i(e){n||(pe(i.$$.fragment,e),n=!0)},o(e){ge(i.$$.fragment,e),n=!1},d(e){_e(i,e)}}}function mi(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Send me notifications")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function hi(t){return{c:e,m:e,p:e,d:e}}function $i(e){let t;const n=new Vo({props:{icon:"save",$$slots:{default:[bi]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function bi(t){let n,o=Vt("Update")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function vi(t){let n,o=Vt("Leave")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function yi(e){let t,n,o,a,i,r=Vt("Participants (%1)",e.dialog.participants().length)+"",s=e.dialog.participants(),c=[];for(let t=0;t<s.length;t+=1)c[t]=wi(ai(e,s,t));const d=e=>ge(c[e],1,1,()=>{c[e]=null});return{c(){t=C("nav"),n=C("h3"),o=N(r),a=S();for(let e=0;e<c.length;e+=1)c[e].c();R(t,"class","sidebar-left__nav")},m(e,r){k(e,t,r),x(t,n),x(n,o),x(t,a);for(let e=0;e<c.length;e+=1)c[e].m(t,null);i=!0},p(e,n){if(i&&!e.dialog||r===(r=Vt("Participants (%1)",n.dialog.participants().length)+"")||A(o,r),e.dialog||e.modeClassNames){let o;for(s=n.dialog.participants(),o=0;o<s.length;o+=1){const a=ai(n,s,o);c[o]?(c[o].p(e,a),pe(c[o],1)):(c[o]=wi(a),c[o].c(),pe(c[o],1),c[o].m(t,null))}for(ue(),o=s.length;o<c.length;o+=1)d(o);fe()}},i(e){if(!i){for(let e=0;e<s.length;e+=1)pe(c[e]);i=!0}},o(e){c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)ge(c[e]);i=!1},d(e){e&&E(t),O(c,e)}}}function _i(e){let t,n,o,a=e.participant.nick+"";return{c(){t=C("span"),n=N(a),o=S()},m(e,a){k(e,t,a),x(t,n),k(e,o,a)},p(e,t){e.dialog&&a!==(a=t.participant.nick+"")&&A(n,a)},d(e){e&&E(t),e&&E(o)}}}function wi(e){let t;const n=new kt({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+Ge(e.participant.modes),$$slots:{default:[_i]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.dialog&&(o.href="/chat/"+t.dialog.connection_id+"/"+t.participant.id),e.dialog&&(o.class="participant "+Ge(t.participant.modes)),(e.$$scope||e.dialog)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function xi(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g=!e.dialog.is("private"),m=!e.dialog.is("private");const h=new pa({props:{dialog:e.dialog}});function $(e,t){return t.dialog.frozen?ci:((null==a||e.dialog)&&(a=!!t.dialog.is("private")),a?si:t.isOperator?ri:ii)}let b=$(null,e),v=b(e),y=g&&di(e),_=m&&$i(e);const w=new Vo({props:{type:"button",icon:"sign-out-alt",$$slots:{default:[vi]},$$scope:{ctx:e}}});w.$on("click",e.partDialog);let O=!e.dialog.frozen&&yi(e);return{c(){t=C("div"),ve(h.$$.fragment),n=S(),o=C("p"),v.c(),i=S(),r=C("form"),y&&y.c(),s=S(),c=C("div"),_&&_.c(),d=S(),ve(w.$$.fragment),l=S(),O&&O.c(),R(c,"class","form-actions"),R(r,"method","post"),R(t,"class","sidebar-left"),p=P(r,"submit",M(e.saveDialogSettings))},m(a,u){k(a,t,u),ye(h,t,null),x(t,n),x(t,o),v.m(o,null),x(t,i),x(t,r),y&&y.m(r,null),x(r,s),x(r,c),_&&_.m(c,null),x(c,d),ye(w,c,null),e.form_binding(r),x(t,l),O&&O.m(t,null),f=!0},p(e,n){const a={};e.dialog&&(a.dialog=n.dialog),h.$set(a),b===(b=$(e,n))&&v?v.p(e,n):(v.d(1),(v=b(n))&&(v.c(),v.m(o,null))),e.dialog&&(g=!n.dialog.is("private")),g?y?(y.p(e,n),pe(y,1)):((y=di(n)).c(),pe(y,1),y.m(r,s)):y&&(ue(),ge(y,1,1,()=>{y=null}),fe()),e.dialog&&(m=!n.dialog.is("private")),m?_?(_.p(e,n),pe(_,1)):((_=$i(n)).c(),pe(_,1),_.m(c,d)):_&&(ue(),ge(_,1,1,()=>{_=null}),fe());const i={};e.$$scope&&(i.$$scope={changed:e,ctx:n}),w.$set(i),n.dialog.frozen?O&&(ue(),ge(O,1,1,()=>{O=null}),fe()):O?(O.p(e,n),pe(O,1)):((O=yi(n)).c(),pe(O,1),O.m(t,null))},i(n){f||(pe(h.$$.fragment,n),pe(y),pe(_),pe(w.$$.fragment,n),pe(O),ae(()=>{u||(u=he(t,At,e.transition,!0)),u.run(1)}),f=!0)},o(n){ge(h.$$.fragment,n),ge(y),ge(_),ge(w.$$.fragment,n),ge(O),u||(u=he(t,At,e.transition,!1)),u.run(0),f=!1},d(n){n&&E(t),_e(h),v.d(),y&&y.d(),_&&_.d(),_e(w),e.form_binding(null),O&&O.d(),n&&u&&u.end(),p()}}}function ki(e,t,n){let{dialog:o={}}=t,{transition:a}=t;const i=Z("user");let r,s,c="",d=o.topic,l=o.wantNotifications;return e.$set=e=>{"dialog"in e&&n("dialog",o=e.dialog),"transition"in e&&n("transition",a=e.transition)},e.$$.update=(e={dialog:1,wantNotifications:1,formEl:1})=>{e.dialog&&n("isOperator",s=function(e){const t=i.findDialog({connection_id:e.connection_id}),n=e.findParticipant(t&&t.nick);return n&&n.modes.operator}(o)),(e.dialog||e.wantNotifications)&&o.update({wantNotifications:l}),(e.formEl||e.dialog)&&r&&r.topic&&n("formEl",r.topic.value=o.topic||"",r)},{dialog:o,transition:a,dialogPassword:c,dialogTopic:d,formEl:r,wantNotifications:l,partDialog:function(e){i.send({message:"/part",dialog:o})},saveDialogSettings:function(e){if(c){const e=s?"/mode +k "+c:"/join "+o.name+" "+c;i.send({message:e,dialog:o}),n("dialogPassword",c="")}s&&d!=o.topic&&i.send({message:"/topic "+d,dialog:o})},isOperator:s,textarea_value_binding:function(e){n("dialogTopic",d=e)},passwordfield_value_binding:function(e){n("dialogPassword",c=e)},checkbox_checked_binding:function(e){n("wantNotifications",l=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{n("formEl",r=e)})}}}class Ei extends xe{constructor(e){super(),we(this,e,ki,xi,s,{dialog:0,transition:0})}}function Oi(e,t,n){const o=Object.create(e);return o.participant=t[n],o}function Ci(e){let t,n;var o=e.settingsComponent;function a(e){return{props:{dialog:e.dialog,transition:{duration:250,x:e.$container.wideScreen?0:e.$container.width}}}}if(o)var i=new o(a(e));return{c(){i&&ve(i.$$.fragment),t=D()},m(e,o){i&&ye(i,e,o),k(e,t,o),n=!0},p(e,n){const r={};if(e.dialog&&(r.dialog=n.dialog),e.$container&&(r.transition={duration:250,x:n.$container.wideScreen?0:n.$container.width}),o!==(o=n.settingsComponent)){if(i){ue();const e=i;ge(e.$$.fragment,1,0,()=>{_e(e,1)}),fe()}o?(ve((i=new o(a(n))).$$.fragment),pe(i.$$.fragment,1),ye(i,t.parentNode,t)):i=null}else o&&i.$set(r)},i(e){n||(i&&pe(i.$$.fragment,e),n=!0)},o(e){i&&ge(i.$$.fragment,e),n=!1},d(e){e&&E(t),i&&_e(i,e)}}}function Ni(e){let t,n,o,a,i,r,s,c,d,l=(e.pathParts[2]||e.pathParts[1]||Vt("Notifications"))+"",u=Jt(e.connection,e.dialog)+"";const f=new it({props:{name:e.dialog.connection_id?"sliders-h":"bell"}});return{c(){t=C("h1"),n=C("a"),ve(f.$$.fragment),o=C("span"),a=N(l),r=S(),s=C("i"),c=N(u),R(n,"href",i="#activeMenu:"+(e.dialog.connection_id?"settings":"")),R(s,"class","chat-header__topic")},m(e,i){k(e,t,i),x(t,n),ye(f,n,null),x(n,o),x(o,a),k(e,r,i),k(e,s,i),x(s,c),d=!0},p(e,t){const o={};e.dialog&&(o.name=t.dialog.connection_id?"sliders-h":"bell"),f.$set(o),d&&!e.pathParts||l===(l=(t.pathParts[2]||t.pathParts[1]||Vt("Notifications"))+"")||A(a,l),(!d||e.dialog&&i!==(i="#activeMenu:"+(t.dialog.connection_id?"settings":"")))&&R(n,"href",i),d&&!e.connection&&!e.dialog||u===(u=Jt(t.connection,t.dialog)+"")||A(c,u)},i(e){d||(pe(f.$$.fragment,e),d=!0)},o(e){ge(f.$$.fragment,e),d=!1},d(e){e&&E(t),_e(f),e&&E(r),e&&E(s)}}}function Si(e){let t;const n=new Ko({props:{connection:e.connection,dialog:e.dialog,input:e.chatInput}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.connection&&(o.connection=t.connection),e.dialog&&(o.dialog=t.dialog),e.chatInput&&(o.input=t.chatInput),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Di(e){let t,n,o,a,i,r,s,c,d,l,u,f,p=Vt('Do you want to chat with "%1"?',e.pathParts[2])+"",g=Vt("Yes")+"";const m=new kt({props:{href:"/chat",class:"btn",$$slots:{default:[Mi]},$$scope:{ctx:e}}});return{c(){(t=C("h2")).textContent=`${Vt("You are not part of this conversation.")}`,n=S(),o=C("p"),a=N(p),i=S(),r=C("p"),s=C("a"),c=N(g),l=S(),ve(m.$$.fragment),R(s,"href",d="#add:"+e.pathParts[2]),R(s,"class","btn"),f=P(s,"click",M(e.addDialog))},m(e,d){k(e,t,d),k(e,n,d),k(e,o,d),x(o,a),k(e,i,d),k(e,r,d),x(r,s),x(s,c),x(r,l),ye(m,r,null),u=!0},p(e,t){u&&!e.pathParts||p===(p=Vt('Do you want to chat with "%1"?',t.pathParts[2])+"")||A(a,p),(!u||e.pathParts&&d!==(d="#add:"+t.pathParts[2]))&&R(s,"href",d);const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),m.$set(n)},i(e){u||(pe(m.$$.fragment,e),u=!0)},o(e){ge(m.$$.fragment,e),u=!1},d(e){e&&E(t),e&&E(n),e&&E(o),e&&E(i),e&&E(r),_e(m),f()}}}function Pi(e){let t,n,o,a,i,r,s,c,d=Vt('Do you want to create the connection "%1"?',e.pathParts[1])+"";const l=new kt({props:{href:"/add/connection?server="+encodeURIComponent(e.pathParts[1])+"&dialog="+encodeURIComponent(e.pathParts[2]),class:"btn",$$slots:{default:[Ri]},$$scope:{ctx:e}}}),u=new kt({props:{href:"/chat",class:"btn",$$slots:{default:[Ai]},$$scope:{ctx:e}}});return{c(){(t=C("h2")).textContent=`${Vt("Connection does not exist.")}`,n=S(),o=C("p"),a=N(d),i=S(),r=C("p"),ve(l.$$.fragment),s=S(),ve(u.$$.fragment)},m(e,d){k(e,t,d),k(e,n,d),k(e,o,d),x(o,a),k(e,i,d),k(e,r,d),ye(l,r,null),x(r,s),ye(u,r,null),c=!0},p(e,t){c&&!e.pathParts||d===(d=Vt('Do you want to create the connection "%1"?',t.pathParts[1])+"")||A(a,d);const n={};e.pathParts&&(n.href="/add/connection?server="+encodeURIComponent(t.pathParts[1])+"&dialog="+encodeURIComponent(t.pathParts[2])),e.$$scope&&(n.$$scope={changed:e,ctx:t}),l.$set(n);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),u.$set(o)},i(e){c||(pe(l.$$.fragment,e),pe(u.$$.fragment,e),c=!0)},o(e){ge(l.$$.fragment,e),ge(u.$$.fragment,e),c=!1},d(e){e&&E(t),e&&E(n),e&&E(o),e&&E(i),e&&E(r),_e(l),_e(u)}}}function Mi(t){let n,o=Vt("No")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ri(t){let n,o=Vt("Yes")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ai(t){let n,o=Vt("No")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ti(e){let t,n={dialog:e.dialog};const o=new xo({props:n});return e.chatinput_binding(o),{c(){ve(o.$$.fragment)},m(e,n){ye(o,e,n),t=!0},p(e,t){const n={};e.dialog&&(n.dialog=t.dialog),o.$set(n)},i(e){t||(pe(o.$$.fragment,e),t=!0)},o(e){ge(o.$$.fragment,e),t=!1},d(t){e.chatinput_binding(null),_e(o,t)}}}function Li(e){let t,n,o,a,i,r,s,c,d=Vt("Participants (%1)",e.dialog.participants().length)+"",l=e.dialog.participants(),u=[];for(let t=0;t<l.length;t+=1)u[t]=Ii(Oi(e,l,t));const f=e=>ge(u[e],1,1,()=>{u[e]=null});return{c(){t=C("div"),n=C("nav"),o=C("h3"),a=N(d),i=S();for(let e=0;e<u.length;e+=1)u[e].c();r=S(),s=C("nav"),R(n,"class","sidebar-right__nav"),R(t,"class","sidebar-right")},m(e,d){k(e,t,d),x(t,n),x(n,o),x(o,a),x(n,i);for(let e=0;e<u.length;e+=1)u[e].m(n,null);x(n,r),x(n,s),c=!0},p(e,t){if(c&&!e.dialog||d===(d=Vt("Participants (%1)",t.dialog.participants().length)+"")||A(a,d),e.dialog||e.modeClassNames){let o;for(l=t.dialog.participants(),o=0;o<l.length;o+=1){const a=Oi(t,l,o);u[o]?(u[o].p(e,a),pe(u[o],1)):(u[o]=Ii(a),u[o].c(),pe(u[o],1),u[o].m(n,r))}for(ue(),o=l.length;o<u.length;o+=1)f(o);fe()}},i(e){if(!c){for(let e=0;e<l.length;e+=1)pe(u[e]);c=!0}},o(e){u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)ge(u[e]);c=!1},d(e){e&&E(t),O(u,e)}}}function ji(e){let t,n,o,a,i=e.participant.nick+"";const r=new it({props:{name:"pick:"+e.participant.id,family:"solid",color:e.participant.color}});return{c(){ve(r.$$.fragment),t=S(),n=C("span"),o=N(i)},m(e,i){ye(r,e,i),k(e,t,i),k(e,n,i),x(n,o),a=!0},p(e,t){const n={};e.dialog&&(n.name="pick:"+t.participant.id),e.dialog&&(n.color=t.participant.color),r.$set(n),a&&!e.dialog||i===(i=t.participant.nick+"")||A(o,i)},i(e){a||(pe(r.$$.fragment,e),a=!0)},o(e){ge(r.$$.fragment,e),a=!1},d(e){_e(r,e),e&&E(t),e&&E(n)}}}function Ii(e){let t;const n=new kt({props:{href:"/chat/"+e.dialog.connection_id+"/"+e.participant.id,class:"participant "+Ge(e.participant.modes),$$slots:{default:[ji]},$$scope:{ctx:e}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.dialog&&(o.href="/chat/"+t.dialog.connection_id+"/"+t.participant.id),e.dialog&&(o.class="participant "+Ge(t.participant.modes)),(e.$$scope||e.dialog)&&(o.$$scope={changed:e,ctx:t}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Ui(e){let t,n,o,a,r,s,c,d,l,u,f,p,g=e.dialog.participants().length;ae(e.onwindowresize);let m="settings"==e.$activeMenu&&Ci(e);const h=new ho({props:{$$slots:{default:[Ni]},$$scope:{ctx:e}}}),$=[Pi,Di,Si],b=[];function v(e,t){return t.pathParts[1]&&!t.connection.connection_id?0:t.pathParts[2]&&!t.dialog.connection_id?1:2}r=v(0,e),s=b[r]=$[r](e);let y=e.dialog.connection_id&&Ti(e),_=g&&Li(e);return{c(){m&&m.c(),t=S(),ve(h.$$.fragment),n=S(),o=C("main"),a=C("div"),s.c(),d=S(),y&&y.c(),l=S(),_&&_.c(),u=D(),R(a,"class","messages-container"),ae(()=>e.div_resize_handler.call(a)),j(a,"has-notifications",1==e.pathParts.length),R(o,"class","main"),p=[P(window,"resize",e.onwindowresize),P(o,"scroll",e.onScroll)]},m(i,s){m&&m.m(i,s),k(i,t,s),ye(h,i,s),k(i,n,s),k(i,o,s),x(o,a),b[r].m(a,null),c=function(e,t){"static"===getComputedStyle(e).position&&(e.style.position="relative");const n=document.createElement("object");let o;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{(o=n.contentDocument.defaultView).addEventListener("resize",t)},/Trident/.test(navigator.userAgent)?(e.appendChild(n),n.data="about:blank"):(n.data="about:blank",e.appendChild(n)),{cancel:()=>{o&&o.removeEventListener&&o.removeEventListener("resize",t),e.removeChild(n)}}}(a,e.div_resize_handler.bind(a)),e.main_binding(o),k(i,d,s),y&&y.m(i,s),k(i,l,s),_&&_.m(i,s),k(i,u,s),f=!0},p(e,n){"settings"==n.$activeMenu?m?(m.p(e,n),pe(m,1)):((m=Ci(n)).c(),pe(m,1),m.m(t.parentNode,t)):m&&(ue(),ge(m,1,1,()=>{m=null}),fe());const o={};(e.$$scope||e.connection||e.dialog||e.pathParts)&&(o.$$scope={changed:e,ctx:n}),h.$set(o);let i=r;(r=v(0,n))===i?b[r].p(e,n):(ue(),ge(b[i],1,1,()=>{b[i]=null}),fe(),(s=b[r])||(s=b[r]=$[r](n)).c(),pe(s,1),s.m(a,null)),e.pathParts&&j(a,"has-notifications",1==n.pathParts.length),n.dialog.connection_id?y?(y.p(e,n),pe(y,1)):((y=Ti(n)).c(),pe(y,1),y.m(l.parentNode,l)):y&&(ue(),ge(y,1,1,()=>{y=null}),fe()),e.dialog&&(g=n.dialog.participants().length),g?_?(_.p(e,n),pe(_,1)):((_=Li(n)).c(),pe(_,1),_.m(u.parentNode,u)):_&&(ue(),ge(_,1,1,()=>{_=null}),fe())},i(e){f||(pe(m),pe(h.$$.fragment,e),pe(s),pe(y),pe(_),f=!0)},o(e){ge(m),ge(h.$$.fragment,e),ge(s),ge(y),ge(_),f=!1},d(a){m&&m.d(a),a&&E(t),_e(h,a),a&&E(n),a&&E(o),b[r].d(),c.cancel(),e.main_binding(null),a&&E(d),y&&y.d(a),a&&E(l),_&&_.d(a),a&&E(u),i(p)}}}function zi(e,t,n){let o,a,i,r;l(e,ft,e=>n("$currentUrl",o=e)),l(e,lt,e=>n("$activeMenu",i=e)),l(e,ut,e=>n("$container",r=e));const s=Z("user");let c,d;l(e,s,e=>n("$user",a=e));let u,f=null,p=0,g=0,m=0,h="bottom",$={},b=s.notifications,v="",y=o.pathParts,_=[];var w;function x(e,t){n("pathParts",y=t.pathParts);const o=e.findDialog({connection_id:y[1]})||{};o!=$&&function(e){if(!e.url)return;const t=e.url.protocol.replace(/:$/,"");navigator.registerProtocolHandler&&navigator.registerProtocolHandler(t,ft.base+"/register?uri=%s","Convos "+t+" handler")}(n("connection",$=o));const a=1==y.length?e.notifications:e.findDialog({connection_id:y[1],dialog_id:y[2]});if(!a)return n("dialog",b=e.notifications);a==b&&v||(v&&E(),We(document,".message__embed",e=>e.remove()),n("dialog",b=a),m=0,v=t.path,h="bottom",n("settingsComponent",f=b.connection_id?b.dialog_id?Ei:oi:null),_=[],$.subscribe&&_.push($.subscribe(e=>{n("connection",$=e)})),b.subscribe&&_.push(b.subscribe(e=>{n("dialog",b=e)})),b.connection_id?b.is("pending")&&b.load({before:b.messages[0]}):b.load({}))}function k(e,t){e.forEach(e=>{if(!e.isIntersecting)return;const t=b.messages[e.target.dataset.index]||{};t.embeds&&s.embedMaker.render(e.target,t.embeds)})}function E(){b&&b.setLastRead&&b.setLastRead(),_.forEach(e=>e())}w=()=>{u=u||new IntersectionObserver(k,{rootMargin:"0px"}),We(document,".message",e=>{e.classList.contains("is-observed")||u.observe(e),e.classList.add("is-observed")}),"bottom"==h?n("messagesEl",d.scrollTop=g,d):m&&m<g&&(n("messagesEl",d.scrollTop=g-m,d),"top"!=h&&(m=0))},K().$$.after_update.push(w),function(e){K().$$.on_destroy.push(e)}(E);const O=He(e=>{if(!d||!b.connection_id)return;const t=d.offsetHeight,n=d.scrollTop;"top"!=(h=t>g||n+20>g-t?"bottom":n<100?"top":"middle")||b.is("loading")||(b.messages.length&&b.load({before:b.messages[0]}),m=g)},20);return e.$$.update=(e={$user:1,$currentUrl:1})=>{(e.$user||e.$currentUrl)&&x(a,o)},{user:s,chatInput:c,messagesEl:d,settingsComponent:f,containerHeight:p,messagesHeight:g,connection:$,dialog:b,pathParts:y,addDialog:function(e){$.connection_id&&$.addDialog(e.target.closest("a").href.replace(/.*#add:/,""))},onScroll:O,$activeMenu:i,$container:r,onwindowresize:function(){n("containerHeight",p=window.innerHeight)},div_resize_handler:function(){g=this.offsetHeight,n("messagesHeight",g)},main_binding:function(e){J[e?"unshift":"push"](()=>{n("messagesEl",d=e)})},chatinput_binding:function(e){J[e?"unshift":"push"](()=>{n("chatInput",c=e)})}}}class Bi extends xe{constructor(e){super(),we(this,e,zi,Ui,s,{})}}function Hi(t){let n;return{c(){(n=C("h1")).textContent=`${Vt("Add connection")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function qi(e){let t,n,o;const a=new ho({props:{$$slots:{default:[Hi]},$$scope:{ctx:e}}}),i=new Ya({});return{c(){ve(a.$$.fragment),t=S(),n=C("main"),ve(i.$$.fragment),R(n,"class","main")},m(e,r){ye(a,e,r),k(e,t,r),k(e,n,r),ye(i,n,null),o=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),a.$set(n)},i(e){o||(pe(a.$$.fragment,e),pe(i.$$.fragment,e),o=!0)},o(e){ge(a.$$.fragment,e),ge(i.$$.fragment,e),o=!1},d(e){_e(a,e),e&&E(t),e&&E(n),_e(i)}}}class Fi extends xe{constructor(e){super(),we(this,e,null,qi,s,{})}}function Ki(e,t,n){const o=Object.create(e);return o.opt=t[n],o.i=n,o}const Gi=()=>({}),Wi=()=>({});function Zi(e){let t,n,o,a,r=(e.opt.length>1?e.opt[1]:e.opt[0])+"";function s(...t){return e.mouseover_handler(e,...t)}return{c(){t=C("a"),n=N(r),R(t,"href",o="#"+e.i+":"+e.opt[0]),R(t,"tabindex","-1"),j(t,"is-active",e.i==e.activeIndex),a=[P(t,"click",e.selectOption),P(t,"mouseover",s)]},m(e,o){k(e,t,o),x(t,n)},p(a,i){e=i,a.visibleOptions&&r!==(r=(e.opt.length>1?e.opt[1]:e.opt[0])+"")&&A(n,r),a.visibleOptions&&o!==(o="#"+e.i+":"+e.opt[0])&&R(t,"href",o),a.activeIndex&&j(t,"is-active",e.i==e.activeIndex)},d(e){e&&E(t),i(a)}}}function Vi(e){let t,n,o,a,r,s,c,d,l,g,m;const h=e.$$slots.label,$=u(h,e,Wi);let b=e.visibleOptions,v=[];for(let t=0;t<b.length;t+=1)v[t]=Zi(Ki(e,b,t));return{c(){t=C("div"),n=C("label"),$||(o=N("Label")),$&&$.c(),a=S(),r=C("input"),s=S(),c=C("input"),d=S(),l=C("div");for(let e=0;e<v.length;e+=1)v[e].c();R(n,"for",e.id),R(r,"type","hidden"),R(r,"name",e.name),R(c,"type","text"),R(c,"placeholder",e.placeholder),R(c,"id",e.id),c.readOnly=e.readonly,R(c,"autocomplete","off"),R(l,"class","select-field__options"),R(t,"class","select-field text-field"),t.hidden=e.hidden,j(t,"is-open",e.open),m=[P(r,"input",e.input0_input_handler),P(r,"keydown",e.keydown),P(c,"keydown",e.keydown),P(c,"keyup",e.keyup),P(t,"click",M(e.toggle))]},m(i,u){k(i,t,u),x(t,n),$||x(n,o),$&&$.m(n,null),x(t,a),x(t,r),T(r,e.value),e.input0_binding(r),x(t,s),x(t,c),e.input1_binding(c),x(t,d),x(t,l);for(let e=0;e<v.length;e+=1)v[e].m(l,null);e.div1_binding(t),g=!0},p(e,o){if($&&$.p&&e.$$scope&&$.p(p(h,o,e,Gi),f(h,o,Wi)),g&&!e.id||R(n,"for",o.id),g&&!e.name||R(r,"name",o.name),e.value&&T(r,o.value),g&&!e.placeholder||R(c,"placeholder",o.placeholder),g&&!e.id||R(c,"id",o.id),g&&!e.readonly||(c.readOnly=o.readonly),e.visibleOptions||e.activeIndex||e.selectOption){let t;for(b=o.visibleOptions,t=0;t<b.length;t+=1){const n=Ki(o,b,t);v[t]?v[t].p(e,n):(v[t]=Zi(n),v[t].c(),v[t].m(l,null))}for(;t<v.length;t+=1)v[t].d(1);v.length=b.length}g&&!e.hidden||(t.hidden=o.hidden),e.open&&j(t,"is-open",o.open)},i(e){g||(pe($,e),g=!0)},o(e){ge($,e),g=!1},d(n){n&&E(t),$&&$.d(n),e.input0_binding(null),e.input1_binding(null),O(v,n),e.div1_binding(null),i(m)}}}function Yi(e,t,n){const o=["ArrowDown","ArrowUp","Enter"];let a,i,r,s=0,c=!1,d="",{hidden:l=!1}=t,{name:u=""}=t,{id:f=(u?"form_"+u:Xe())}=t,{options:p=[]}=t,{placeholder:g=""}=t,{readonly:m=!1}=t,{value:h=""}=t;async function $(e){let t;if("keydown"==e.type)t=y.length?y[s]:[];else{const n=e.target.href.replace(/^.*?#\d+:/,"");t=y.filter(e=>e[0]==n)[0]||[]}t.length||(t=[""]),n("value",h=t[0]),n("humanEl",i.value=t.length>1?t[1]:t[0],i),await(oe(),ee),i.setSelectionRange(0,9999),n("open",c=!1)}G(()=>{i.addEventListener("blur",()=>setTimeout(()=>{n("open",c=!1)},100)),n("value",h=a.value)});let{$$slots:b={},$$scope:v}=t;let y;return e.$set=e=>{"hidden"in e&&n("hidden",l=e.hidden),"name"in e&&n("name",u=e.name),"id"in e&&n("id",f=e.id),"options"in e&&n("options",p=e.options),"placeholder"in e&&n("placeholder",g=e.placeholder),"readonly"in e&&n("readonly",m=e.readonly),"value"in e&&n("value",h=e.value),"$$scope"in e&&n("$$scope",v=e.$$scope)},e.$$.update=(e={open:1,options:1,typed:1,hiddenEl:1,humanEl:1})=>{if(e.open&&0==c&&n("typed",d=""),(e.options||e.typed)&&n("visibleOptions",y=function(e,t){let n=new RegExp("(?:^|\\s|-)"+Ze(t),"i"),o=[];o.length||(o=e.filter(e=>e[0]==t)),o.length||(o=e.filter(e=>e[0].match(n)));for(let t=0;t<e.length;t++){const a=e[t];a.length>1&&-1!=o.indexOf(a)&&a[1].match(n)&&-1==e.map(e=>e[0]).indexOf(a[0])&&e.push(a)}return e}(p,d)),e.open&&1==c&&n("activeIndex",s=0),e.hiddenEl&&a&&!a.syncValue&&(n("hiddenEl",a.syncValue=function(){n("value",h=this.value)},a),a.syncValue()),(e.humanEl||e.options||e.hiddenEl)&&i&&!i.value&&i!=document.activeElement){const e=p.find(e=>e[0]==a.value);e&&n("humanEl",i.value=e[1]||e[0],i)}},{activeIndex:s,hiddenEl:a,humanEl:i,open:c,wrapperEl:r,hidden:l,name:u,id:f,options:p,placeholder:g,readonly:m,value:h,keydown:function(e){-1!=o.indexOf(e.key)&&e.preventDefault(),"Tab"!=e.key?c?("ArrowDown"==e.key&&n("activeIndex",s++,s),"ArrowUp"==e.key&&n("activeIndex",s--,s),"Enter"==e.key&&$(e),s>=p.length&&n("activeIndex",s=0),s<0&&n("activeIndex",s=p.length-1)):n("open",c=!0):c&&$(e)},keyup:function(e){1!=e.key.length&&"Backspace"!=e.key||n("typed",d=i.value)},selectOption:$,toggle:function(){n("open",c=!c)},visibleOptions:y,input0_input_handler:function(){h=this.value,n("value",h),n("hiddenEl",a)},input0_binding:function(e){J[e?"unshift":"push"](()=>{n("hiddenEl",a=e)})},input1_binding:function(e){J[e?"unshift":"push"](()=>{n("humanEl",i=e)})},mouseover_handler:({i:e})=>{n("activeIndex",s=e)},div1_binding:function(e){J[e?"unshift":"push"](()=>{n("wrapperEl",r=e)})},$$slots:b,$$scope:v}}class Ji extends xe{constructor(e){super(),we(this,e,Yi,Vi,s,{hidden:0,name:0,id:0,options:0,placeholder:0,readonly:0,value:0})}}function Qi(e,t,n){const o=Object.create(e);return o.dialog=t[n],o}function Xi(t){let n;return{c(){(n=C("h1")).textContent=`${Vt("Add conversation")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function er(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Connection")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function tr(t){return{c:e,m:e,p:e,d:e}}function nr(e){let t,n=Vt(e.availableDialogs.dialogs.length?"Refresh":"Load")+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.availableDialogs&&n!==(n=Vt(o.availableDialogs.dialogs.length?"Refresh":"Load")+"")&&A(t,n)},d(e){e&&E(t)}}}function or(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Conversation name")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ar(t){return{c:e,m:e,p:e,d:e}}function ir(t){let n,o=Vt("Add")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function rr(e){let t,n,o,a,i=e.availableDialogs.error+"";return{c(){t=C("p"),n=N(e.connectionId),o=N(": "),a=N(i),R(t,"class","error")},m(e,i){k(e,t,i),x(t,n),x(t,o),x(t,a)},p(e,t){e.connectionId&&A(n,t.connectionId),e.availableDialogs&&i!==(i=t.availableDialogs.error+"")&&A(a,i)},d(e){e&&E(t)}}}function sr(e){let t,n,o;function a(e,t){return t.availableDialogs.done?dr:cr}let i=a(0,e),r=i(e),s=e.availableDialogs.dialogs,c=[];for(let t=0;t<s.length;t+=1)c[t]=lr(Qi(e,s,t));return{c(){t=C("p"),r.c(),n=S(),o=C("div");for(let e=0;e<c.length;e+=1)c[e].c();R(o,"class","dialog-add-list")},m(e,a){k(e,t,a),r.m(t,null),k(e,n,a),k(e,o,a);for(let e=0;e<c.length;e+=1)c[e].m(o,null)},p(e,n){if(i===(i=a(0,n))&&r?r.p(e,n):(r.d(1),(r=i(n))&&(r.c(),r.m(t,null))),e.availableDialogs||e.addDialog){let t;for(s=n.availableDialogs.dialogs,t=0;t<s.length;t+=1){const a=Qi(n,s,t);c[t]?c[t].p(e,a):(c[t]=lr(a),c[t].c(),c[t].m(o,null))}for(;t<c.length;t+=1)c[t].d(1);c.length=s.length}},d(e){e&&E(t),r.d(),e&&E(n),e&&E(o),O(c,e)}}}function cr(e){let t,n=Vt("Showing %1 of %2 conversations, but the list is still loading.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.availableDialogs&&n!==(n=Vt("Showing %1 of %2 conversations, but the list is still loading.",o.availableDialogs.dialogs.length,o.availableDialogs.n_dialogs)+"")&&A(t,n)},d(e){e&&E(t)}}}function dr(e){let t,n=Vt("Showing %1 of %2 conversations.",e.availableDialogs.dialogs.length,e.availableDialogs.n_dialogs)+"";return{c(){t=N(n)},m(e,n){k(e,t,n)},p(e,o){e.availableDialogs&&n!==(n=Vt("Showing %1 of %2 conversations.",o.availableDialogs.dialogs.length,o.availableDialogs.n_dialogs)+"")&&A(t,n)},d(e){e&&E(t)}}}function lr(e){let t,n,o,a,i,r,s,c,d,l,u,f,p=e.dialog.n_users+"",g=e.dialog.name+"",m=(e.dialog.topic||"No topic.")+"";return{c(){t=C("a"),n=C("span"),o=N(p),a=S(),i=C("b"),r=N(g),s=S(),c=C("i"),d=N(m),l=S(),R(n,"class","dialog-add-list__n-users"),R(i,"class","dialog-add-list__name"),R(c,"class","dialog-add-list__title"),R(t,"href",u="#add:"+e.dialog.name),f=P(t,"click",M(e.addDialog))},m(e,u){k(e,t,u),x(t,n),x(n,o),x(t,a),x(t,i),x(i,r),x(t,s),x(t,c),x(c,d),x(t,l)},p(e,n){e.availableDialogs&&p!==(p=n.dialog.n_users+"")&&A(o,p),e.availableDialogs&&g!==(g=n.dialog.name+"")&&A(r,g),e.availableDialogs&&m!==(m=(n.dialog.topic||"No topic.")+"")&&A(d,m),e.availableDialogs&&u!==(u="#add:"+n.dialog.name)&&R(t,"href",u)},d(e){e&&E(t),f()}}}function ur(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m,h;const $=new ho({props:{$$slots:{default:[Xi]},$$scope:{ctx:e}}});function b(t){e.selectfield_value_binding.call(null,t)}let v={name:"connection_id",options:e.connectionOptions,placeholder:Vt("Select..."),$$slots:{default:[tr],label:[er]},$$scope:{ctx:e}};void 0!==e.connectionId&&(v.value=e.connectionId);const y=new Ji({props:v});J.push(()=>be(y,"value",b));const _=new Vo({props:{type:"button",icon:"sync-alt",disabled:!e.connectionId||!1===e.availableDialogs.done,$$slots:{default:[nr]},$$scope:{ctx:e}}});function w(t){e.textfield_value_binding.call(null,t)}_.$on("click",e.loadConversations);let O={name:"dialog_id",placeholder:Vt("#room or nick"),autocomplete:"off",$$slots:{default:[ar],label:[or]},$$scope:{ctx:e}};void 0!==e.dialogId&&(O.value=e.dialogId);const N=new Pt({props:O});J.push(()=>be(N,"value",w)),N.$on("keyup",e.debouncedLoadConversations);const D=new Vo({props:{icon:"comment",disabled:!e.connectionId||!e.dialogId,$$slots:{default:[ir]},$$scope:{ctx:e}}});let A=e.availableDialogs.error&&rr(e),T=null!==e.availableDialogs.done&&sr(e);return{c(){ve($.$$.fragment),t=S(),n=C("main"),(o=C("p")).textContent=`${Vt("Enter the name of an exising conversation, or create a new conversation.")} \n    ${Vt("It is also possible to load in all existing conversations for a given connection.")}`,a=S(),i=C("form"),r=C("div"),ve(y.$$.fragment),c=S(),ve(_.$$.fragment),d=S(),l=C("div"),ve(N.$$.fragment),f=S(),ve(D.$$.fragment),p=S(),A&&A.c(),g=S(),T&&T.c(),R(r,"class","inputs-side-by-side"),R(l,"class","inputs-side-by-side"),R(i,"method","post"),R(n,"class","main"),h=P(i,"submit",M(e.addDialog))},m(s,u){ye($,s,u),k(s,t,u),k(s,n,u),x(n,o),x(n,a),x(n,i),x(i,r),ye(y,r,null),x(r,c),ye(_,r,null),x(i,d),x(i,l),ye(N,l,null),x(l,f),ye(D,l,null),x(i,p),A&&A.m(i,null),x(i,g),T&&T.m(i,null),e.form_binding(i),m=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),$.$set(n);const o={};e.connectionOptions&&(o.options=t.connectionOptions),e.$$scope&&(o.$$scope={changed:e,ctx:t}),!s&&e.connectionId&&(s=!0,o.value=t.connectionId,ie(()=>s=!1)),y.$set(o);const a={};(e.connectionId||e.availableDialogs)&&(a.disabled=!t.connectionId||!1===t.availableDialogs.done),(e.$$scope||e.availableDialogs)&&(a.$$scope={changed:e,ctx:t}),_.$set(a);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:t}),!u&&e.dialogId&&(u=!0,r.value=t.dialogId,ie(()=>u=!1)),N.$set(r);const c={};(e.connectionId||e.dialogId)&&(c.disabled=!t.connectionId||!t.dialogId),e.$$scope&&(c.$$scope={changed:e,ctx:t}),D.$set(c),t.availableDialogs.error?A?A.p(e,t):((A=rr(t)).c(),A.m(i,g)):A&&(A.d(1),A=null),null!==t.availableDialogs.done?T?T.p(e,t):((T=sr(t)).c(),T.m(i,null)):T&&(T.d(1),T=null)},i(e){m||(pe($.$$.fragment,e),pe(y.$$.fragment,e),pe(_.$$.fragment,e),pe(N.$$.fragment,e),pe(D.$$.fragment,e),m=!0)},o(e){ge($.$$.fragment,e),ge(y.$$.fragment,e),ge(_.$$.fragment,e),ge(N.$$.fragment,e),ge(D.$$.fragment,e),m=!1},d(o){_e($,o),o&&E(t),o&&E(n),_e(y),_e(_),_e(N),_e(D),A&&A.d(),T&&T.d(),e.form_binding(null),h()}}}function fr(e,t,n){let o;const a=Z("user");l(e,a,e=>n("$user",o=e));let i,r,s={dialogs:[],done:null,n_dialogs:0},c="",d="";function u(e){let t="/list"+(d.length?" /"+d+"/":"");"click"==e.type&&s.done&&(t+=" refresh"),r&&clearTimeout(r),a.send({connection_id:c,message:t},t=>{const o=Fe(t);n("availableDialogs",s=o?{dialogs:[],done:!0,n_dialogs:0,error:o}:t);let a=e.interval?e.interval+500:500;a>2e3&&(a=2e3),o||t.done||(r=setTimeout(()=>u({interval:a}),a))})}G(()=>_t(i));const f=He(u,250);let p;return e.$$.update=(e={$user:1,connectionId:1,connectionOptions:1})=>{e.$user&&n("connectionOptions",p=Array.from(o.connections.keys()).map(e=>[e])),(e.connectionId||e.connectionOptions)&&(c||n("connectionId",c=p[0]?p[0][0]:""))},{user:a,availableDialogs:s,connectionId:c,dialogId:d,formEl:i,addDialog:function(e){const t=e&&e.target&&e.target.closest("a");t&&t.href&&n("dialogId",d=t.href.replace(/.*#add:/,"")),c&&d&&a.findDialog({connection_id:c}).addDialog(d)},loadConversations:u,debouncedLoadConversations:f,connectionOptions:p,selectfield_value_binding:function(e){n("connectionId",c=e),n("connectionOptions",p),n("$user",o)},textfield_value_binding:function(e){n("dialogId",d=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{n("formEl",i=e)})}}}class pr extends xe{constructor(e){super(),we(this,e,fr,ur,s,{})}}function gr(t){let n,o,a,i,r,s,c,d,l=Vt("This should not happen.")+"";return{c(){n=C("p"),o=N(l),a=N("\n        Please submit "),(i=C("a")).textContent="an issue",r=N(",\n        if the problem does not go away."),s=S(),c=C("p"),(d=C("a")).textContent=`${Vt("Go to landing page")}`,R(i,"href","https://github.com/Nordaaker/convos/issues/"),R(d,"href","/"),R(d,"class","btn")},m(e,t){k(e,n,t),x(n,o),x(n,a),x(n,i),x(n,r),k(e,s,t),k(e,c,t),x(c,d)},p:e,d(e){e&&E(n),e&&E(s),e&&E(c)}}}function mr(t){let n,o,a,i;return{c(){(n=C("p")).textContent=`${Vt("Could not find the page you are looking for. Maybe you entered an invalid URL?")}`,o=S(),a=C("p"),(i=C("a")).textContent=`${Vt("Go to landing page")}`,R(i,"href","/"),R(i,"class","btn")},m(e,t){k(e,n,t),k(e,o,t),k(e,a,t),x(a,i)},p:e,d(e){e&&E(n),e&&E(o),e&&E(a)}}}function hr(t){let n,o,a,i=Vt("Starting Convos...")+"";return{c(){n=C("i"),o=S(),a=N(i),R(n,"class","fas fa-spinner fa-spin")},m(e,t){k(e,n,t),k(e,o,t),k(e,a,t)},p:e,d(e){e&&E(n),e&&E(o),e&&E(a)}}}function $r(t){let n,o,a,i,r,s,c,d=Vt("You seem to have lost connection to the internet.")+"";return{c(){n=C("p"),o=C("i"),a=S(),i=N(d),r=S(),s=C("p"),(c=C("a")).textContent=`${Vt("Reload")}`,R(o,"class","fas fa-exclamation-triangle"),R(c,"href","/"),R(c,"class","btn")},m(e,t){k(e,n,t),x(n,o),x(n,a),x(n,i),k(e,r,t),k(e,s,t),x(s,c)},p:e,d(e){e&&E(n),e&&E(r),e&&E(s)}}}function br(t){let n,o,a,i,r,s=Vt(t.messages[t.status])+"";function c(e,t){return"offline"==t.status?$r:"loading"==t.status?hr:"not_found"==t.status?mr:gr}let d=c(0,t),l=d(t);return{c(){n=C("main"),o=C("div"),a=C("h2"),i=N(s),r=S(),l.c(),R(n,"class","main align-content-middle")},m(e,t){k(e,n,t),x(n,o),x(o,a),x(a,i),x(o,r),l.m(o,null)},p(e,t){e.status&&s!==(s=Vt(t.messages[t.status])+"")&&A(i,s),d===(d=c(0,t))&&l?l.p(e,t):(l.d(1),(l=d(t))&&(l.c(),l.m(o,null)))},i:e,o:e,d(e){e&&E(n),l.d()}}}function vr(e,t,n){let o;const a=Z("settings"),i=Z("user");l(e,i,e=>n("$user",o=e));const r=a.load_user?["loading","pending"]:["loading"];let s;return G(()=>{Ve("body",/(is-logged-)\S+/,"out"),Ve("body",/(page-)\S+/,s)}),e.$$.update=(e={$user:1})=>{e.$user&&n("status",s=o.is("offline")?"offline":o.is(r)?"loading":"not_found")},{user:i,messages:{loading:"Loading",not_found:"Not found",offline:"You appear to be offline"},status:s}}class yr extends xe{constructor(e){super(),we(this,e,vr,br,s,{})}}const{Object:_r}=$e;function wr(e,t,n){const o=_r.create(e);return o.command=t[n],o}function xr(t){let n,o;return{c(){(n=C("h1")).textContent=`${Vt("Help")}`,(o=C("small")).textContent=`v${t.settings.version}`},m(e,t){k(e,n,t),k(e,o,t)},p:e,d(e){e&&E(n),e&&E(o)}}}function kr(t){let n,o,a,i,r=t.command.example+"",s=Vt(t.command.description)+"";return{c(){n=C("dt"),o=N(r),a=C("dd"),i=N(s)},m(e,t){k(e,n,t),x(n,o),k(e,a,t),x(a,i)},p:e,d(e){e&&E(n),e&&E(a)}}}function Er(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m,h,$,b,v,y,_,w,N,D,P,M,A,T,L,j,U,z,B,H,q,F,K,G,W,Z,V,Y,J,Q,X,ee,te,ne,oe,ae,ie,re,se,ce,de,le,ue,fe,me,he,$e,be=Yt('Got any questions? Come and talk to us in the "#convos" channel on https://freenode.net.')+"",we=Yt("More information can also be found on https://convos.by.")+"",xe=Yt('Using "_" around some text, will convert it into _italic_, __bold__ or ___italic bold___.')+"",ke=Yt("Using backticks around some text, will format it as a `code fragment`.")+"";const Ee=new ho({props:{$$slots:{default:[xr]},$$scope:{ctx:e}}});let Oe=$o,Ce=[];for(let t=0;t<Oe.length;t+=1)Ce[t]=kr(wr(e,Oe,t));return{c(){ve(Ee.$$.fragment),t=S(),n=C("main"),o=C("p"),i=S(),s=S(),(c=C("h2")).textContent=`${Vt("Shortcuts")}`,d=S(),l=C("dl"),(u=C("dt")).textContent=`${Vt("shift+enter")}`,(f=C("dd")).textContent=`${Vt("Shift focus between chat input and search in sidebar.")}`,(p=C("dt")).textContent=`${Vt("Getting to conversation or connection settings")}`,(g=C("dd")).textContent=`${Vt("Clicking on the icon next to the conversation name will take you to settings.")}`,m=S(),(h=C("h2")).textContent=`${Vt("Autocomplete")}`,$=S(),(b=C("p")).textContent=`${Vt("The following rules apply when typing a message:")}`,v=S(),y=C("dl"),(_=C("dt")).textContent="@nick",(w=C("dd")).textContent=`${Vt('"@" followed by a character will show matching nicks in the current conversation.')}`,(N=C("dt")).textContent=":emoji_name",(D=C("dd")).textContent=`${Vt('":" followed by a character will show matching emojis.')}`,(P=C("dt")).textContent="/command",(M=C("dd")).textContent=`${Vt('"/" will show the available commands.')}`,(A=C("dt")).textContent="#conversation",(T=C("dd")).textContent=`${Vt('"#" will show the matching conversation names.')}`,L=S(),(j=C("h2")).textContent=`${Vt("Text formatting")}`,U=S(),(z=C("p")).textContent=`${Vt("Convos supports some special way of formatting text:")}`,B=S(),H=C("dl"),(q=C("dt")).textContent=`${Object.keys(Ht).sort().map(e.func).join(", ")}`,(F=C("dd")).textContent=`${Vt("Will be automatically converted into emojis.")}`,(K=C("dt")).textContent=`${Vt("> some text")}`,(G=C("dd")).textContent=`${Vt('A line starting with ">" will be converted into a quote.')}`,(W=C("dt")).textContent=`${Vt("_some text_, __some text__, ___some text___")}`,Z=C("dd"),(V=C("dt")).textContent=`${Vt("`some fragment`")}`,Y=C("dd"),(J=C("dt")).textContent="https://...",(Q=C("dd")).textContent=`${Vt("URLs will be converted to links, and might be embedded in the chat.")}`,X=S(),(ee=C("h2")).textContent=`${Vt("Available commands")}`,te=S(),ne=C("dl");for(let e=0;e<Ce.length;e+=1)Ce[e].c();oe=S(),(ae=C("h2")).textContent=`${Vt("Resources")}`,ie=S(),re=C("ul"),se=C("li"),(ce=C("a")).textContent=`${Vt("Project homepage")}`,de=S(),le=C("li"),(ue=C("a")).textContent=`${Vt("Bug/issue tracker")}`,fe=S(),me=C("li"),(he=C("a")).textContent=`${Vt("Source code")}`,a=new I(be,i),r=new I(we,null),R(ce,"href","https://convos.by"),R(ce,"target","_blank"),R(ue,"href","https://github.com/Nordaaker/convos/issues"),R(ue,"target","_blank"),R(he,"href","https://github.com/Nordaaker/convos"),R(he,"target","_blank"),R(n,"class","main")},m(e,E){ye(Ee,e,E),k(e,t,E),k(e,n,E),x(n,o),a.m(o),x(o,i),r.m(o),x(n,s),x(n,c),x(n,d),x(n,l),x(l,u),x(l,f),x(l,p),x(l,g),x(n,m),x(n,h),x(n,$),x(n,b),x(n,v),x(n,y),x(y,_),x(y,w),x(y,N),x(y,D),x(y,P),x(y,M),x(y,A),x(y,T),x(n,L),x(n,j),x(n,U),x(n,z),x(n,B),x(n,H),x(H,q),x(H,F),x(H,K),x(H,G),x(H,W),x(H,Z),Z.innerHTML=xe,x(H,V),x(H,Y),Y.innerHTML=ke,x(H,J),x(H,Q),x(n,X),x(n,ee),x(n,te),x(n,ne);for(let e=0;e<Ce.length;e+=1)Ce[e].m(ne,null);x(n,oe),x(n,ae),x(n,ie),x(n,re),x(re,se),x(se,ce),x(re,de),x(re,le),x(le,ue),x(re,fe),x(re,me),x(me,he),$e=!0},p(e,t){const n={};if(e.$$scope&&(n.$$scope={changed:e,ctx:t}),Ee.$set(n),e.l||e.commands){let n;for(Oe=$o,n=0;n<Oe.length;n+=1){const o=wr(t,Oe,n);Ce[n]?Ce[n].p(e,o):(Ce[n]=kr(o),Ce[n].c(),Ce[n].m(ne,null))}for(;n<Ce.length;n+=1)Ce[n].d(1);Ce.length=Oe.length}},i(e){$e||(pe(Ee.$$.fragment,e),$e=!0)},o(e){ge(Ee.$$.fragment,e),$e=!1},d(e){_e(Ee,e),e&&E(t),e&&E(n),O(Ce,e)}}}function Or(e){return{settings:Z("settings"),func:e=>Ht[e]}}class Cr extends xe{constructor(e){super(),we(this,e,Or,Er,s,{})}}function Nr(t){let n;return{c(){(n=C("span")).textContent=`${Vt("E-mail")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Sr(t){return{c:e,m:e,p:e,d:e}}function Dr(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Pr(t){return{c:e,m:e,p:e,d:e}}function Mr(t){let n,o=Vt("Log in")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Rr(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g;function m(t){e.textfield_value_binding.call(null,t)}let h={name:"email",placeholder:Vt("Ex: john@doe.com"),$$slots:{default:[Sr],label:[Nr]},$$scope:{ctx:e}};void 0!==e.user.formEmail&&(h.value=e.user.formEmail);const $=new Pt({props:h});J.push(()=>be($,"value",m));const b=new da({props:{name:"password",$$slots:{default:[Pr],label:[Dr]},$$scope:{ctx:e}}}),v=new Vo({props:{icon:"sign-in-alt",op:e.loginOp,$$slots:{default:[Mr]},$$scope:{ctx:e}}}),y=new aa({props:{op:e.loginOp}});return{c(){t=C("main"),(n=C("h1")).textContent=`${Vt("Log in")}`,o=S(),a=C("form"),ve($.$$.fragment),r=S(),ve(b.$$.fragment),s=S(),c=C("div"),ve(v.$$.fragment),d=S(),ve(y.$$.fragment),l=S(),u=C("article"),(f=C("p")).textContent=`${Vt("Convos is the simplest way to use IRC and it keeps you always online.")}`,R(c,"class","form-actions"),R(a,"method","post"),R(t,"class","main align-content-middle"),g=P(a,"submit",M(e.submit_handler))},m(e,i){k(e,t,i),x(t,n),x(t,o),x(t,a),ye($,a,null),x(a,r),ye(b,a,null),x(a,s),x(a,c),ye(v,c,null),x(a,d),ye(y,a,null),x(t,l),x(t,u),x(u,f),p=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),!i&&e.user&&(i=!0,n.value=t.user.formEmail,ie(()=>i=!1)),$.$set(n);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),b.$set(o);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),v.$set(a)},i(e){p||(pe($.$$.fragment,e),pe(b.$$.fragment,e),pe(v.$$.fragment,e),pe(y.$$.fragment,e),p=!0)},o(e){ge($.$$.fragment,e),ge(b.$$.fragment,e),ge(v.$$.fragment,e),ge(y.$$.fragment,e),p=!1},d(e){e&&E(t),_e($),_e(b),_e(v),_e(y),g()}}}function Ar(e,t,n){let o;const a=Z("user"),i=a.api.operation("loginUser");l(e,i,e=>n("$loginOp",o=e));return e.$$.update=(e={$loginOp:1,user:1})=>{(e.$loginOp||e.user)&&o.is("success")&&bt(a,i)},{user:a,loginOp:i,textfield_value_binding:function(e){a.formEmail=e,n("user",a)},submit_handler:e=>i.perform(e.target)}}class Tr extends xe{constructor(e){super(),we(this,e,Ar,Rr,s,{})}}function Lr(t){let n,o,a,i,r,s=Yt("Please ask your [Convos admin](%1) for an invite link to register, or [login](/login) if you already have an account.",t.settings.contact)+"";return{c(){(n=C("h1")).textContent=`${Vt("Create account")}`,o=S(),(a=C("p")).textContent=`${Vt("Convos is not open for public registration.")}`,i=S(),r=C("p")},m(e,t){k(e,n,t),k(e,o,t),k(e,a,t),k(e,i,t),k(e,r,t),r.innerHTML=s},p:e,i:e,o:e,d(e){e&&E(n),e&&E(o),e&&E(a),e&&E(i),e&&E(r)}}}function jr(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m,h,$=Yt("Go to [login](/login) if you already have an account.")+"";function b(t){e.textfield_value_binding.call(null,t)}let v={name:"email",placeholder:Vt("Ex: john@doe.com"),readonly:e.emailFromParams,$$slots:{default:[qr],help:[Hr],label:[Ur]},$$scope:{ctx:e}};void 0!==e.user.formEmail&&(v.value=e.user.formEmail);const y=new Pt({props:v});J.push(()=>be(y,"value",b));const _=new da({props:{name:"password",$$slots:{default:[Gr],help:[Kr],label:[Fr]},$$scope:{ctx:e}}}),w=new Vo({props:{icon:"save",op:e.registerOp,$$slots:{default:[Wr]},$$scope:{ctx:e}}}),O=new aa({props:{op:e.registerOp}});return{c(){(t=C("h1")).textContent=`${Vt(e.settings.existing_user?"Recover account":"Create account")}`,n=S(),o=C("form"),a=C("input"),i=S(),r=C("input"),s=S(),ve(y.$$.fragment),d=S(),ve(_.$$.fragment),l=S(),u=C("div"),ve(w.$$.fragment),f=S(),p=C("p"),g=S(),ve(O.$$.fragment),R(a,"type","hidden"),R(a,"name","exp"),R(r,"type","hidden"),R(r,"name","token"),R(u,"class","form-actions"),R(o,"method","post"),h=P(o,"submit",M(e.submit_handler))},m(c,h){k(c,t,h),k(c,n,h),k(c,o,h),x(o,a),x(o,i),x(o,r),x(o,s),ye(y,o,null),x(o,d),ye(_,o,null),x(o,l),x(o,u),ye(w,u,null),x(o,f),x(o,p),p.innerHTML=$,x(o,g),ye(O,o,null),e.form_binding(o),m=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),!c&&e.user&&(c=!0,n.value=t.user.formEmail,ie(()=>c=!1)),y.$set(n);const o={};e.$$scope&&(o.$$scope={changed:e,ctx:t}),_.$set(o);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),w.$set(a)},i(e){m||(pe(y.$$.fragment,e),pe(_.$$.fragment,e),pe(w.$$.fragment,e),pe(O.$$.fragment,e),m=!0)},o(e){ge(y.$$.fragment,e),ge(_.$$.fragment,e),ge(w.$$.fragment,e),ge(O.$$.fragment,e),m=!1},d(a){a&&E(t),a&&E(n),a&&E(o),_e(y),_e(_),_e(w),_e(O),e.form_binding(null),h()}}}function Ir(t){let n,o,a,i,r,s=Yt("Please ask your [Convos admin](%1) for a new link.",t.settings.contact)+"";return{c(){(n=C("h1")).textContent=`${Vt("Invalid invite/recover URL")}`,o=S(),(a=C("p")).textContent=`${Vt(410==t.settings.status?"The invite URL has expired.":"The invite token is invalid.")}`,i=S(),r=C("p")},m(e,t){k(e,n,t),k(e,o,t),k(e,a,t),k(e,i,t),k(e,r,t),r.innerHTML=s},p:e,i:e,o:e,d(e){e&&E(n),e&&E(o),e&&E(a),e&&E(i),e&&E(r)}}}function Ur(t){let n;return{c(){(n=C("span")).textContent=`${Vt("E-mail")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function zr(t){let n,o=Vt("Your email will be used if you forget your password.")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Br(t){let n,o=Vt("Your email is from the invite link.")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Hr(e){let t;let n=function(e,t){return t.emailFromParams?Br:zr}(0,e)(e);return{c(){t=C("p"),n.c(),R(t,"slot","help")},m(e,o){k(e,t,o),n.m(t,null)},p(e,t){n.p(e,t)},d(e){e&&E(t),n.d()}}}function qr(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Fr(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Kr(t){let n;return{c(){(n=C("p")).textContent=`${Vt("Hint: Use a phrase from a book.")}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Gr(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Wr(t){let n,o=Vt(t.settings.existing_user?"Set new password":"Register")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Zr(e){let t,n,o,a;const i=[Ir,jr,Lr],r=[];return n=function(e,t){return t.settings.status>=400?0:t.emailFromParams||t.settings.open_to_public||t.settings.first_user?1:2}(0,e),o=r[n]=i[n](e),{c(){t=C("main"),o.c(),R(t,"class","main align-content-middle")},m(e,o){k(e,t,o),r[n].m(t,null),a=!0},p(e,t){o.p(e,t)},i(e){a||(pe(o),a=!0)},o(e){ge(o),a=!1},d(e){e&&E(t),r[n].d()}}}function Vr(e,t,n){let o;const a=-1!=location.href.indexOf("email="),i=Z("settings"),r=Z("user"),s=r.api.operation("registerUser");let c;l(e,s,e=>n("$registerOp",o=e)),G(()=>{c&&_t(c)});return e.$$.update=(e={$registerOp:1,user:1})=>{(e.$registerOp||e.user)&&o.is("success")&&(r.update({lastUrl:""}),bt(r,s))},{emailFromParams:a,settings:i,user:r,registerOp:s,formEl:c,textfield_value_binding:function(e){r.formEmail=e,n("user",r)},form_binding:function(e){J[e?"unshift":"push"](()=>{n("formEl",c=e)})},submit_handler:e=>s.perform(e.target)}}class Yr extends xe{constructor(e){super(),we(this,e,Vr,Zr,s,{})}}function Jr(t){let n;return{c(){(n=C("h1")).textContent=`${Vt("Settings")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Qr(t){let n;return{c(){(n=C("span")).textContent=`${Vt("User email")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Xr(t){return{c:e,m:e,p:e,d:e}}function es(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m=Yt(e.invite.existing?"Copy and send the link to your *existing* user.":"Copy and send the link to your *new* user.")+"",h=Yt("The link is valid until **%1**.",new Date(e.invite.expires).toLocaleString())+"",$=e.invite.url+"";return{c(){(t=C("h3")).textContent=`${Vt("A link was generated")}`,n=S(),o=C("p"),i=S(),s=S(),c=C("a"),d=N($),u=S(),f=C("p"),(p=C("small")).textContent=`${Vt("Tip: Clicking on the link will copy it to your clipboard.")}`,a=new I(m,i),r=new I(h,null),R(c,"href",l=e.invite.url),g=P(c,"click",M(e.copyInviteLink))},m(e,l){k(e,t,l),k(e,n,l),k(e,o,l),a.m(o),x(o,i),r.m(o),k(e,s,l),k(e,c,l),x(c,d),k(e,u,l),k(e,f,l),x(f,p)},p(e,t){e.invite&&m!==(m=Yt(t.invite.existing?"Copy and send the link to your *existing* user.":"Copy and send the link to your *new* user.")+"")&&a.p(m),e.invite&&h!==(h=Yt("The link is valid until **%1**.",new Date(t.invite.expires).toLocaleString())+"")&&r.p(h),e.invite&&$!==($=t.invite.url+"")&&A(d,$),e.invite&&l!==(l=t.invite.url)&&R(c,"href",l)},d(e){e&&E(t),e&&E(n),e&&E(o),e&&E(s),e&&E(c),e&&E(u),e&&E(f),g()}}}function ts(t){let n,o=Vt("Generate link")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ns(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Organization name")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function os(t){let n;return{c(){(n=C("p")).textContent=`${Vt("Can be changed if you want to add a touch of your organization.")}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function as(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function is(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Organization URL")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function rs(t){let n;return{c(){(n=C("p")).textContent=`${Vt('Used together with "Organization name" to add a link to your organization on the login screen.')}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ss(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function cs(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Admin email")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ds(t){let n;return{c(){(n=C("p")).textContent=`${Vt("This email can be used by users to get in touch with the Convos admin.")}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ls(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function us(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Default connection URL")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function fs(t){let n;return{c(){(n=C("p")).textContent=`${Vt("This is the default connection new users will connect to.")} \n        ${Vt('The path part is the default channel to join. "%%23convos" means "#convos".')}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ps(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function gs(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Registration is open to public")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ms(t){let n;return{c(){(n=C("p")).textContent=`${Vt("Tick this box if you want users to be able to register without an invite URL.")}`,R(n,"slot","help")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function hs(t){let n;return{c(){n=S()},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function $s(t){let n,o=Vt("Save settings")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function bs(e){let t,n,o,a,r,s,c,d,l,u,f,p,g,m,h,$,b,v,y,_,w,O,N,D,A,T,L,j;const I=new ho({props:{$$slots:{default:[Jr]},$$scope:{ctx:e}}}),U=new Pt({props:{name:"email",placeholder:Vt("user@example.com"),$$slots:{default:[Xr],label:[Qr]},$$scope:{ctx:e}}});let z=e.invite.url&&es(e);const B=new Vo({props:{icon:"save",op:e.inviteLinkOp,$$slots:{default:[ts]},$$scope:{ctx:e}}}),H=new aa({props:{op:e.inviteLinkOp}});function q(t){e.textfield1_value_binding.call(null,t)}let F={name:"organization_name",placeholder:Vt("Nordaaker"),$$slots:{default:[as],help:[os],label:[ns]},$$scope:{ctx:e}};void 0!==e.settings.organization_name&&(F.value=e.settings.organization_name);const K=new Pt({props:F});function G(t){e.textfield2_value_binding.call(null,t)}J.push(()=>be(K,"value",q));let W={name:"organization_url",placeholder:Vt("https://convos.by"),$$slots:{default:[ss],help:[rs],label:[is]},$$scope:{ctx:e}};void 0!==e.settings.organization_url&&(W.value=e.settings.organization_url);const Z=new Pt({props:W});function V(t){e.textfield3_value_binding.call(null,t)}J.push(()=>be(Z,"value",G));let Y={name:"contact",placeholder:Vt("Ex: jhthorsen@cpan.org"),$$slots:{default:[ls],help:[ds],label:[cs]},$$scope:{ctx:e}};void 0!==e.settings.contact&&(Y.value=e.settings.contact);const Q=new Pt({props:Y});function X(t){e.textfield4_value_binding.call(null,t)}J.push(()=>be(Q,"value",V));let ee={name:"default_connection",placeholder:Vt("irc://chat.freenode.net:6697/%%23convos"),$$slots:{default:[ps],help:[fs],label:[us]},$$scope:{ctx:e}};void 0!==e.settings.default_connection&&(ee.value=e.settings.default_connection);const te=new Pt({props:ee});J.push(()=>be(te,"value",X));const ne=new ea({props:{name:"open_to_public",checked:e.settings.open_to_public,$$slots:{default:[hs],help:[ms],label:[gs]},$$scope:{ctx:e}}}),oe=new Vo({props:{icon:"save",op:e.updateSettingsOp,$$slots:{default:[$s]},$$scope:{ctx:e}}}),ae=new aa({props:{op:e.updateSettingsOp}});return{c(){ve(I.$$.fragment),t=S(),n=C("main"),o=C("form"),(a=C("h2")).textContent=`${Vt("Recover or invite")}`,r=S(),(s=C("p")).textContent=`${Vt("Using this form, you can generate an invite link for new users, or a recover password link for existing users.")}`,c=S(),ve(U.$$.fragment),d=S(),z&&z.c(),l=S(),u=C("div"),ve(B.$$.fragment),f=S(),ve(H.$$.fragment),p=S(),g=C("form"),(m=C("h2")).textContent=`${Vt("Server settings")}`,h=S(),ve(K.$$.fragment),b=S(),ve(Z.$$.fragment),y=S(),ve(Q.$$.fragment),w=S(),ve(te.$$.fragment),N=S(),ve(ne.$$.fragment),D=S(),A=C("div"),ve(oe.$$.fragment),T=S(),ve(ae.$$.fragment),R(u,"class","form-actions"),R(o,"method","post"),R(A,"class","form-actions"),R(g,"method","post"),R(n,"class","main"),j=[P(o,"submit",M(e.generateInviteLink)),P(g,"submit",M(e.updateSettingsFromForm))]},m(e,i){ye(I,e,i),k(e,t,i),k(e,n,i),x(n,o),x(o,a),x(o,r),x(o,s),x(o,c),ye(U,o,null),x(o,d),z&&z.m(o,null),x(o,l),x(o,u),ye(B,u,null),x(o,f),ye(H,o,null),x(n,p),x(n,g),x(g,m),x(g,h),ye(K,g,null),x(g,b),ye(Z,g,null),x(g,y),ye(Q,g,null),x(g,w),ye(te,g,null),x(g,N),ye(ne,g,null),x(g,D),x(g,A),ye(oe,A,null),x(g,T),ye(ae,g,null),L=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),I.$set(n);const a={};e.$$scope&&(a.$$scope={changed:e,ctx:t}),U.$set(a),t.invite.url?z?z.p(e,t):((z=es(t)).c(),z.m(o,l)):z&&(z.d(1),z=null);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),B.$set(i);const r={};e.$$scope&&(r.$$scope={changed:e,ctx:t}),!$&&e.settings&&($=!0,r.value=t.settings.organization_name,ie(()=>$=!1)),K.$set(r);const s={};e.$$scope&&(s.$$scope={changed:e,ctx:t}),!v&&e.settings&&(v=!0,s.value=t.settings.organization_url,ie(()=>v=!1)),Z.$set(s);const c={};e.$$scope&&(c.$$scope={changed:e,ctx:t}),!_&&e.settings&&(_=!0,c.value=t.settings.contact,ie(()=>_=!1)),Q.$set(c);const d={};e.$$scope&&(d.$$scope={changed:e,ctx:t}),!O&&e.settings&&(O=!0,d.value=t.settings.default_connection,ie(()=>O=!1)),te.$set(d);const u={};e.settings&&(u.checked=t.settings.open_to_public),e.$$scope&&(u.$$scope={changed:e,ctx:t}),ne.$set(u);const f={};e.$$scope&&(f.$$scope={changed:e,ctx:t}),oe.$set(f)},i(e){L||(pe(I.$$.fragment,e),pe(U.$$.fragment,e),pe(B.$$.fragment,e),pe(H.$$.fragment,e),pe(K.$$.fragment,e),pe(Z.$$.fragment,e),pe(Q.$$.fragment,e),pe(te.$$.fragment,e),pe(ne.$$.fragment,e),pe(oe.$$.fragment,e),pe(ae.$$.fragment,e),L=!0)},o(e){ge(I.$$.fragment,e),ge(U.$$.fragment,e),ge(B.$$.fragment,e),ge(H.$$.fragment,e),ge(K.$$.fragment,e),ge(Z.$$.fragment,e),ge(Q.$$.fragment,e),ge(te.$$.fragment,e),ge(ne.$$.fragment,e),ge(oe.$$.fragment,e),ge(ae.$$.fragment,e),L=!1},d(e){_e(I,e),e&&E(t),e&&E(n),_e(U),z&&z.d(),_e(B),_e(H),_e(K),_e(Z),_e(Q),_e(te),_e(ne),_e(oe),_e(ae),i(j)}}}function vs(e,t,n){let o;const a=Z("user"),i=a.api.operation("getSettings"),r=a.api.operation("inviteUser");l(e,r,e=>n("$inviteLinkOp",o=e));const s=a.api.operation("updateSettings");let c,d={};return s.on("start",e=>{e.body.contact="mailto:"+e.body.contact,e.body.open_to_public=!!e.body.open_to_public}),G(async()=>{await i.perform();const e=i.res.body;e.contact=e.contact.replace(/mailto:/,""),n("settings",d=e)}),e.$$.update=(e={$inviteLinkOp:1})=>{e.$inviteLinkOp&&n("invite",c=o.res.body||{})},{inviteLinkOp:r,updateSettingsOp:s,settings:d,generateInviteLink:function(e){r.perform(e.target)},copyInviteLink:function(e){const t=function(e){var t=document.createElement("textarea");t.value=e.textContent||e.value,t.style.opacity=0,t.style.position="absolute",document.body.appendChild(t);try{t.focus(),t.select(),document.execCommand("copy")}catch(e){t.value="",console.log("copyToClipboard() failed:",e)}return document.body.removeChild(t),t.value}(e.target);t&&a.events.notifyUser("Invite link copied",t,{force:!0})},updateSettingsFromForm:function(e){s.perform(e.target)},invite:c,textfield1_value_binding:function(e){d.organization_name=e,n("settings",d)},textfield2_value_binding:function(e){d.organization_url=e,n("settings",d)},textfield3_value_binding:function(e){d.contact=e,n("settings",d)},textfield4_value_binding:function(e){d.default_connection=e,n("settings",d)}}}class ys extends xe{constructor(e){super(),we(this,e,vs,bs,s,{})}}function _s(t){let n;return{c(){(n=C("h1")).textContent=`${Vt("Account")}`},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function ws(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Email")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function xs(t){return{c:e,m:e,p:e,d:e}}function ks(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Notification keywords")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Es(t){return{c:e,m:e,p:e,d:e}}function Os(e){let t,n;function o(t){e.checkbox_checked_binding.call(null,t)}let a={name:"notifications",$$slots:{default:[Ns],label:[Cs]},$$scope:{ctx:e}};void 0!==e.wantNotifications&&(a.checked=e.wantNotifications);const i=new ea({props:a});return J.push(()=>be(i,"checked",o)),{c(){ve(i.$$.fragment)},m(e,t){ye(i,e,t),n=!0},p(e,n){const o={};e.$$scope&&(o.$$scope={changed:e,ctx:n}),!t&&e.wantNotifications&&(t=!0,o.checked=n.wantNotifications,ie(()=>t=!1)),i.$set(o)},i(e){n||(pe(i.$$.fragment,e),n=!0)},o(e){ge(i.$$.fragment,e),n=!1},d(e){_e(i,e)}}}function Cs(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Enable notifications")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ns(t){return{c:e,m:e,p:e,d:e}}function Ss(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Expand URL to media")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ds(t){return{c:e,m:e,p:e,d:e}}function Ps(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Theme")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ms(t){return{c:e,m:e,p:e,d:e}}function Rs(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function As(t){return{c:e,m:e,p:e,d:e}}function Ts(t){let n;return{c(){(n=C("span")).textContent=`${Vt("Repeat password")}`,R(n,"slot","label")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Ls(t){return{c:e,m:e,p:e,d:e}}function js(t){let n,o=Vt("Save settings")+"";return{c(){n=N(o)},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Is(t){let n;return{c(){(n=C("p")).textContent=`${Vt("You cannot receive notifications, because it is denied by your browser.")}`,R(n,"class","error")},m(e,t){k(e,n,t)},p:e,d(e){e&&E(n)}}}function Us(e){let t,n,o,a,i,r,s,c,d,l,u,f,p,g,m,h,$,b,v;const y=new ho({props:{$$slots:{default:[_s]},$$scope:{ctx:e}}}),_=new Pt({props:{name:"email",value:e.$user.email,readonly:!0,$$slots:{default:[xs],label:[ws]},$$scope:{ctx:e}}}),w=new Pt({props:{name:"highlight_keywords",placeholder:Vt("whatever, keywords"),value:e.highlight_keywords,$$slots:{default:[Es],label:[ks]},$$scope:{ctx:e}}});let O=!e.notificationsDisabled&&Os(e);function N(t){e.checkbox_checked_binding_1.call(null,t)}let D={name:"expand_url",$$slots:{default:[Ds],label:[Ss]},$$scope:{ctx:e}};void 0!==e.expandUrlToMedia&&(D.checked=e.expandUrlToMedia);const A=new ea({props:D});function T(t){e.selectfield_value_binding.call(null,t)}J.push(()=>be(A,"checked",N));let L={name:"theme",options:uo,$$slots:{default:[Ms],label:[Ps]},$$scope:{ctx:e}};void 0!==e.theme&&(L.value=e.theme);const j=new Ji({props:L});J.push(()=>be(j,"value",T));const I=new da({props:{name:"password",$$slots:{default:[As],label:[Rs]},$$scope:{ctx:e}}}),U=new da({props:{name:"password_again",$$slots:{default:[Ls],label:[Ts]},$$scope:{ctx:e}}}),z=new Vo({props:{icon:"save",op:e.updateUserOp,$$slots:{default:[js]},$$scope:{ctx:e}}}),B=new aa({props:{op:e.updateUserOp}});let H=e.notificationsDisabled&&Is();return{c(){ve(y.$$.fragment),t=S(),n=C("main"),o=C("form"),ve(_.$$.fragment),a=S(),ve(w.$$.fragment),i=S(),O&&O.c(),r=S(),ve(A.$$.fragment),c=S(),ve(j.$$.fragment),l=S(),ve(I.$$.fragment),u=S(),ve(U.$$.fragment),f=S(),(p=C("p")).textContent=`${Vt("Leave the password fields empty to keep the current password.")}`,g=S(),m=C("div"),ve(z.$$.fragment),h=S(),ve(B.$$.fragment),$=S(),H&&H.c(),R(m,"class","form-actions"),R(o,"method","post"),R(n,"class","main"),v=P(o,"submit",M(e.updateUserFromForm))},m(s,d){ye(y,s,d),k(s,t,d),k(s,n,d),x(n,o),ye(_,o,null),x(o,a),ye(w,o,null),x(o,i),O&&O.m(o,null),x(o,r),ye(A,o,null),x(o,c),ye(j,o,null),x(o,l),ye(I,o,null),x(o,u),ye(U,o,null),x(o,f),x(o,p),x(o,g),x(o,m),ye(z,m,null),x(o,h),ye(B,o,null),x(o,$),H&&H.m(o,null),e.form_binding(o),b=!0},p(e,t){const n={};e.$$scope&&(n.$$scope={changed:e,ctx:t}),y.$set(n);const a={};e.$user&&(a.value=t.$user.email),e.$$scope&&(a.$$scope={changed:e,ctx:t}),_.$set(a);const i={};e.$$scope&&(i.$$scope={changed:e,ctx:t}),w.$set(i),t.notificationsDisabled?O&&(ue(),ge(O,1,1,()=>{O=null}),fe()):O?(O.p(e,t),pe(O,1)):((O=Os(t)).c(),pe(O,1),O.m(o,r));const c={};e.$$scope&&(c.$$scope={changed:e,ctx:t}),!s&&e.expandUrlToMedia&&(s=!0,c.checked=t.expandUrlToMedia,ie(()=>s=!1)),A.$set(c);const l={};e.$$scope&&(l.$$scope={changed:e,ctx:t}),!d&&e.theme&&(d=!0,l.value=t.theme,ie(()=>d=!1)),j.$set(l);const u={};e.$$scope&&(u.$$scope={changed:e,ctx:t}),I.$set(u);const f={};e.$$scope&&(f.$$scope={changed:e,ctx:t}),U.$set(f);const p={};e.$$scope&&(p.$$scope={changed:e,ctx:t}),z.$set(p),t.notificationsDisabled?H?H.p(e,t):((H=Is()).c(),H.m(o,null)):H&&(H.d(1),H=null)},i(e){b||(pe(y.$$.fragment,e),pe(_.$$.fragment,e),pe(w.$$.fragment,e),pe(O),pe(A.$$.fragment,e),pe(j.$$.fragment,e),pe(I.$$.fragment,e),pe(U.$$.fragment,e),pe(z.$$.fragment,e),pe(B.$$.fragment,e),b=!0)},o(e){ge(y.$$.fragment,e),ge(_.$$.fragment,e),ge(w.$$.fragment,e),ge(O),ge(A.$$.fragment,e),ge(j.$$.fragment,e),ge(I.$$.fragment,e),ge(U.$$.fragment,e),ge(z.$$.fragment,e),ge(B.$$.fragment,e),b=!1},d(o){_e(y,o),o&&E(t),o&&E(n),_e(_),_e(w),O&&O.d(),_e(A),_e(j),_e(I),_e(U),_e(z),_e(B),H&&H.d(),e.form_binding(null),v()}}}function zs(e,t,n){let o;const a=Z("user");l(e,a,e=>n("$user",o=e));const i=a.api.operation("updateUser");let r,s=a.embedMaker.expandUrlToMedia,c="denied"==a.events.browserNotifyPermission,d=a.theme,u=a.events.wantNotifications,f=a.highlight_keywords.join(", ");return i.on("start",e=>{e.body.password||delete e.body.password,e.body.highlight_keywords=e.body.highlight_keywords.split(/[.,\s]+/).map(e=>e.trim())}),{user:a,updateUserOp:i,formEl:r,expandUrlToMedia:s,notificationsDisabled:c,theme:d,wantNotifications:u,highlight_keywords:f,updateUserFromForm:function(e){const t=e.target,o=[t.password.value,t.password_again.value];if(u&&a.events.requestPermissionToNotify(e=>{"denied"==e&&(n("wantNotifications",u=!1),n("notificationsDisabled",c=!0))}),o.join("").length&&o[0]!=o[1])return i.error("Passwords does not match.");a.embedMaker.update({expandUrlToMedia:s}),a.update({theme:d}),i.perform(e.target)},$user:o,checkbox_checked_binding:function(e){n("wantNotifications",u=e)},checkbox_checked_binding_1:function(e){n("expandUrlToMedia",s=e)},selectfield_value_binding:function(e){n("theme",d=e)},form_binding:function(e){J[e?"unshift":"push"](()=>{n("formEl",r=e)})}}}class Bs extends xe{constructor(e){super(),we(this,e,zs,Us,s,{})}}const{window:Hs}=$e;function qs(e){let t;const n=new bn({props:{transition:{duration:e.$container.wideScreen?0:250,x:e.$container.width}}});return{c(){ve(n.$$.fragment)},m(e,o){ye(n,e,o),t=!0},p(e,t){const o={};e.$container&&(o.transition={duration:t.$container.wideScreen?0:250,x:t.$container.width}),n.$set(o)},i(e){t||(pe(n.$$.fragment,e),t=!0)},o(e){ge(n.$$.fragment,e),t=!1},d(e){_e(n,e)}}}function Fs(t){let n;const o=new En({});return{c(){ve(o.$$.fragment)},m(e,t){ye(o,e,t),n=!0},p:e,i(e){n||(pe(o.$$.fragment,e),n=!0)},o(e){ge(o.$$.fragment,e),n=!1},d(e){_e(o,e)}}}function Ks(e){let t,n,o;return{c(){(t=C("div")).textContent=" ",R(t,"class","overlay")},m(e,n){k(e,t,n),o=!0},i(e){o||(ae(()=>{n||(n=he(t,Rt,{duration:200},!0)),n.run(1)}),o=!0)},o(e){n||(n=he(t,Rt,{duration:200},!1)),n.run(0),o=!1},d(e){e&&E(t),e&&n&&n.end()}}}function Gs(e){let t,n,o,a,r,s,c,d;ae(e.onwindowresize);const l=[Fs,qs],u=[];function f(e,n){return(null==t||e.$user)&&(t=!n.$user.is("loggedIn")),t?0:"nav"==n.$activeMenu||n.$container.wideScreen?1:-1}~(n=f(null,e))&&(o=u[n]=l[n](e));var p=e.$pageComponent;if(p)var g=new p({});let m=e.$activeMenu&&!e.$container.wideScreen&&Ks();return{c(){o&&o.c(),a=S(),g&&ve(g.$$.fragment),r=S(),m&&m.c(),s=D(),d=[P(Hs,"click",e.onWindowClick),P(Hs,"focus",e.onWindowFocus),P(Hs,"keydown",Ws),P(Hs,"resize",e.onwindowresize)]},m(e,t){~n&&u[n].m(e,t),k(e,a,t),g&&ye(g,e,t),k(e,r,t),m&&m.m(e,t),k(e,s,t),c=!0},p(e,t){let i=n;if((n=f(e,t))===i?~n&&u[n].p(e,t):(o&&(ue(),ge(u[i],1,1,()=>{u[i]=null}),fe()),~n?((o=u[n])||(o=u[n]=l[n](t)).c(),pe(o,1),o.m(a.parentNode,a)):o=null),p!==(p=t.$pageComponent)){if(g){ue();const e=g;ge(e.$$.fragment,1,0,()=>{_e(e,1)}),fe()}p?(ve((g=new p({})).$$.fragment),pe(g.$$.fragment,1),ye(g,r.parentNode,r)):g=null}t.$activeMenu&&!t.$container.wideScreen?m?pe(m,1):((m=Ks()).c(),pe(m,1),m.m(s.parentNode,s)):m&&(ue(),ge(m,1,1,()=>{m=null}),fe())},i(e){c||(pe(o),g&&pe(g.$$.fragment,e),pe(m),c=!0)},o(e){ge(o),g&&ge(g.$$.fragment,e),ge(m),c=!1},d(e){~n&&u[n].d(e),e&&E(a),g&&_e(g,e),e&&E(r),m&&m.d(e),e&&E(s),i(d)}}}function Ws(e){if(!e.shiftKey||13!=e.keyCode)return;e.preventDefault();const t=document.getElementById("sidebar_left_search_input"),n=document.activeElement;if(n!=t&&!Qe(n,"body"))return t.focus();const o=["#chat_input_textarea",'.main input[type="text"]',".main a","#sidebar_left_search_input"];for(let e=0;e<o.length;e++){const t=document.querySelector(o[e]);if(t)return t.focus()}}function Zs(e,t,n){let o,a,i,r,s,c;l(e,ft,e=>n("$currentUrl",o=e)),l(e,pt,e=>n("$docTitle",i=e)),l(e,lt,e=>n("$activeMenu",r=e)),l(e,ut,e=>n("$container",s=e)),l(e,gt,e=>n("$pageComponent",c=e));const d=[[new RegExp(".*"),yr,{user:"offline"}],[new RegExp("^/login"),Tr,{}],[new RegExp("^/register"),Yr,{}],[new RegExp("^/add/connection"),Fi,{user:"loggedIn"}],[new RegExp("^/add/conversation"),pr,{user:"loggedIn"}],[new RegExp("^/chat"),Bi,{user:"loggedIn"}],[new RegExp("^/help"),Cr,{user:"loggedIn"}],[new RegExp("^/settings/account"),Bs,{user:"loggedIn"}],[new RegExp("^/settings"),ys,{user:"loggedIn"}],[new RegExp("^/docs"),null,{}],[new RegExp("^/paste"),null,{}],[new RegExp("^/$"),null,{user:["error","success"],gotoLast:!0}],[new RegExp(".*"),yr,{}]],u=[window.__convos,delete window.__convos][0],f=new tt(u.api_url,{debug:!0}),p=new lo({api:f,wsUrl:u.ws_url});l(e,p,e=>n("$user",a=e));let m=0;function h(e){let t=["","chat",e.connection_id];if(g(lt,r=""),"part"==e.command[0]){const e=document.querySelector('.sidebar-left [href$="'+t.map(encodeURIComponent).join("/")+'"]');ht(e?e.href:"/chat")}else e.dialog_id&&t.push(e.dialog_id),ht(t.map(encodeURIComponent).join("/"))}return window.hljs=nt,ft.base=u.base_url,p.events.listenToGlobalEvents(),W("settings",u),W("user",p),"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{p.update({latestVersion:u.asset_version}),e.update()}).catch(e=>{console.log("[Convos] ServiceWorker registration failed:",e)}),G(()=>{Ke(ft.base+"/images/emojis.js"),u.load_user&&p.load(),p.showGrid&&document.querySelector("body").classList.add("with-grid");const e=[];return e.push(function(){var e=function(){return ft.set($t(location.href))};return window.addEventListener("popstate",e),function(){return window.removeEventListener("popstate",e)}}()),e.push(p.on("wsEventSentJoin",h)),e.push(p.on("wsEventSentPart",h)),()=>e.forEach(e=>e())}),e.$$.update=(e={containerWidth:1,$currentUrl:1,$user:1,$docTitle:1})=>{e.containerWidth&&ut.set({wideScreen:m>800,width:m}),(e.$currentUrl||e.$user)&&function(e,t,n){var o=e.path,a=[t.status,o].join(":");if(a!=dt){for(var i=0;i<n.length;i++){var r=Re(n[i],3),s=r[0],c=r[1],d=r[2];if(s.test(o)&&(!d.user||t.is(d.user))){if(d.gotoLast)return ht(t.calculateLastUrl());vt(c),Ve("body",/(is-logged-)\S+/,t.is("loggedIn")?"in":"out"),Ve("body",/(page-)\S+/,d.name||e.pathParts[0]),"loggedIn"==d.user&&t.update({lastUrl:e.toString()});break}}dt=a}}(o,a,d),e.$user&&function(e){0==uo.filter((function(t){return t[0]==e})).length&&(e="auto"),"auto"==e&&(e=fo);var t=document.documentElement;t.className=t.className.replace(/theme-\S+/,(function(){return"theme-"+e}))}(a.theme),(e.$user||e.$docTitle)&&document&&(document.title=a.unread?"("+a.unread+") "+i:i)},{routingRules:d,user:p,containerWidth:m,onWindowClick:function(e){const t=Be(e.target,"a"),n=t&&t.href.match(/#call:(\w+):(\w+)/)||["","",""];if(n[2])switch(e.preventDefault(),n[1]){case"events":return p.events[n[2]]();case"user":return p[n[2]]()}if(t&&"_self"==t.target)return e.preventDefault(),void ht(t.href);const a=t&&t.href.match(/(.*)#(activeMenu):(\w*)/)||["","","",""];0==a[1].indexOf("http")&&o.toString()!=a[1]&&ht(a[1]),Be(e.target,".sidebar-left")&&!t||Be(e.target,".main")&&!a[3]||((a[2]||r)&&e.preventDefault(),g(lt,r=a[3]==r?"":a[3]))},onWindowFocus:function(){p.ensureConnected()},$user:a,$activeMenu:r,$container:s,$pageComponent:c,onwindowresize:function(){n("containerWidth",m=Hs.innerWidth)}}}var Vs=document.querySelector("body");new class extends xe{constructor(e){super(),we(this,e,Zs,Gs,s,{routingRules:0})}get routingRules(){return this.$$.ctx.routingRules}}({target:document.body});Vs.classList=Vs.className.replace(/no-js/,"has-js")}();
//# sourceMappingURL=convos.5dd88a27.js.map
