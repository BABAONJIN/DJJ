(function(){Vue.component("convos-profile",{props:["user"],data:function(){return{errors:[],password:"",passwordAgain:"",notifications:Notification.permission,sortDialogsByRead:false};},watch:{sortDialogsByRead:function(v,o){this.settings.sortDialogsBy=v?"lastRead":"default";}},methods:{save:function(){var self=this;if(this.password!=this.passwordAgain)
return this.errors=[{message:"Passwords does not match"}];if(this.notifications&&this.notifications!=this.settings.notifications)
this.enableNotifications(true);if(!this.notifications)
this.enableNotifications(false);if(this.password){Convos.api.updateUser({body:{password:this.password}},function(err,res){if(!err)this.password="";self.errors=err||[];});}}},ready:function(){this.sortDialogsByRead=this.settings.sortDialogsBy=="lastRead";},template:"<div class=\"convos-profile\">\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <h4>{{user.email}}</h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <md-input :value.sync=\"password\" cols=\"s6\" placeholder=\"At least six characters\" type=\"password\">Password</md-input>\n      <md-input :value.sync=\"passwordAgain\" cols=\"s6\" type=\"password\">Repeat password</md-input>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input class=\"filled-in\" id=\"form_sort_by\" type=\"checkbox\" v-model=\"sortDialogsByRead\">\n        <label for=\"form_sort_by\">Sort dialogs by last-read/activity</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input :checked=\"settings.notifications == &#39;granted&#39;\" class=\"filled-in\" id=\"form_notifications\" type=\"checkbox\" v-model=\"notifications\">\n        <label for=\"form_notifications\">Enable notifications</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input class=\"filled-in\" id=\"form_expand_urls\" type=\"checkbox\" v-model=\"settings.expandUrls\">\n        <label for=\"form_expand_urls\">Expand URL to media</label>\n      </div>\n    </div>\n    <div class=\"row\" v-if=\"errors.length\">\n      <div class=\"col s12\"><div class=\"alert\">{{errors[0].message}}</div></div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <button @click=\"save\" class=\"btn waves-effect waves-light\" type=\"submit\">Save</button>\n      </div>\n    </div>\n  </div>\n"})})();