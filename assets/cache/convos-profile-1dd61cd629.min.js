(function(){Vue.component("convos-profile",{props:["user"],data:function(){return{errors:[],highlightKeywords:"",password:"",passwordAgain:"",notifications:Notification.permission,sortDialogsByRead:false};},watch:{sortDialogsByRead:function(v,o){this.settings.sortDialogsBy=v?"lastRead":"default";}},methods:{save:function(){var self=this;var highlightKeywords=this.highlightKeywords.split(/[,\s]+/).filter(function(k){return k.length;});if(this.password!=this.passwordAgain)
return this.errors=[{message:"Passwords does not match"}];if(this.notifications&&this.notifications!=this.settings.notifications)
this.enableNotifications(true);if(!this.notifications)
this.enableNotifications(false);Convos.api.updateUser({body:{highlight_keywords:highlightKeywords,password:this.password}},function(err,res){if(!err)this.password="";self.errors=err||[];});}},ready:function(){this.sortDialogsByRead=this.settings.sortDialogsBy=="lastRead";this.highlightKeywords=this.user.highlightKeywords.join(", ");},template:"<div class=\"convos-profile\">\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <h4>{{user.email}}</h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <md-input :value.sync=\"password\" type=\"password\" placeholder=\"At least six characters\" cols=\"s6\">Password</md-input>\n      <md-input :value.sync=\"passwordAgain\" type=\"password\" cols=\"s6\">Repeat password</md-input>\n    </div>\n    <div class=\"row\">\n      <md-input :value.sync=\"highlightKeywords\" placeholder=\"cats, superheroes, ...\" cols=\"s12\">Notification keywords</md-input>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input v-model=\"sortDialogsByRead\" type=\"checkbox\" class=\"filled-in\" id=\"form_sort_by\">\n        <label for=\"form_sort_by\">Sort dialogs by last-read/activity</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input v-model=\"notifications\" type=\"checkbox\" class=\"filled-in\" id=\"form_notifications\" :checked=\"settings.notifications == 'granted'\">\n        <label for=\"form_notifications\">Enable notifications</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input v-model=\"settings.expandUrls\" type=\"checkbox\" class=\"filled-in\" id=\"form_expand_urls\">\n        <label for=\"form_expand_urls\">Expand URL to media</label>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <input v-model=\"settings.clearNotificationsOnOpen\" type=\"checkbox\" class=\"filled-in\" id=\"form_clear_notifications\">\n        <label for=\"form_clear_notifications\">Clear notifications on open</label>\n      </div>\n    </div>\n    <div class=\"row\" v-if=\"errors.length\">\n      <div class=\"col s12\"><div class=\"alert\">{{errors[0].message}}</div></div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <button @click=\"save\" class=\"btn waves-effect waves-light\" type=\"submit\">Save</button>\n      </div>\n    </div>\n  </div>\n"})})();