(function(){Vue.component("convos-create-dialog",{props:["user"],data:function(){return{connection:new Convos.Connection({}),dialogName:"",rooms:[]};},watch:{"dialogName":function(v,o){this.refreshRooms();},"settings.main":function(v,o){this.updateForm();}},methods:{join:function(option){if(!option.name)return;this.connection.send("/join "+option.name);this.dialogName="";},refreshRooms:function(){var self=this;this.connection.rooms({match:this.dialogName},function(err,res){if(!res.end)setTimeout(self.refreshRooms,1500);self.n_rooms=res.n_rooms;self.rooms=res.rooms;});},updateForm:function(connectionId){if(arguments.length&&!connectionId)return this.settings.main="#connection";var dialogName=this.settings.main.match(/create-dialog\/([^\/]+)/);this.connection=this.user.getConnection(connectionId);this.dialogName=dialogName?dialogName[1]:"";this.refreshRooms();}},ready:function(){this.updateForm();},template:"<form @submit.prevent autocomplete=\"off\" class=\"convos-create-dialog\">\n    <div class=\"row\">\n      <div class=\"col s12\">\n        <h4>Join dialog</h4>\n        <p>\n          Enter the name of a dialog to either search for the known dialogs,\n          or to create a new chat room.\n        </p>\n      </div>\n    </div>\n    <div class=\"row\">\n      <md-select @change=\"updateForm\" label=\"Select connection\" value=\"\">\n        <md-option :selected=\"connection == c\" :value=\"c.connection_id\" v-for=\"c in user.connections\">{{c.protocol}}-{{c.name}}</md-option>\n        <md-option value=\"\">Create new connection...</md-option>\n      </md-select>\n    </div>\n    <div class=\"row\">\n      <convos-dialog-chooser :options=\"rooms\" :value.sync=\"dialogName\" @select=\"join\"></convos-dialog-chooser>\n    </div>\n  </form>\n"})})();